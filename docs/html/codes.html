

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Source codes &mdash; beampy 0.0.1.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Contact" href="contact.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> beampy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="beampy.html">Beampy modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface.html">Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="results.html">Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="LICENSE.html">MIT License</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Source codes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#beampy-bpm">beampy.bpm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#beampy-interface">beampy.interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#beampy-user-interface">beampy.user_interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#beampy-examples">beampy.examples</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">beampy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Source codes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/codes.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="source-codes">
<span id="codes"></span><h1>Source codes<a class="headerlink" href="#source-codes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="beampy-bpm">
<span id="code-bpm"></span><h2>beampy.bpm<a class="headerlink" href="#beampy-bpm" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The bpm module contain the Bpm class used to simulate the light propagation -</span>
<span class="sd">within low refractive index variation</span>
<span class="sd">and small angle (paraxial approximation) -</span>
<span class="sd">using the Beam Propagation Method.</span>

<span class="sd">This module was done by Jonathan Peltier during a master</span>
<span class="sd">university course from the PAIP master of the université de Lorraine,</span>
<span class="sd">under the directive of Pr. Nicolas Fressengeas.</span>

<span class="sd">The bpm codes are mainly based on a compilation of MatLab codes initialy</span>
<span class="sd">developed by Régis Grasser during his PhD thesis[2],</span>
<span class="sd">and later modified at the LMOPS laboratory[3].</span>

<span class="sd">[1] K. Okamoto, in Fundamentals of Optical Waveguides,</span>
<span class="sd">2nd ed., edited by K. Okamoto (Academic, Burlington, 2006), pp. 329–397.</span>

<span class="sd">[2] &quot;Generation et propagation de reseaux periodiques de solitons spatiaux</span>
<span class="sd">dans un milieu de kerr massif&quot; PhD thesis, université de Franche-Comté 1998.</span>

<span class="sd">[3] H. Oukraou et. al., Broadband photonic transport between waveguides by</span>
<span class="sd">adiabatic elimination Phys. Rev. A, 97 023811 (2018).</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">ceil</span><span class="p">,</span> <span class="n">radians</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">acos</span><span class="p">,</span> <span class="n">asin</span><span class="p">,</span> <span class="n">exp</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">special</span>
<span class="kn">from</span> <span class="nn">numpy.fft</span> <span class="k">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">ifft</span><span class="p">,</span> <span class="n">fftshift</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="k">import</span> <span class="n">Polygon</span>
<span class="kn">import</span> <span class="nn">time</span>


<span class="k">class</span> <span class="nc">Bpm</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The Bpm class is used to simulate light propagation -</span>
<span class="sd">    within small refractive index variation guides</span>
<span class="sd">    and small angle of propagation (paraxial) -</span>
<span class="sd">    using the Beam Propagation Method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    width : float</span>
<span class="sd">        Guide width defined as the diameter (µm) at 1/e^2 intensity.</span>
<span class="sd">    no : float</span>
<span class="sd">        Refractive index of the cladding.</span>
<span class="sd">    delta_no : float</span>
<span class="sd">        Difference of refractive index between the core and the cladding.</span>
<span class="sd">    length_z : float</span>
<span class="sd">        Size of the compute window over z (µm).</span>
<span class="sd">    dist_z : float</span>
<span class="sd">        Step over z (µm)</span>
<span class="sd">    nbr_z_disp : int</span>
<span class="sd">        Number of points to display over z.</span>
<span class="sd">    length_x : float</span>
<span class="sd">        Size of the compute window over x (µm).</span>
<span class="sd">    dist_x : float</span>
<span class="sd">        Step over x (µm)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">no</span><span class="p">,</span> <span class="n">delta_no</span><span class="p">,</span>
                 <span class="n">length_z</span><span class="p">,</span> <span class="n">dist_z</span><span class="p">,</span> <span class="n">nbr_z_disp</span><span class="p">,</span>
                 <span class="n">length_x</span><span class="p">,</span> <span class="n">dist_x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Bpm class is used to simulate light propagation -</span>
<span class="sd">        within small refractive index variation guides</span>
<span class="sd">        and small angle of propagation (paraxial) -</span>
<span class="sd">        using the Beam Propagation Method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        width : float</span>
<span class="sd">            Guide width defined as the diameter (µm) at 1/e^2 intensity.</span>
<span class="sd">        no : float</span>
<span class="sd">            Refractive index of the cladding</span>
<span class="sd">        delta_no : float</span>
<span class="sd">            Difference of refractive index between the core and the cladding.</span>
<span class="sd">        length_z : float</span>
<span class="sd">            Size of the compute window over z (µm).</span>
<span class="sd">        dist_z : float</span>
<span class="sd">            Step over z (µm).</span>
<span class="sd">        nbr_z_disp : int</span>
<span class="sd">            Number of points to display over z.</span>
<span class="sd">        length_x : float</span>
<span class="sd">            Size of the compute window over x (µm).</span>
<span class="sd">        dist_x : float</span>
<span class="sd">            Step over x (µm).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no</span> <span class="o">=</span> <span class="n">no</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span> <span class="o">=</span> <span class="n">delta_no</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length_z</span> <span class="o">=</span> <span class="n">length_z</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span> <span class="o">=</span> <span class="n">dist_z</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span> <span class="o">=</span> <span class="n">nbr_z_disp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span> <span class="o">=</span> <span class="n">dist_x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span> <span class="o">=</span> <span class="n">length_x</span>

        <span class="k">if</span> <span class="n">delta_no</span> <span class="o">&gt;</span> <span class="n">no</span><span class="o">/</span><span class="mi">10</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Careful: index variation is too high:&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">delta_no</span><span class="p">,</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="n">no</span><span class="p">,</span> <span class="s2">&quot;/ 10&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_x_z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create the x, z array and ajust the resolution variables.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        length_z : float</span>
<span class="sd">            Corrected value due to nbr_z being an int.</span>
<span class="sd">        nbr_z : int</span>
<span class="sd">            Number of points computed over z.</span>
<span class="sd">        nbr_z_disp : int</span>
<span class="sd">            Corrected value due to pas being an int.</span>
<span class="sd">        length_x : float</span>
<span class="sd">            Corrected value due to nbr_x being an int.</span>
<span class="sd">        nbr_x : int</span>
<span class="sd">            Number of point over x (µm).</span>
<span class="sd">        x : array</span>
<span class="sd">            x values between [-length_x/2, length_x/2-dist_x] center on 0.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method creates the following variables within the class</span>
<span class="sd">        :class:`Bpm`:</span>

<span class="sd">        - pas : Interval of computed points between each displayed points.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span> <span class="o">&gt;</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_z</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pas</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_z</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_z</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pas</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># add 1 for the initial field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># add 1 for the initial field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)</span>  <span class="c1"># nbr points over x</span>

        <span class="c1"># check if even number</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># check if multiple of 8: speeds up execution</span>
        <span class="c1"># (was also needed for a obsolete feature)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span> <span class="o">%</span> <span class="mi">8</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span> <span class="o">+=</span> <span class="mi">2</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">length_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>

    <span class="c1"># Guides #</span>

    <span class="k">def</span> <span class="nf">squared_guide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A lambda function than returns a centered rectangular shape.</span>

<span class="sd">        return 1 if :math:`x &gt;= -width/2` and :math:`x &lt;= width/2`</span>
<span class="sd">        else return 0.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This methods uses the width variable defined in :class:`Bpm`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">gauss_guide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gauss_pow</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A lambda function than return a centered super-Gaussian shape.</span>

<span class="sd">        :math:`e^{-(x/w)^{2P}}`</span>

<span class="sd">        The waist is defined as width/2 and correspond to the 1/e</span>
<span class="sd">        relative value.</span>

<span class="sd">        See :func:`.example_guides_x` for more details.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        gauss_pow : int</span>
<span class="sd">            Index of the super-gaussian guide with 1 being a regural gaussian</span>
<span class="sd">            guide and 4 being the conventionnal super-gaussian guide used to</span>
<span class="sd">            describe realistic guides.</span>
<span class="sd">            See on en.wikipedia.org/wiki/Gaussian_function</span>
<span class="sd">            #Higher-order_Gaussian_or_super-Gaussian_function</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This methods uses the width variable defined in :class:`Bpm`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="mi">0</span>
        <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># want diameter at 1/e =width so 2*w=witdh</span>
        <span class="k">return</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">w</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">gauss_pow</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">create_guides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nbr_p</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">offset_guide</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create an array of guides over x using peaks positions and for a given</span>
<span class="sd">        shape.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        shape : method</span>
<span class="sd">            :meth:`squared_guide`, :meth:`gauss_guide` or any lambda function</span>
<span class="sd">            that takes one argument and return the relative refractive index</span>
<span class="sd">            for the input position.</span>
<span class="sd">        nbr_p : int</span>
<span class="sd">            Number of guides.</span>
<span class="sd">        p : float</span>
<span class="sd">            Distance between two guides center (µm).</span>
<span class="sd">        offset_guide : float, optional</span>
<span class="sd">            Guide offset from the center (µm). 0 by default.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        peaks : array-like</span>
<span class="sd">            Central position of each guide [guide,z].</span>
<span class="sd">        dn : array-like</span>
<span class="sd">            Difference of reefractive index [z,x].</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This methods uses the following variables defined in :class:`Bpm`:</span>
<span class="sd">        nbr_z, nbr_x, x, dist_x, delta_no.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nbr_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">))</span>
        <span class="n">dn_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">)</span>

        <span class="n">peaks_z</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">nbr_p</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">nbr_p</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nbr_p</span><span class="p">)</span>
                   <span class="o">+</span> <span class="n">p</span><span class="o">/</span><span class="mi">2</span>
                   <span class="o">+</span> <span class="n">offset_guide</span><span class="p">)</span>
        <span class="n">dn_fix</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># guide shape center on 0</span>

        <span class="c1"># Sum each identical guide with an offset defined by peaks_z</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_p</span><span class="p">):</span>
            <span class="n">dn_z</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">dn_fix</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">peaks_z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)))</span>

        <span class="c1"># only necessary because this program can have curved guides</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">dn_z</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">peaks_z</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span>  <span class="c1"># give a value to the shape</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">create_curved_guides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">curve</span><span class="p">,</span> <span class="n">half_delay</span><span class="p">,</span>
                             <span class="n">distance_factor</span><span class="p">,</span> <span class="n">offset_guide</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create two curved guides and one linear guide on the center (STIRAP).</span>

<span class="sd">        The central positions over x and z are defined as follow:</span>

<span class="sd">        Left guide: :math:`x_0-p_{min}-curve(z-length\_z/2-half\_delay)^2`</span>

<span class="sd">        Right guide: :math:`x_0+p_{min}+curve(z-length\_z/2+half\_delay)^2`</span>

<span class="sd">        Central guide: :math:`x_0`</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        shape : method</span>
<span class="sd">            :meth:`square` or :meth:`gauss`</span>
<span class="sd">        curve : float</span>
<span class="sd">            curvature factor in :math:`10^{-8} µm^{-2}`.</span>
<span class="sd">        half_delay : float</span>
<span class="sd">            Half distance over z in µm bewteen the two external guides where</span>
<span class="sd">            they are the closest.</span>
<span class="sd">            In other words, the distance from the center and the minimum of one</span>
<span class="sd">            of the curved guides over z.</span>
<span class="sd">        distance_factor : float</span>
<span class="sd">            Factor between the guide width and the minimal distance between the</span>
<span class="sd">            two guides =p_min/width.</span>
<span class="sd">            If distance_factor=1, the curved guides will touch the central</span>
<span class="sd">            guide (p_min=width).</span>
<span class="sd">        offset_guide : float, optional</span>
<span class="sd">            Guide offset from the center (µm). 0 by default.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        peaks : array</span>
<span class="sd">            Central position of each guide as peaks[guide,z].</span>
<span class="sd">        dn : array</span>
<span class="sd">            Difference of reefractive index as dn[z,x].</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This methods uses the following variables defined in :class:`Bpm`:</span>
<span class="sd">        length_z, nbr_z, width, nbr_x, x, dist_x, delta_no.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># all points over z</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">length_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">)</span>

        <span class="c1"># left curved guide</span>
        <span class="n">sa</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span> <span class="n">offset_guide</span>
              <span class="o">+</span> <span class="n">curve</span><span class="o">*</span><span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">length_z</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">half_delay</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
              <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">*</span><span class="n">distance_factor</span><span class="p">)</span>

        <span class="c1"># right curved guide</span>
        <span class="n">sb</span> <span class="o">=</span> <span class="p">(</span><span class="n">offset_guide</span>
              <span class="o">+</span> <span class="n">curve</span><span class="o">*</span><span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">length_z</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">half_delay</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
              <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">*</span><span class="n">distance_factor</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">sa</span><span class="p">,</span>
                               <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">offset_guide</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">),</span>
                               <span class="n">sb</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">))</span>
        <span class="n">dn_fix</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>   <span class="c1"># guide shape center on 0</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">dn_fix</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="o">-</span><span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)))</span> \
                <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">dn_fix</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">offset_guide</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)))</span> \
                <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">dn_fix</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">sb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span>  <span class="c1"># give a value to the shape</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">]</span>

    <span class="c1"># Light #</span>

    <span class="k">def</span> <span class="nf">gauss_light</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">,</span> <span class="n">offset_light</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a gaussien beam in amplitude.</span>

<span class="sd">        :math:`E = e^{-((x-x_0)/w)^{2P}}`</span>

<span class="sd">        The waist is defined as fwhm/sqrt(2*log(2)) and correspond to the 1/e</span>
<span class="sd">        field value and 1/:math:`e^2` intensity value.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fwhm : float</span>
<span class="sd">            Full width at half maximum (for intensity not amplitude) (µm).</span>
<span class="sd">        offset_light : float, optional</span>
<span class="sd">            Light offset from center in µm. 0 by default.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        field : array</span>
<span class="sd">            Amplitude values over x in µm.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This methods uses the x and dist_x variables defined in :class:`Bpm`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">spot_size</span> <span class="o">=</span> <span class="n">fwhm</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>  <span class="c1"># such as I=1/e^2 in intensity</span>
        <span class="k">if</span> <span class="n">spot_size</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">/</span> <span class="n">spot_size</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">offset_light</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">field</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>  <span class="c1"># Avoid division by zero error</span>
        <span class="k">return</span> <span class="n">field</span>

    <span class="k">def</span> <span class="nf">squared_light</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">,</span> <span class="n">offset_light</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a flat-top beam (squared).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fwhm : float</span>
<span class="sd">            Width in µm.</span>
<span class="sd">        offset_light : float, optional</span>
<span class="sd">            Light offset from center in µm. 0 by default.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        field : array</span>
<span class="sd">            Amplitude values over x in µm.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This methods uses the following variables defined in :class:`Bpm`:</span>
<span class="sd">        nbr_x, x.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="n">fwhm</span><span class="o">/</span><span class="mi">2</span>
                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">fwhm</span><span class="o">/</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">field</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">field</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">offset_light</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">field</span>

    <span class="k">def</span> <span class="nf">mode_determ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Solve the transcendental equation tan=sqrt that give the modes</span>
<span class="sd">        allowed in a squared guide.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mode : int</span>
<span class="sd">            Number of the searched mode.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        h_m : float</span>
<span class="sd">            Transverse propagation constant over x (µm).</span>
<span class="sd">        gamma_m : float</span>
<span class="sd">            Extinction coefficient over x (µm).</span>
<span class="sd">        beta_m : float</span>
<span class="sd">            Longitudinal constant of propagation over z (µm).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            if no mode exists.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This methods uses the following variables defined in :class:`Bpm`:</span>
<span class="sd">        lo, width, no, delta_no, ko.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lo</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">))</span> <span class="o">-</span> <span class="mf">1e-12</span>
        <span class="n">theta_c</span> <span class="o">=</span> <span class="n">acos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">))</span>  <span class="c1"># Critical angle</span>
        <span class="n">solu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
            <span class="n">mode</span><span class="o">*</span><span class="n">lim</span> <span class="o">+</span> <span class="mf">0.000001</span><span class="p">,</span>
            <span class="p">(</span><span class="n">mode</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">lim</span><span class="p">,</span>
            <span class="nb">round</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">lim</span> <span class="o">-</span> <span class="mf">0.000001</span><span class="p">)</span><span class="o">/</span><span class="mf">0.000001</span><span class="p">))</span>
        <span class="n">lhs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span>
            <span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lo</span> <span class="o">*</span> <span class="n">solu</span>
            <span class="o">-</span> <span class="n">mode</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
            <span class="mi">0</span><span class="n">j</span>  <span class="c1"># to avoid sqrt error when complexe</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_c</span><span class="p">)</span> <span class="o">/</span> <span class="n">solu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
            <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">rhs</span> <span class="o">-</span> <span class="n">lhs</span>  <span class="c1"># 0 if left == right</span>
        <span class="n">minimum</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>  <span class="c1"># return min value : where two equations~=</span>
        <span class="n">i_min</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">==</span> <span class="n">minimum</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># min value index</span>

        <span class="k">if</span> <span class="n">i_min</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;no mode &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; existing&quot;</span><span class="p">)</span>

        <span class="n">sin_theta_m</span> <span class="o">=</span> <span class="n">solu</span><span class="p">[</span><span class="n">i_min</span><span class="p">]</span>
        <span class="n">theta_m</span> <span class="o">=</span> <span class="n">asin</span><span class="p">(</span><span class="n">sin_theta_m</span><span class="p">)</span>  <span class="c1"># angle at which the mode propagate</span>

        <span class="n">beta_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ko</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta_m</span><span class="p">)</span>
        <span class="n">h_m</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ko</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">beta_m</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">gamma_m</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ko</span>
                   <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_m</span><span class="p">)</span> <span class="o">/</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta_c</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">h_m</span><span class="p">,</span> <span class="n">gamma_m</span><span class="p">,</span> <span class="n">beta_m</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">mode_light</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">lo</span><span class="p">,</span> <span class="n">offset_light</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create light based on propagated mode inside a squared guide.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mode : int</span>
<span class="sd">            Number of the searched mode.</span>
<span class="sd">        lo : float</span>
<span class="sd">            Wavelength of the beam in vaccum (µm).</span>
<span class="sd">        offset_light : float, optional</span>
<span class="sd">            Light offset from center (µm). 0 by default.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        field : array</span>
<span class="sd">            Amplitude values over x (µm).</span>
<span class="sd">        h_m : float</span>
<span class="sd">            Transverse propagation constant over x (µm).</span>
<span class="sd">        gamma_m : float</span>
<span class="sd">            Extinction coefficient over x (µm).</span>
<span class="sd">        beta_m : float</span>
<span class="sd">            Longitudinal constant of propagation over z (µm).</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This methods uses the following variables defined in :class:`Bpm`:</span>
<span class="sd">        nbr_x, width, x and the :meth`mode_determ` method.</span>

<span class="sd">        This method create the following variables in :class:`Bpm`:</span>
<span class="sd">        lo, ko.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lo</span> <span class="o">=</span> <span class="n">lo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ko</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lo</span>  <span class="c1"># linear wave vector in free space (1/µm)</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">)</span>

        <span class="p">[</span><span class="n">h_m</span><span class="p">,</span> <span class="n">gamma_m</span><span class="p">,</span> <span class="n">beta_m</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode_determ</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mode</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># if even mode</span>

            <span class="n">b_b</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">h_m</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Continuity value where x=width/2</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">):</span>  <span class="c1"># Compute light based on h,gamma,beta</span>

                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>  <span class="c1"># in core</span>
                    <span class="n">field</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">h_m</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

                <span class="k">else</span><span class="p">:</span>  <span class="c1"># in cladding</span>
                    <span class="n">field</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">b_b</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">gamma_m</span> <span class="o">*</span> <span class="p">(</span>
                        <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                        <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if odd mode</span>

            <span class="n">c_c</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">h_m</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Continuity value where x=width/2</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">):</span>  <span class="c1"># Compute light based on h,gamma,beta</span>

                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>  <span class="c1"># in core</span>
                    <span class="n">field</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">h_m</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>  <span class="c1"># Right cladding</span>
                    <span class="n">field</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_c</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">gamma_m</span> <span class="o">*</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                        <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>

                <span class="k">else</span><span class="p">:</span>  <span class="c1"># Left cladding</span>
                    <span class="n">field</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">c_c</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">gamma_m</span> <span class="o">*</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>

        <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">offset_light</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)))</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">field</span><span class="p">,</span> <span class="n">h_m</span><span class="p">,</span> <span class="n">gamma_m</span><span class="p">,</span> <span class="n">beta_m</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">all_modes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lo</span><span class="p">,</span> <span class="n">offset_light</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute all modes allowed by the guide and sum them into one field.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lo : float</span>
<span class="sd">            Wavelength of the beam in vaccum in µm.</span>
<span class="sd">        offset_light : float, optional</span>
<span class="sd">            Light offset from center in µm. 0 by default.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        field : array</span>
<span class="sd">            Sum of all possibles fields in the guide.</span>
<span class="sd">        h : array, float</span>
<span class="sd">            Transverse propagation constant over x in µm of all modes.</span>
<span class="sd">        gamma : array, float</span>
<span class="sd">            Extinction coefficient over z in µm of all modes.</span>
<span class="sd">        beta : array, float</span>
<span class="sd">            Longitudinal constant of propagation over z in µm of all modes.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This methods uses the following variables defined in :class:`Bpm`:</span>
<span class="sd">        nbr_x and the :meth`mode_light` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="p">[</span><span class="n">field_i</span><span class="p">,</span> <span class="n">h_m</span><span class="p">,</span> <span class="n">gamma_m</span><span class="p">,</span> <span class="n">beta_m</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode_light</span><span class="p">(</span>
                    <span class="n">i</span><span class="p">,</span> <span class="n">lo</span><span class="p">,</span> <span class="n">offset_light</span><span class="p">)</span>
                <span class="n">field</span> <span class="o">=</span> <span class="n">field</span> <span class="o">+</span> <span class="n">field_i</span>
                <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">h_m</span><span class="p">)</span>
                <span class="n">gamma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">gamma_m</span><span class="p">)</span>
                <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">beta_m</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This guide can propagate up to the modes&quot;</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">field</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">beta</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">check_modes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the last possible mode number.</span>
<span class="sd">        Could be merged with :meth:`all_modes` but would increase the needed</span>
<span class="sd">        time to compute just to display a number.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lo : float</span>
<span class="sd">            Wavelength of the beam in vaccum (µm).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        m : int</span>
<span class="sd">            Number of the last possible mode for a squared guide.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This methods uses the :meth`mode_light` method defined in :class:`Bpm`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mode_light</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">lo</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This guide can propagate up to the modes&quot;</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span> <span class="nf">airy_light</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lobe_size</span><span class="p">,</span> <span class="n">airy_zero</span><span class="p">,</span> <span class="n">offset_light</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create an Airy beam using scipy.special.airy(x).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lobe_size : float</span>
<span class="sd">            Size of the first lobe (µm).</span>
<span class="sd">        airy_zero : int</span>
<span class="sd">            Cut the beam at the asked zero of the Airy function. n lobes will</span>
<span class="sd">            be displayed.</span>
<span class="sd">        offset_light : float, optional</span>
<span class="sd">            Light offset from center in µm. 0 by default.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        field : array</span>
<span class="sd">            Amplitude values over x (µm).</span>
<span class="sd">        airy_zero : int</span>
<span class="sd">            Number of lobes. Corrected if higher than the window size.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This methods uses the following variables defined in :class:`Bpm`:</span>
<span class="sd">        nbr_x, length_x, dist_x, x.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">lobe_size</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">airy_zero</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">),</span> <span class="mi">0</span><span class="p">]</span>

        <span class="n">lobe_size</span> <span class="o">=</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">lobe_size</span><span class="p">)</span>

        <span class="c1"># Position of the first zero and the asked one</span>
        <span class="n">zero_pos</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">ai_zeros</span><span class="p">(</span><span class="n">airy_zero</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">first_zero</span> <span class="o">=</span> <span class="n">zero_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">last_zero</span> <span class="o">=</span> <span class="n">zero_pos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Positions/size of the wanted beam</span>
        <span class="n">left</span> <span class="o">=</span> <span class="n">last_zero</span> <span class="o">*</span> <span class="n">lobe_size</span> <span class="o">/</span> <span class="n">first_zero</span>
        <span class="n">right</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">lobe_size</span> <span class="o">/</span> <span class="n">first_zero</span>  <span class="c1"># Airy=1e-10 at x=10</span>

        <span class="c1"># Reduce the last zero number to stay in the window</span>
        <span class="k">if</span> <span class="o">-</span><span class="n">left</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="p">:</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">zero_pos</span> <span class="o">*</span> <span class="n">lobe_size</span> <span class="o">/</span> <span class="n">first_zero</span>  <span class="c1"># All possibles left posi</span>
            <span class="n">airy_zero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">-</span><span class="n">left</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Higher index</span>

            <span class="k">if</span> <span class="n">airy_zero</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># interface don&#39;t allow this situation</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The first lobe is bigger than the windows size&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">),</span> <span class="mi">0</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>  <span class="c1"># take the higher lobe possible</span>
                <span class="n">airy_zero</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">airy_zero</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="n">last_zero</span> <span class="o">=</span> <span class="n">zero_pos</span><span class="p">[</span><span class="n">airy_zero</span><span class="p">]</span>  <span class="c1"># Value of the last lobe</span>
            <span class="n">airy_zero</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># +1 to return the zero number</span>

            <span class="n">left</span> <span class="o">=</span> <span class="n">last_zero</span> <span class="o">*</span> <span class="n">lobe_size</span> <span class="o">/</span> <span class="n">first_zero</span>  <span class="c1"># Corrected left positio</span>

        <span class="c1"># Number of points in the Airy window to match the full window</span>
        <span class="n">nbr_point</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="n">left</span> <span class="o">-</span> <span class="n">right</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)))</span>

        <span class="c1"># Airy window size</span>
        <span class="n">x_airy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">last_zero</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">nbr_point</span><span class="p">)</span>

        <span class="c1"># Positions of the Airy and full window center</span>
        <span class="n">center_airy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x_airy</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">center</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># Airy field</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">special</span><span class="o">.</span><span class="n">airy</span><span class="p">(</span><span class="n">x_airy</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># add last empty field to reach the windows size</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="n">field</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
            <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="o">-</span><span class="n">field</span><span class="o">.</span><span class="n">size</span><span class="p">)))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">field</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>  <span class="c1"># Cut if exceed windows size</span>

        <span class="c1"># Recenter on 0</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">center</span> <span class="o">-</span> <span class="n">center_airy</span><span class="p">)))</span>

        <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">offset_light</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)))</span>
        <span class="n">field</span> <span class="o">/=</span> <span class="nb">max</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>  <span class="c1"># Normalized</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">field</span><span class="p">,</span> <span class="n">airy_zero</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">init_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">theta_ext</span><span class="p">,</span> <span class="n">irrad</span><span class="p">,</span> <span class="n">lo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize phase, field and power variables.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field : array, array-like</span>
<span class="sd">            Amplitude values for each beams over x (µm) [beam,E] or E</span>
<span class="sd">        theta_ext : float</span>
<span class="sd">            Exterior inclinaison angle (°).</span>
<span class="sd">        irrad : array, array-like</span>
<span class="sd">            Irradiance or power for each beam (:math:`W/m^2`).</span>
<span class="sd">        lo : float</span>
<span class="sd">            Wavelenght (µm).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        progress_pow : array</span>
<span class="sd">            Intensity values over x (µm).</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method creates the following variables within the class</span>
<span class="sd">        :class:`Bpm`:</span>

<span class="sd">        - epnc: Convertion factor used to set unit of the field and irradiance.</span>
<span class="sd">        - nl_mat: Refractive index modulation.</span>
<span class="sd">        - phase_mat: Free propagation in Fourier space over dz/2.</span>
<span class="sd">        - current_power: Intensity for z=0.</span>
<span class="sd">        - field: Field value with the unit.</span>
<span class="sd">        - ko: the free space vector (1/µm).</span>
<span class="sd">        - lo: Wavelenght (µm).</span>

<span class="sd">        This methods uses the following variables defined in :class:`Bpm`:</span>
<span class="sd">        no, x, dist_x, nbr_x, nbr_z_disp.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lo</span> <span class="o">=</span> <span class="n">lo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>
        <span class="c1"># see en.wiki: Gaussian_beam#Mathematical_form for intensity definition</span>
        <span class="n">Zo</span> <span class="o">=</span> <span class="mf">376.730313668</span>  <span class="c1"># Impedance of free space mu_0*c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epnc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">no</span> <span class="o">/</span> <span class="n">Zo</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># = 1 / (2 eta) used to converte E into I</span>
        <span class="c1">#  unit(epnc)= W/V^2</span>

        <span class="k">try</span><span class="p">:</span>  <span class="c1"># if multiple beams or one beam as [beam]</span>
            <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Raise a IndexError if not</span>
            <span class="n">nbr_light</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># [beam1,beam2,beam3] -&gt; 3</span>
<span class="c1">#            Eo = sqrt(irrad[i] / self.epnc)  # Peak value of the field (V/m).</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_light</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">irrad</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">epnc</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># merge all beam into one</span>

        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>  <span class="c1"># if only one beam and not in form [beam]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">field</span> <span class="o">*=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">irrad</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">epnc</span><span class="p">)</span>

<span class="c1">#        https://support.lumerical.com/hc/en-us/articles/</span>
<span class="c1">#        360034382894-Understanding-injection-angles-in-broadband-simulations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ko</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lo</span>  <span class="c1"># linear wave vector in free space (1/µm)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">asin</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_ext</span><span class="p">))</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">no</span><span class="p">)</span>  <span class="c1"># angle in the guide</span>
        <span class="n">ph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">no</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ko</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>  <span class="c1"># k projection over x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">ph</span><span class="p">)</span>  <span class="c1"># Initial phase due to angle</span>

        <span class="n">nu_max</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)</span>  <span class="c1"># max frequency due to sampling</span>
        <span class="c1"># Spacial frequencies over x (1/µm)</span>
        <span class="n">nu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">nu_max</span><span class="p">,</span>
                         <span class="n">nu_max</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">),</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">)</span>
        <span class="n">intermed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">no</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lo</span>
        <span class="c1"># Linear propagation phase</span>
        <span class="n">fr</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">nu</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">intermed</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
            <span class="n">intermed</span><span class="o">**</span><span class="mi">2</span>
            <span class="o">-</span> <span class="n">nu</span><span class="o">**</span><span class="mi">2</span>
            <span class="o">+</span> <span class="mi">0</span><span class="n">j</span><span class="p">))</span>

        <span class="c1"># Free space matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phase_mat</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">fr</span><span class="p">))</span>

        <span class="c1"># Refractive index modulation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nl_mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ko</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn</span>

        <span class="c1"># Initial irradiance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epnc</span> <span class="o">*</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">field</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span><span class="o">.</span><span class="n">real</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">current_power</span><span class="p">])</span>

        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">guide_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guide</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the left and right position index over x of a given guide</span>
<span class="sd">        for each z.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        guide : int</span>
<span class="sd">            Number of the guide.</span>
<span class="sd">        size : float</span>
<span class="sd">            Width (µm).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        x_beg : array</span>
<span class="sd">            Left indices position of the selected guide over z.</span>
<span class="sd">        x_end : array</span>
<span class="sd">            Right indices position of the selected guide over z.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This methods uses the following variables defined in :class:`Bpm`:</span>
<span class="sd">        nbr_z, peaks, x, length_x.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x_beg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>  <span class="c1"># Note: don&#39;t use x_end=x_beg</span>
        <span class="n">x_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>  <span class="c1"># Because id would be ==</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">):</span>

                <span class="n">pos_beg</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">[</span><span class="n">guide</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Left position</span>

                <span class="c1"># If the position is out of boundery, change interval to</span>
                <span class="c1"># (-length_x/2, length_x)</span>
                <span class="k">if</span> <span class="n">pos_beg</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">pos_beg</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">pos_beg</span> <span class="o">=</span> <span class="n">pos_beg</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span>

                <span class="c1"># If the pos_beg is between length_x/2 and length_x then change</span>
                <span class="c1"># interval to (-length_x/2, length_x/2)</span>
                <span class="k">if</span> <span class="n">pos_beg</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">pos_beg</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span>

                <span class="c1"># Search the closest index value for this position</span>
                <span class="n">x_beg</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">pos_beg</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

                <span class="n">pos_end</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">[</span><span class="n">guide</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">pos_end</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">pos_end</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">pos_end</span> <span class="o">=</span> <span class="n">pos_end</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span>

                <span class="k">if</span> <span class="n">pos_end</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">pos_end</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span>

                <span class="n">x_end</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">pos_end</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">x_beg</span><span class="p">,</span> <span class="n">x_end</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">power_guide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_beg</span><span class="p">,</span> <span class="n">x_end</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return the approximative power over z in a given guide.</span>
<span class="sd">        A better method would be to deconvolve the beams.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x_beg : array</span>
<span class="sd">            Left indices position over z for a selected guide.</span>
<span class="sd">        x_end : array</span>
<span class="sd">            Right indices position over z for a selected guide.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        P : array</span>
<span class="sd">            Power in the guide over z.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This methods uses the following variables defined in :class:`Bpm`:</span>
<span class="sd">        nbr_z_disp, progress_pow.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">x_beg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">x_end</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">x_beg</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span><span class="n">x_end</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>

            <span class="k">else</span><span class="p">:</span>  <span class="c1"># Take into account guides that crosses the window edges</span>
                <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">x_beg</span><span class="p">[</span><span class="n">i</span><span class="p">]:])</span>
                <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="n">x_end</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>

        <span class="n">P</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">P</span>

    <span class="k">def</span> <span class="nf">losses_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guide_lost</span><span class="p">,</span> <span class="n">width_lost</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the left and right position (x) index of a given area</span>
<span class="sd">        over z [x,z].</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        guide_lost : array</span>
<span class="sd">            Number of each guide where looses occurs.</span>
<span class="sd">        width_lost : array</span>
<span class="sd">            Half width in µm for each guide.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        lost_beg : array-like</span>
<span class="sd">            Left indices position of the selected guides over z.</span>
<span class="sd">        lost_end : array-like</span>
<span class="sd">            Right indices position of the selected guides over z.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This methods uses the nbr_z variables defined in :class:`Bpm` and</span>
<span class="sd">        the :meth:`guide_position` method.</span>
<span class="sd">        It also creates the nbr_lost variable shared with :class:`Bpm`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_lost</span> <span class="o">=</span> <span class="n">guide_lost</span><span class="o">.</span><span class="n">size</span>
        <span class="n">lost_beg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_lost</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">lost_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_lost</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">guide_lost</span><span class="p">):</span>
            <span class="p">[</span><span class="n">lost_beg</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span>
             <span class="n">lost_end</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">guide_position</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">width_lost</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">lost_beg</span><span class="p">,</span> <span class="n">lost_end</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">kerr_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chi3</span><span class="o">=</span><span class="mf">1e-19</span><span class="p">,</span> <span class="n">kerr_loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">variance_check</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">field_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dn_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">phase_mat</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Kerr effect: refractive index modulation by the light intensity.</span>
<span class="sd">        See: https://optiwave.com/optibpm-manuals/bpm-non-linear-bpm-algorithm/</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        chi3 : float, optional</span>
<span class="sd">            Value of the third term of the electric susceptibility tensor.</span>
<span class="sd">            Equals to :math:`10^{-19} m^2/V^2` by default.</span>
<span class="sd">        kerr_loop : int, optional</span>
<span class="sd">            Number of corrective loops for the Kerr effect. 1 by default.</span>
<span class="sd">        variance_check : bool, optional</span>
<span class="sd">            Check if the kerr effect converge fast enought. False by default.</span>
<span class="sd">        field_start : array, optional</span>
<span class="sd">            Field without kerr effect.</span>
<span class="sd">            If None were given, take the :meth:`main_compute` field.</span>
<span class="sd">        dn_start : array, optional</span>
<span class="sd">            Refractive index without kerr effect.</span>
<span class="sd">            If None were given, take the :meth:`main_compute` dn.</span>
<span class="sd">        phase_mat: array, optional</span>
<span class="sd">            Free propagation in Fourier space over dz/2.</span>
<span class="sd">            If None were given, take the :meth:`main_compute` phase_mat.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dn : array</span>
<span class="sd">            Refractive index with kerr effect.</span>
<span class="sd">        nl_mat : array</span>
<span class="sd">            refractive index modulation with kerr effect.</span>
<span class="sd">        field_x : array</span>
<span class="sd">            Field with the kerr effect at the self.i step.</span>
<span class="sd">        cur_pow : array</span>
<span class="sd">            Beam power with the kerr effect after the dz propagation.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This methods uses the following variables defined in :class:`Bpm`:</span>
<span class="sd">        i, epnc, no, ko, dist_z and the :meth:`variance` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Set the default value if none were given</span>
        <span class="n">dn_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="k">if</span> <span class="n">dn_start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dn_start</span>
        <span class="n">nl_mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ko</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span> <span class="o">*</span> <span class="n">dn_start</span>
        <span class="n">field_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span> <span class="k">if</span> <span class="n">field_start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">field_start</span>
        <span class="n">phase_mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_mat</span> <span class="k">if</span> <span class="n">phase_mat</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">phase_mat</span>

        <span class="c1"># Influence of the index modulation on the field</span>
        <span class="n">field_x</span> <span class="o">=</span> <span class="n">field_start</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">nl_mat</span><span class="p">)</span>

        <span class="c1"># Linear propagation over dz/2</span>
        <span class="n">field_x</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">phase_mat</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field_x</span><span class="p">))</span>

        <span class="n">cur_pow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epnc</span> <span class="o">*</span> <span class="p">(</span><span class="n">field_x</span> <span class="o">*</span> <span class="n">field_x</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span><span class="o">.</span><span class="n">real</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">kerr_loop</span><span class="p">):</span>
            <span class="n">prev_pow</span> <span class="o">=</span> <span class="n">cur_pow</span>

            <span class="c1"># influence of the beam intensity on the index modulation</span>
            <span class="c1"># dn = dn1+dn2*I with dn2 unit: m^2/W</span>
            <span class="n">dn</span> <span class="o">=</span> <span class="n">dn_start</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">chi3</span> <span class="o">/</span> <span class="mi">8</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">no</span> <span class="o">*</span> <span class="n">prev_pow</span><span class="p">)</span>
            <span class="n">nl_mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ko</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span> <span class="o">*</span> <span class="n">dn</span>

            <span class="c1"># influence of the index modulation on the field</span>
            <span class="n">field_x</span> <span class="o">=</span> <span class="n">field_start</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">nl_mat</span><span class="p">)</span>

            <span class="c1"># Linear propagation over dz/2</span>
            <span class="n">field_x</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">phase_mat</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field_x</span><span class="p">))</span>

            <span class="c1"># power at z</span>
            <span class="n">cur_pow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epnc</span> <span class="o">*</span> <span class="p">(</span><span class="n">field_x</span> <span class="o">*</span> <span class="n">field_x</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span><span class="o">.</span><span class="n">real</span>

        <span class="k">if</span> <span class="n">variance_check</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">prev_pow</span><span class="p">,</span> <span class="n">cur_pow</span><span class="p">)</span>  <span class="c1"># Check if converge</span>

            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;for the step i=&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">dn</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">no</span><span class="o">/</span><span class="mi">10</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Index variation too high:&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">dn</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">no</span><span class="p">,</span> <span class="s2">&quot;/10&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">dn</span><span class="p">,</span> <span class="n">nl_mat</span><span class="p">,</span> <span class="n">field_x</span><span class="p">,</span> <span class="n">cur_pow</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">variance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial</span><span class="p">,</span> <span class="n">final</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method alerts the user when the kerr effect don&#39;t converge fast</span>
<span class="sd">        enought.</span>
<span class="sd">        Raise a ValueError when the power standard deviation exceed</span>
<span class="sd">        :math:`10^{-7}`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        initial : array</span>
<span class="sd">            Power of the kerr effect looped n-1 time.</span>
<span class="sd">        final : array</span>
<span class="sd">            Power of the kerr effect looped n time.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            when the power standard deviation exceed :math:`10^{-7}`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">finish_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">final</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nl_control_amp</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">finish_sum</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span>
            <span class="nb">sum</span><span class="p">((</span><span class="n">final</span> <span class="o">-</span> <span class="n">initial</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">final</span> <span class="o">-</span> <span class="n">initial</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nl_control_amp</span> <span class="o">&gt;</span> <span class="mf">1e-7</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Warning: don&#39;t converge fast enough &quot;</span> <span class="o">+</span> \
                <span class="s2">&quot;for a deviation of &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nl_control_amp</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">absorption</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">lost_beg</span><span class="p">,</span> <span class="n">lost_end</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Absorption into a guide or several guides.</span>

<span class="sd">        :math:`e^{-\\alpha * dz}`</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        alpha : float</span>
<span class="sd">            Absorption per µm.</span>
<span class="sd">        lost_beg : array-like</span>
<span class="sd">            Left indices position of the selected guides over z.</span>
<span class="sd">        lost_end : array-like</span>
<span class="sd">            Right indices position of the selected guides over z.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        field : array</span>
<span class="sd">            Amplitude values over x in µm after looses.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This methods uses the following variables defined in :class:`Bpm`:</span>
<span class="sd">        nbr_lost, i, field, dist_z, nbr_x.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_lost</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">lost_beg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">lost_end</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">]:</span>  <span class="c1"># Normal case</span>

                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lost_beg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">],</span> <span class="n">lost_end</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>  <span class="c1"># Take into account guide crossing the window edges</span>

                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lost_beg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">lost_end</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span>

    <span class="k">def</span> <span class="nf">bpm_compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chi3</span><span class="o">=</span><span class="mf">1e-19</span><span class="p">,</span> <span class="n">kerr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">kerr_loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">variance_check</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lost_beg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lost_end</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute BPM principle : free_propag over dz/2, index modulation,</span>
<span class="sd">        free_propag over dz/2.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        chi3 : float, optional</span>
<span class="sd">            Value of the effective third term of the electric susceptibility</span>
<span class="sd">            tensor. Equals to :math:`10^{-19} m^2/V^2` by default.</span>
<span class="sd">        kerr : bool, optional</span>
<span class="sd">            Activate the kerr effect. False by default.</span>
<span class="sd">        kerr_loop : int, optional</span>
<span class="sd">            Number of corrective loops for the Kerr effect. 1 by default.</span>
<span class="sd">        variance_check : bool</span>
<span class="sd">            Check if the kerr effect converge fast enought. False by default.</span>
<span class="sd">        alpha : float, optional</span>
<span class="sd">            Absorption per µm. 0 by default.</span>
<span class="sd">        lost_beg : array-like, optional</span>
<span class="sd">            Left indices position of the selected guides over z.</span>
<span class="sd">            None by default.</span>
<span class="sd">        lost_end : array-like, optional</span>
<span class="sd">            Right indices position of the selected guides over z.</span>
<span class="sd">            None by default.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        current_power : array</span>
<span class="sd">            Power after the propagation over dz.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method uses the :class:`Bpm` class variables:</span>
<span class="sd">        nbr_lost, i, field, dist_z, dn, nl_mat, phase_mat, epnc.</span>

<span class="sd">        This method change the values of:</span>
<span class="sd">        field, dn, nl_mat, current_power.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Linear propagation over dz/2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase_mat</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">))</span>

        <span class="c1"># Absorption into a guide</span>
        <span class="k">if</span> <span class="n">alpha</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">absorption</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">lost_beg</span><span class="p">,</span> <span class="n">lost_end</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">kerr</span><span class="p">:</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nl_mat</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_power</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kerr_effect</span><span class="p">(</span>
                 <span class="n">chi3</span><span class="o">=</span><span class="n">chi3</span><span class="p">,</span> <span class="n">kerr_loop</span><span class="o">=</span><span class="n">kerr_loop</span><span class="p">,</span> <span class="n">variance_check</span><span class="o">=</span><span class="n">variance_check</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Influence of the index modulation on the field</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">field</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nl_mat</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>

            <span class="c1"># Linear propagation over dz/2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase_mat</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">))</span>

            <span class="c1"># power at z</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epnc</span> <span class="o">*</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">field</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span><span class="o">.</span><span class="n">real</span>

        <span class="c1"># useless but act as a reminder for what the the method does</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_power</span>

    <span class="k">def</span> <span class="nf">main_compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chi3</span><span class="o">=</span><span class="mf">1e-19</span><span class="p">,</span> <span class="n">kerr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">kerr_loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                     <span class="n">variance_check</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lost_beg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lost_end</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        main method used to compute propagation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        chi3 : float, optional</span>
<span class="sd">            Value of the third term of the electric susceptibility tensor.</span>
<span class="sd">            Equals to :math:`10^{-19} m^2/V^2` by default.</span>
<span class="sd">        kerr : bool, optional</span>
<span class="sd">            Activate the kerr effect. False by default.</span>
<span class="sd">        kerr_loop : int, optional</span>
<span class="sd">            Number of corrective loop for the Kerr effect. 1 by default.</span>
<span class="sd">        variance_check : bool, optional</span>
<span class="sd">            Check if the kerr effect converge fast enought. False by default.</span>
<span class="sd">        alpha : float, optional</span>
<span class="sd">            Absorption per µm. 0 by default</span>
<span class="sd">        lost_beg : array-like, optional</span>
<span class="sd">            Left indices position of the selecteds guide over z.</span>
<span class="sd">            None by default.</span>
<span class="sd">        lost_end : array-like, optional</span>
<span class="sd">            Right indices position of the selecteds guide over z.</span>
<span class="sd">            None by default.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        progress_pow : array</span>
<span class="sd">            Intensity values (:math:`W/m^2`) over x (µm) and z (µm).</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This methood uses the :class:`Bpm` class variables:</span>
<span class="sd">        phase_mat, field, i, nbr_z, pas, current_power, dist_z, length_z,</span>
<span class="sd">        nbr_lost, dn, nl_mat, epnc and uses the :meth:`bpm_compute`,</span>
<span class="sd">        :meth:`kerr_effect`.</span>

<span class="sd">        This method change the values of the :class:`Bpm` class variables:</span>
<span class="sd">        field and if kerr, dn and nl_mat.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">#  from i=0 to i=final-1 because don&#39;t use last dn</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="n">i</span>
            <span class="c1"># Compute non-linear and linear propagation for every z</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bpm_compute</span><span class="p">(</span>
                <span class="n">chi3</span><span class="o">=</span><span class="n">chi3</span><span class="p">,</span> <span class="n">kerr</span><span class="o">=</span><span class="n">kerr</span><span class="p">,</span> <span class="n">kerr_loop</span><span class="o">=</span><span class="n">kerr_loop</span><span class="p">,</span>
                <span class="n">variance_check</span><span class="o">=</span><span class="n">variance_check</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                <span class="n">lost_beg</span><span class="o">=</span><span class="n">lost_beg</span><span class="p">,</span> <span class="n">lost_end</span><span class="o">=</span><span class="n">lost_end</span><span class="p">)</span>

            <span class="c1"># Display condition: if i+1 is a multiple of pas: i+1 % pas = 0</span>
            <span class="c1"># = False, so must use if not to have True</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">pas</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">current_power</span><span class="p">])</span>

                <span class="nb">print</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">length_z</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;mm&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">example_bpm</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Version allowing to compute BPM without the user interface.</span>
<span class="sd">    Used for quick test.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">no</span> <span class="o">=</span> <span class="mf">2.14</span>
    <span class="n">delta_no</span> <span class="o">=</span> <span class="mf">0.001</span>
    <span class="n">length_z</span> <span class="o">=</span> <span class="mi">10000</span>
    <span class="n">dist_z</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">nbr_z_disp</span> <span class="o">=</span> <span class="mi">200</span>
    <span class="n">dist_x</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">length_x</span> <span class="o">=</span> <span class="mi">500</span>

    <span class="n">bpm</span> <span class="o">=</span> <span class="n">Bpm</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">no</span><span class="p">,</span> <span class="n">delta_no</span><span class="p">,</span>
              <span class="n">length_z</span><span class="p">,</span> <span class="n">dist_z</span><span class="p">,</span> <span class="n">nbr_z_disp</span><span class="p">,</span>
              <span class="n">length_x</span><span class="p">,</span> <span class="n">dist_x</span><span class="p">)</span>

    <span class="p">[</span><span class="n">length_z</span><span class="p">,</span> <span class="n">nbr_z</span><span class="p">,</span> <span class="n">nbr_z_disp</span><span class="p">,</span> <span class="n">length_x</span><span class="p">,</span> <span class="n">nbr_x</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">create_x_z</span><span class="p">()</span>

<span class="c1">#    shape = bpm.squared_guide()</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">gauss_guide</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

    <span class="n">nbr_p</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">13</span>
    <span class="n">offset_guide</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="p">[</span><span class="n">peaks</span><span class="p">,</span> <span class="n">dn</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">create_guides</span><span class="p">(</span>
        <span class="n">shape</span><span class="p">,</span> <span class="n">nbr_p</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">offset_guide</span><span class="o">=</span><span class="n">offset_guide</span><span class="p">)</span>
<span class="c1">#    curve = 40 * 1E-8</span>
<span class="c1">#    half_delay = 1000</span>
<span class="c1">#    distance_factor = 1.2</span>
<span class="c1">#    [peaks, dn] = bpm.create_curved_guides(shape, curve, half_delay,</span>
<span class="c1">#                                           distance_factor,</span>
<span class="c1">#                                           offset_guide=offset_guide)</span>

    <span class="n">z_disp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length_z</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">nbr_z_disp</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">xv</span><span class="p">,</span> <span class="n">zv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z_disp</span><span class="p">)</span>
    <span class="n">dn_disp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nbr_z</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nbr_z_disp</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

<span class="c1">#    plt.figure()</span>
<span class="c1">#    for i in range(nbr_z_disp+1):</span>
<span class="c1">#        plt.plot(x,dn[i,:])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span>
                   <span class="n">zv</span><span class="p">,</span>
                   <span class="n">dn</span><span class="p">[</span><span class="n">dn_disp</span><span class="p">],</span>
                   <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">fwhm</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">offset_light</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># If guide exists</span>
<span class="c1">#        offset_light = 0  # Else</span>
    <span class="n">lo</span> <span class="o">=</span> <span class="mf">1.5</span>
    <span class="n">nbr_light</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nbr_x</span><span class="p">)]</span> <span class="o">*</span> <span class="n">nbr_light</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_light</span><span class="p">):</span>
        <span class="n">field_i</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">gauss_light</span><span class="p">(</span><span class="n">fwhm</span><span class="p">,</span> <span class="n">offset_light</span><span class="o">=</span><span class="n">offset_light</span><span class="p">)</span>

    <span class="c1">#    field_i = bpm.squared_light(fwhm, offset_light=offset_light)</span>

<span class="c1">#            [field_i, h, gamma, beta] = bpm.all_modes(</span>
<span class="c1">#                lo, offset_light=offset_light)</span>

<span class="c1">#        mode = 0</span>
<span class="c1">#            [field_i, h, gamma, beta] = bpm.mode_light(</span>
<span class="c1">#                mode, lo, offset_light=offset_light)</span>

        <span class="n">field</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_i</span>

    <span class="n">irrad</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">*</span> <span class="mf">1E13</span><span class="p">]</span><span class="o">*</span><span class="n">nbr_light</span>
    <span class="n">theta_ext</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="p">[</span><span class="n">progress_pow</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">init_field</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">theta_ext</span><span class="p">,</span> <span class="n">irrad</span><span class="p">,</span> <span class="n">lo</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_show_plot</span><span class="p">(</span><span class="n">pow_index</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pow_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Light injection into a guide&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Light at the end of guides&quot;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (µm)&#39;</span><span class="p">)</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">tl</span> <span class="ow">in</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
            <span class="n">tl</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">tl</span> <span class="ow">in</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
            <span class="n">tl</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;#1f77b4&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Delta_n$&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Irradiance ($GW.cm^{-2}$)&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">nbr_p</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">nbr_p</span><span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="n">nbr_p</span><span class="o">*</span><span class="n">p</span><span class="p">)</span>
            <span class="n">verts</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
                     <span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dn</span><span class="p">[</span><span class="n">pow_index</span><span class="p">,</span> <span class="p">:]),</span>
                     <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
                     <span class="p">]</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">verts</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;0.9&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
                     <span class="nb">max</span><span class="p">(</span><span class="n">dn</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span><span class="o">*</span><span class="mf">1.1</span> <span class="o">+</span> <span class="mf">1E-20</span>
                     <span class="p">)</span>
        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">progress_pow</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
                         <span class="mf">1e-13</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="n">progress_pow</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">)</span>

        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dn</span><span class="p">[</span><span class="n">pow_index</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1e-13</span><span class="o">*</span><span class="n">progress_pow</span><span class="p">[</span><span class="n">pow_index</span><span class="p">],</span> <span class="s1">&#39;#1f77b4&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">pow_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;close the graph to continue&quot;</span><span class="p">)</span>
    <span class="n">_show_plot</span><span class="p">(</span><span class="n">pow_index</span><span class="p">)</span>

    <span class="n">kerr</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">kerr_loop</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">variance_check</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">chi3</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="mf">1E-20</span>

    <span class="n">lost_check</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">guide_lost</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">width_lost</span> <span class="o">=</span> <span class="n">width</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>

    <span class="k">if</span> <span class="n">lost_check</span><span class="p">:</span>
        <span class="n">guide_lost</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">guide_lost</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">width_lost</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">width_lost</span><span class="p">])</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">/</span><span class="mi">1000</span>
        <span class="p">[</span><span class="n">lost_beg</span><span class="p">,</span> <span class="n">lost_end</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">losses_position</span><span class="p">(</span>
            <span class="n">guide_lost</span><span class="p">,</span> <span class="n">width_lost</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">lost_beg</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">lost_end</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">estimation</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
        <span class="mf">8.8</span> <span class="o">/</span> <span class="mf">5e7</span> <span class="o">*</span> <span class="n">nbr_z</span> <span class="o">*</span> <span class="n">nbr_x</span>  <span class="c1"># without kerr</span>
        <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.72</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">kerr</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kerr_loop</span><span class="p">))</span>  <span class="c1"># with kerr</span>
        <span class="o">+</span> <span class="mf">3.8</span><span class="o">/</span><span class="mf">5e6</span><span class="o">*</span><span class="n">nbr_z</span><span class="o">*</span><span class="n">nbr_x</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">variance_check</span><span class="p">)</span>  <span class="c1"># control</span>
        <span class="o">+</span> <span class="mi">9</span><span class="o">/</span><span class="mf">1e7</span><span class="o">*</span><span class="n">nbr_z</span><span class="o">*</span><span class="n">width_lost</span><span class="o">/</span><span class="n">dist_x</span><span class="o">*</span><span class="n">lost_check</span><span class="p">,</span>
        <span class="mi">1</span><span class="p">)</span>  <span class="c1"># looses</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time estimate:&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">estimation</span><span class="p">))</span>

    <span class="n">debut</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
    <span class="p">[</span><span class="n">progress_pow</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">main_compute</span><span class="p">(</span>
        <span class="n">chi3</span><span class="o">=</span><span class="n">chi3</span><span class="p">,</span> <span class="n">kerr</span><span class="o">=</span><span class="n">kerr</span><span class="p">,</span> <span class="n">kerr_loop</span><span class="o">=</span><span class="n">kerr_loop</span><span class="p">,</span>
        <span class="n">variance_check</span><span class="o">=</span><span class="n">variance_check</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">lost_beg</span><span class="o">=</span><span class="n">lost_beg</span><span class="p">,</span> <span class="n">lost_end</span><span class="o">=</span><span class="n">lost_end</span><span class="p">)</span>
    <span class="n">fin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;temps : &#39;</span><span class="p">,</span> <span class="n">fin</span><span class="o">-</span><span class="n">debut</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Light propagation into guides&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (µm)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;z (mm)&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nbr_p</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">nbr_p</span><span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="n">nbr_p</span><span class="o">*</span><span class="n">p</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">zv</span><span class="p">,</span> <span class="mf">1e-13</span><span class="o">*</span><span class="n">progress_pow</span><span class="p">)</span>

    <span class="n">pow_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;close the graphs to continue&quot;</span><span class="p">)</span>
    <span class="n">_show_plot</span><span class="p">(</span><span class="n">pow_index</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finished&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;version without the user interface, note that user_interface.py&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calls the Bpm class and performs the same calculations&quot;</span><span class="p">)</span>

    <span class="n">choice</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Start ?: &quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">choice</span> <span class="o">!=</span> <span class="s2">&quot;yes&quot;</span><span class="p">:</span>
        <span class="n">example_bpm</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="beampy-interface">
<span id="code-interface"></span><h2>beampy.interface<a class="headerlink" href="#beampy-interface" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1"># Form implementation generated from reading ui file &#39;interface.ui&#39;</span>
<span class="c1">#</span>
<span class="c1"># Created by: PyQt5 UI code generator 5.13.1</span>
<span class="c1">#</span>
<span class="c1"># WARNING! All changes made in this file will be lost!</span>


<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="k">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtWidgets</span>


<span class="k">class</span> <span class="nc">Ui_MainWindow</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MainWindow</span><span class="p">):</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">1144</span><span class="p">,</span> <span class="mi">1019</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">935</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">centralwidget</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">(</span><span class="n">MainWindow</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">centralwidget</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;centralwidget&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gridLayout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QGridLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">centralwidget</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gridLayout</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;gridLayout&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_file_data</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">centralwidget</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_file_data</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">NoFrame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_file_data</span><span class="o">.</span><span class="n">setFrameShadow</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Raised</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_file_data</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;frame_file_data&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_file_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;verticalLayout&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_main</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTabWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_file_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_main</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;tabWidget_main&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_guide</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_guide</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;tabWidget_guide&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalLayout_2</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalLayout_2</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;horizontalLayout_2&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_guide</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_guide</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;verticalLayout_guide&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_window_parameters</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_window_parameters</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">62</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_window_parameters</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">16777215</span><span class="p">,</span> <span class="mi">62</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_window_parameters</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_window_parameters&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_guide</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_window_parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span> <span class="mi">16777215</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span><span class="o">.</span><span class="n">setFrameShadow</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Raised</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;frame_window&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_10</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_10</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;formLayout_10&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_length</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_length</span><span class="o">.</span><span class="n">setAccessibleDescription</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_length</span><span class="o">.</span><span class="n">setOpenExternalLinks</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_length</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_length&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_10</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">100000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="o">.</span><span class="n">setStepType</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">AdaptiveDecimalStepType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">10000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_length_z&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_10</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_dist_z</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_dist_z</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_dist_z&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_10</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_dist_z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_z</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_z</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_z</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_z</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_z</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">100000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_z</span><span class="o">.</span><span class="n">setStepType</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">AdaptiveDecimalStepType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_z</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_z</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_dist_z&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_10</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_nbr_z_disp</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_nbr_z_disp</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_nbr_z_disp&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_10</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_nbr_z_disp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nbr_z_disp</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nbr_z_disp</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nbr_z_disp</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nbr_z_disp</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nbr_z_disp</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nbr_z_disp</span><span class="o">.</span><span class="n">setDisplayIntegerBase</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nbr_z_disp</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;spinBox_nbr_z_disp&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_10</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nbr_z_disp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_length_x</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_length_x</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_length_x&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_10</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_length_x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="o">.</span><span class="n">setStepType</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">AdaptiveDecimalStepType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_length_x&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_10</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_dist_x</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_dist_x</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_dist_x&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_10</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_dist_x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_x</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_x</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_x</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_x</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_x</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">100.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_x</span><span class="o">.</span><span class="n">setStepType</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">AdaptiveDecimalStepType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_x</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_x</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_dist_x&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_10</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_guide</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_window</span><span class="p">)</span>
        <span class="n">spacerItem</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Maximum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_guide</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">spacerItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_guides_information</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_guides_information</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">62</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_guides_information</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">16777215</span><span class="p">,</span> <span class="mi">62</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_guides_information</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_guides_information&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_guide</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_guides_information</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span> <span class="mi">16777215</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="o">.</span><span class="n">setFrameShadow</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Raised</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;frame_guides&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_6</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_6</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;formLayout_6&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_width</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_width</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_width&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_6</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_width</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="o">.</span><span class="n">setStepType</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">DefaultStepType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_width&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_6</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_offset_guide</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_offset_guide</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_offset_guide&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_6</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_offset_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="o">-</span><span class="mf">5000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_offset_guide&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_6</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">1000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">2.14</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_n&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_6</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_n</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_n</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_n&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_6</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_dn</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_dn</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_dn&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_6</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_dn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dn</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dn</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dn</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dn</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mf">1e-06</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dn</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">1000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dn</span><span class="o">.</span><span class="n">setStepType</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">AdaptiveDecimalStepType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dn</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dn</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_dn&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_6</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QRadioButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;radioButton_gaussian&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_6</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;spinBox_gauss_pow&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_6</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QRadioButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;radioButton_squared&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_6</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_guide</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_guides</span><span class="p">)</span>
        <span class="n">spacerItem1</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Maximum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_guide</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">spacerItem1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTabWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span> <span class="mi">16777215</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;tabWidget_morphology_guide&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_array</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_array</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;tab_array&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_array</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;formLayout&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_nb_p</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_array</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_nb_p</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_nb_p&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_nb_p</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nb_p</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_array</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nb_p</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nb_p</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nb_p</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nb_p</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;spinBox_nb_p&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nb_p</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_p</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_array</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_p</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_p&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_p</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_p</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_array</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_p</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_p</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_p</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_p</span><span class="o">.</span><span class="n">setStepType</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">DefaultStepType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_p</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_p</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_p&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_p</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_array</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_array</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_array</span><span class="o">.</span><span class="n">setCursor</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">PointingHandCursor</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_array</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;calculateButton_array&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">SpanningRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_array</span><span class="p">)</span>
        <span class="n">spacerItem2</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Maximum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="n">spacerItem2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_array</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_curved</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_curved</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;tab_curved&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_2</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_curved</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_2</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;formLayout_2&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_curve</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_curved</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_curve</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_curve&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_2</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_curve</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_curve</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_curved</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_curve</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_curve</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_curve</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="o">-</span><span class="mf">100000000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_curve</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">100000000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_curve</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_curve</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_curve&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_2</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_curve</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_half_delay</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_curved</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_half_delay</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_half_delay&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_2</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_half_delay</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_half_delay</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_curved</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_half_delay</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_half_delay</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_half_delay</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">100000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_half_delay</span><span class="o">.</span><span class="n">setStepType</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">AdaptiveDecimalStepType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_half_delay</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_half_delay</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_half_delay&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_2</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_half_delay</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_distance_factor</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_curved</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_distance_factor</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_distance_factor&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_2</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_distance_factor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_distance_factor</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_curved</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_distance_factor</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_distance_factor</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_distance_factor</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_distance_factor</span><span class="o">.</span><span class="n">setStepType</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">AdaptiveDecimalStepType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_distance_factor</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_distance_factor</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_distance_factor&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_2</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_distance_factor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_curved</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_curved</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_curved</span><span class="o">.</span><span class="n">setCursor</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">PointingHandCursor</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_curved</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;calculateButton_curved&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_2</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">SpanningRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_curved</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_curved</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_guide</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="p">)</span>
        <span class="n">spacerItem3</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_guide</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">spacerItem3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_guide</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_guide</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">16777215</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_guide</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_guide</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_cancel_guide&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_guide</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalLayout_2</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;plot_guide&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalLayout_2</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_main</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_guide</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_light</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_light</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;tabWidget_light&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalLayout_4</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalLayout_4</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;horizontalLayout_4&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_light</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_light</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;verticalLayout_light&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_light_informations</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_light_informations</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">62</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_light_informations</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_light_informations&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_light</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_light_informations</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_light</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_light</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span> <span class="mi">16777215</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_light</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_light</span><span class="o">.</span><span class="n">setFrameShadow</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Raised</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_light</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;frame_light&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_lo_theta</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_lo_theta</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;formLayout_lo_theta&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_lo</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_lo</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_lo&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_lo_theta</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_lo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">100.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="o">.</span><span class="n">setStepType</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">AdaptiveDecimalStepType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_lo&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_lo_theta</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_theta_ext</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_theta_ext</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_theta_ext&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_lo_theta</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_theta_ext</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_theta_ext</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_theta_ext</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_theta_ext</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="o">-</span><span class="mf">90.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_theta_ext</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">90.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_theta_ext</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_theta_ext&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_lo_theta</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_theta_ext</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_light</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_light</span><span class="p">)</span>
        <span class="n">spacerItem4</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Maximum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_light</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">spacerItem4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span> <span class="mi">16777215</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="o">.</span><span class="n">setFrameShadow</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Raised</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;frame_beam&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;formLayout_5&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">16777215</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;comboBox_light&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">SpanningRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Qframe_beam_create</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Qframe_beam_create</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">NoFrame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Qframe_beam_create</span><span class="o">.</span><span class="n">setFrameShadow</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Raised</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Qframe_beam_create</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;Qframe_beam_create&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gridLayout_creat_delete_beam</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QGridLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Qframe_beam_create</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gridLayout_creat_delete_beam</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;gridLayout_creat_delete_beam&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_delete_beam</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Qframe_beam_create</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_delete_beam</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_delete_beam&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gridLayout_creat_delete_beam</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pushButton_delete_beam</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_create_beam</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Qframe_beam_create</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_create_beam</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_create_beam&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gridLayout_creat_delete_beam</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pushButton_create_beam</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_save_beam</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Qframe_beam_create</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_save_beam</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_save_beam&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gridLayout_creat_delete_beam</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pushButton_save_beam</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_light</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Qframe_beam_create</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_light</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_cancel_light&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gridLayout_creat_delete_beam</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_light</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">SpanningRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Qframe_beam_create</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_fwhm</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_fwhm</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_fwhm&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_fwhm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_fwhm</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_fwhm</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_fwhm</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_fwhm</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_fwhm</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_fwhm</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_fwhm&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_fwhm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;checkBox_offset_light&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;spinBox_offset_light_peak&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_offset_light</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_offset_light</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_offset_light&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_offset_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="o">-</span><span class="mf">10000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_offset_light&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_intensity</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_intensity</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_intensity&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_intensity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_intensity_light</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_intensity_light</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_intensity_light</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_intensity_light</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_intensity_light</span><span class="o">.</span><span class="n">setStepType</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">AdaptiveDecimalStepType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_intensity_light</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_intensity_light</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_intensity_light&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_intensity_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian_light</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QRadioButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian_light</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian_light</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian_light</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;radioButton_gaussian_light&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">SpanningRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared_light</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QRadioButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared_light</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared_light</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;radioButton_squared_light&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">SpanningRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_mode</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QRadioButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_mode</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;radioButton_mode&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_mode</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_mode</span><span class="o">.</span><span class="n">setAutoFillBackground</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_mode</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_mode</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_mode</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;spinBox_mode&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_all_modes</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QRadioButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_all_modes</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;radioButton_all_modes&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_all_modes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_airy</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QRadioButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_airy</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;radioButton_airy&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_airy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_zero_cut</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_zero_cut</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_zero_cut&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_zero_cut</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;spinBox_airy_zero&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_lobe_size</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_lobe_size</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_lobe_size&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_lobe_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_lobe_size&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span><span class="p">)</span>
        <span class="n">spacerItem5</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="n">spacerItem5</span><span class="p">)</span>
        <span class="n">spacerItem6</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="n">spacerItem6</span><span class="p">)</span>
        <span class="n">spacerItem7</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="n">spacerItem7</span><span class="p">)</span>
        <span class="n">spacerItem8</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="n">spacerItem8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_mode_number</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_mode_number</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_mode_number&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_mode_number</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_number</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLCDNumber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_number</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">16777215</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_number</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;mode_number&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode_number</span><span class="p">)</span>
        <span class="n">spacerItem9</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_5</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="n">spacerItem9</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_light</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_beam</span><span class="p">)</span>
        <span class="n">spacerItem10</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Maximum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_light</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">spacerItem10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_light</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_light</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span> <span class="mi">16777215</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_light</span><span class="o">.</span><span class="n">setCursor</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">PointingHandCursor</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_light</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;calculateButton_light&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_light</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_light</span><span class="p">)</span>
        <span class="n">spacerItem11</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_light</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">spacerItem11</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalLayout_4</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_light</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_light</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;plot_light&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalLayout_4</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_main</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_light</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_compute</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_compute</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;tabWidget_compute&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalLayout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalLayout</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;horizontalLayout&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute_plot</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute_plot</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;verticalLayout_compute_plot&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;verticalLayout_compute&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_lost_informations</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_lost_informations</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">62</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_lost_informations</span><span class="o">.</span><span class="n">setMouseTracking</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_lost_informations</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_lost_informations&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_lost_informations</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_lost</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_lost</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_lost</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_lost</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_lost</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;checkBox_lost&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_lost</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span> <span class="mi">16777215</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span><span class="o">.</span><span class="n">setFrameShadow</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Raised</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;frame_lost&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_8</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_8</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;formLayout_8&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_guide_lost</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_guide_lost</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_guide_lost&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_8</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_guide_lost</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_lost</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_lost</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_lost</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_lost</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;spinBox_guide_lost&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_8</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_lost</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_width_lost</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_width_lost</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_width_lost&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_8</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_width_lost</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width_lost</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width_lost</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width_lost</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width_lost</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width_lost</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width_lost</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_width_lost&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_8</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width_lost</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_lost</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_lost</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_lost&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_8</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_lost</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span><span class="o">.</span><span class="n">setStepType</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">AdaptiveDecimalStepType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_lost&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_8</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span><span class="p">)</span>
        <span class="n">spacerItem12</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Maximum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">spacerItem12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_kerr_informations</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_kerr_informations</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">62</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_kerr_informations</span><span class="o">.</span><span class="n">setMouseTracking</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_kerr_informations</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_kerr_informations&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_kerr_informations</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_kerr</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_kerr</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_kerr</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_kerr</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;checkBox_kerr&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_kerr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_kerr</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_kerr</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_kerr</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_kerr</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span> <span class="mi">16777215</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_kerr</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_kerr</span><span class="o">.</span><span class="n">setFrameShadow</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Raised</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_kerr</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;frame_kerr&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_9</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_kerr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_9</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;formLayout_9&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_correction_loop</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_kerr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_correction_loop</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_correction_loop&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_9</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_correction_loop</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_kerr_loop</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_kerr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_kerr_loop</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_kerr_loop</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_kerr_loop</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_kerr_loop</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_kerr_loop</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;spinBox_kerr_loop&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_9</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_kerr_loop</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_chi3</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_kerr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_chi3</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_chi3&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_9</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_chi3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_chi3</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_kerr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_chi3</span><span class="o">.</span><span class="n">setCorrectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractSpinBox</span><span class="o">.</span><span class="n">CorrectToNearestValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_chi3</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mf">100000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_chi3</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_chi3</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;doubleSpinBox_chi3&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_9</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_chi3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_variance</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_kerr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_variance</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_variance</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;checkBox_variance&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_9</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">SpanningRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_variance</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_kerr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_estimate</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_estimate</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;formLayout_estimate&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimate_time_display</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLCDNumber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimate_time_display</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimate_time_display</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimate_time_display</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">16777215</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimate_time_display</span><span class="o">.</span><span class="n">setDigitCount</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimate_time_display</span><span class="o">.</span><span class="n">setSegmentStyle</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLCDNumber</span><span class="o">.</span><span class="n">Filled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimate_time_display</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;estimate_time_display&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_estimate</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">FieldRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimate_time_display</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_estimate_time</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_estimate_time</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_estimate_time</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">16777215</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_estimate_time</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_estimate_time&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formLayout_estimate</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFormLayout</span><span class="o">.</span><span class="n">LabelRole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_estimate_time</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formLayout_estimate</span><span class="p">)</span>
        <span class="n">spacerItem13</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Maximum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">spacerItem13</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_compute</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_compute</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_compute</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span> <span class="mi">16777215</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_compute</span><span class="o">.</span><span class="n">setCursor</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">PointingHandCursor</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_compute</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;calculateButton_compute&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_check_power</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_check_power</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;checkBox_check_power&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_check_power</span><span class="p">)</span>
        <span class="n">spacerItem14</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">spacerItem14</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute_plot</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_compute</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_compute</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">16777215</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_compute</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_cancel_compute&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute_plot</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute_plot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;plot_compute&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_main</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_compute</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_main</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gridLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_file_data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">centralwidget</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_length</span><span class="o">.</span><span class="n">setBuddy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_light</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">retranslateUi</span><span class="p">(</span><span class="n">MainWindow</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_main</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">clicked</span><span class="p">[</span><span class="s1">&#39;bool&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_kerr</span><span class="o">.</span><span class="n">clicked</span><span class="p">[</span><span class="s1">&#39;bool&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_kerr</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">clicked</span><span class="p">[</span><span class="s1">&#39;bool&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_lost</span><span class="o">.</span><span class="n">clicked</span><span class="p">[</span><span class="s1">&#39;bool&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_kerr</span><span class="o">.</span><span class="n">clicked</span><span class="p">[</span><span class="s1">&#39;bool&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_variance</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">activated</span><span class="p">[</span><span class="s1">&#39;QString&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_light</span><span class="o">.</span><span class="n">click</span><span class="p">)</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QMetaObject</span><span class="o">.</span><span class="n">connectSlotsByName</span><span class="p">(</span><span class="n">MainWindow</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_main</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_z</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nbr_z_disp</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nbr_z_disp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_x</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dn</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nb_p</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nb_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_p</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_array</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_array</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_curve</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_curve</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_half_delay</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_half_delay</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_distance_factor</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_distance_factor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_curved</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_curved</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_guide</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_guide</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_theta_ext</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_theta_ext</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_create_beam</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pushButton_create_beam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_delete_beam</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pushButton_delete_beam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_save_beam</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pushButton_save_beam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_light</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_light</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_fwhm</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_fwhm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_intensity_light</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_intensity_light</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian_light</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian_light</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared_light</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared_light</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_mode</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radioButton_mode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_mode</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spinBox_mode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_mode_number</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pushButton_mode_number</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_all_modes</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radioButton_all_modes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_airy</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radioButton_airy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_light</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_light</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_lost</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_lost</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_lost</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_lost</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width_lost</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width_lost</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_kerr</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_kerr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_kerr_loop</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spinBox_kerr_loop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_chi3</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_chi3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_variance</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_variance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_estimate_time</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pushButton_estimate_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_compute</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_compute</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_check_power</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setTabOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_check_power</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_compute</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">retranslateUi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MainWindow</span><span class="p">):</span>
        <span class="n">_translate</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">translate</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Beampy&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_window_parameters</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;html&gt;&lt;head/&gt;&lt;body&gt;&lt;p&gt;&lt;span style=</span><span class="se">\&quot;</span><span class="s2"> font-size:14pt; font-weight:600;</span><span class="se">\&quot;</span><span class="s2">&gt;Window information&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_length</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Size of the computed window over z&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_length</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;z length&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Size of the computed window over z&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_dist_z</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Step over z in µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_dist_z</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;z step&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_z</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Step over z in µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_z</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_nbr_z_disp</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Number of points to display over z&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_nbr_z_disp</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;z nbr displayed&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nbr_z_disp</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Number of points to display over z&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_length_x</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Size of the compute window over x in µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_length_x</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;x length&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Size of the compute window over x in µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_dist_x</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Step over x in µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_dist_x</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;x step&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_x</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Step over x in µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_x</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_guides_information</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;html&gt;&lt;head/&gt;&lt;body&gt;&lt;p&gt;&lt;span style=</span><span class="se">\&quot;</span><span class="s2"> font-size:14pt; font-weight:600;</span><span class="se">\&quot;</span><span class="s2">&gt;Guides information&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_width</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Guide width define as the diameter in µm at 1/e&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_width</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Width&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Guide width define as the diameter in µm at 1/e&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; μm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_offset_guide</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Guide offset from the center in µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_offset_guide</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Guide offset&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Guide offset from the center in µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Refractive index of the cladding&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_n</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Refractive index of the cladding&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_n</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_dn</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Difference of refractive index between the core and the cladding&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_dn</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Δn&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dn</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Difference of refractive index between the core and the cladding&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Choose super-gaussian guides&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Gaussian&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Order of the super-Gaussian beam, 1 is gaussian, 4 is the usual super-Gaussian&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;order: &quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Choose squared guides&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Squared&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_nb_p</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Number of guides&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_nb_p</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Numbers of guides&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nb_p</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Number of guides&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_p</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Distance between two guides center in µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_p</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Interval between guides&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_p</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Distance between two guides center in µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_p</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_array</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Compute an array of guides&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_array</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Compute array of guides&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="o">.</span><span class="n">setTabText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_array</span><span class="p">),</span> <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;waveguide array&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_curve</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;curvature factor in 10^-8 1/µm^2&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_curve</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Curvature&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_curve</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;curvature factor in 10^-8 1/µm^2&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_curve</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; * 10^-8 1/µm^2&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_half_delay</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Half distance over z in µm bewteen the two external guides where they are the closest&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_half_delay</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Half delay&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_half_delay</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Half distance over z in µm bewteen the two external guides where they are the closest&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_half_delay</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_distance_factor</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Distance factor: p_min/width&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_distance_factor</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;p_min/width&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_distance_factor</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Distance factor: p_min/width&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_distance_factor</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_curved</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Compute the curved guides define as : - offset_guide + curve*(z - length_z/2 - half_delay)**2 + width*distance_factor)&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_curved</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Compute curved guides&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="o">.</span><span class="n">setTabText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_curved</span><span class="p">),</span> <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;curved waveguides&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_guide</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;cancel guide changes&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_guide</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Cancel changes&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_main</span><span class="o">.</span><span class="n">setTabText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_main</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_guide</span><span class="p">),</span> <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Guides&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_light_informations</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;html&gt;&lt;head/&gt;&lt;body&gt;&lt;p&gt;&lt;span style=</span><span class="se">\&quot;</span><span class="s2"> font-size:14pt; font-weight:600;</span><span class="se">\&quot;</span><span class="s2">&gt;Light information&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_lo</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; Wavelengh in µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_lo</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;λ&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; Wavelengh in µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_theta_ext</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Number of the last mode that can propagate in the guide&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_theta_ext</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;θ ext&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_theta_ext</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Exterior inclinaison angle in ° define from a interface between air and the cladding&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_theta_ext</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; °&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Select the beam&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_delete_beam</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Delete the current displayed beam&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_delete_beam</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;delete beam&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_create_beam</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Add a new beam with current displayed values&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_create_beam</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;create beam&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_save_beam</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Save current displayed values&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_save_beam</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;save beam&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_light</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Return to previously saved values&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_light</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;cancel changes&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_fwhm</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Full width at half maximum (for intensity not amplitude)&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_fwhm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;FWHM&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_fwhm</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Full width at half maximum (for intensity not amplitude)&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_fwhm</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; μm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Choose if offset is define by the guides positions or by the distance from center&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Offset (number)&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Offset define by the guide position&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Guide number : &quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_offset_light</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Light offset from center&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_offset_light</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Offset (µm)&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Light offset from center in µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_intensity</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Beam power&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_intensity</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Beam power&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_intensity_light</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Beam power |E|^2 in GW/cm^2&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_intensity_light</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; GW/cm^2&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian_light</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Select a gaussian beam&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian_light</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Gaussian&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared_light</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Select a squared beam&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared_light</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Squared&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_mode</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;select the n mode based on a squared guide&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_mode</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Mode&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_mode</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;The n mode based on a squared guide&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_all_modes</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Select all possible modes for a squared guide&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_all_modes</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;All modes&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_airy</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Select a Airy beam&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_airy</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Airy&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_zero_cut</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Choose to cut at the n zero of the Airy function&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_zero_cut</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Zero cut&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Choose to cut at the n zero of the Airy function&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_lobe_size</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;First lobe size&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_mode_number</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Displayed the number of the last mode that can propagate in the rectangular guide&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_mode_number</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Show max mode&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_number</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Number of the last mode that can propagate in the guide&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_light</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Compute the beams&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_light</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Compute light&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_main</span><span class="o">.</span><span class="n">setTabText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_main</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_light</span><span class="p">),</span> <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Light&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_lost_informations</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;html&gt;&lt;head/&gt;&lt;body&gt;&lt;p&gt;&lt;span style=</span><span class="se">\&quot;</span><span class="s2"> font-size:14pt; font-weight:600;</span><span class="se">\&quot;</span><span class="s2">&gt;Loss information&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_lost</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Activate looses in guides&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_lost</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;activate looses&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_guide_lost</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Guide number where looses occure&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_guide_lost</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Lost position&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_lost</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Guide number where looses occure&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_width_lost</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Interval where looses occures centered on the guide&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_width_lost</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Lost width&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width_lost</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Interval where looses occures centered on the guide&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width_lost</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; µm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_lost</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Looses over z in 1/mm define as exp(-alpha * dist_z)&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_lost</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Lost value&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Looses over z in 1/mm define as exp(-alpha * dist_z)&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; 1/mm&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_kerr_informations</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;html&gt;&lt;head/&gt;&lt;body&gt;&lt;p&gt;&lt;span style=</span><span class="se">\&quot;</span><span class="s2"> font-size:14pt; font-weight:600;</span><span class="se">\&quot;</span><span class="s2">&gt;Kerr information&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_kerr</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Activate the non-linear effect: Kerr effect&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_kerr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Kerr effect&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_correction_loop</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Correction&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_kerr_loop</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Number of corrective loop for the Kerr effect&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_kerr_loop</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; loops&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_chi3</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;The X(3) Electric susceptibility of the material&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_chi3</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Chi3&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_chi3</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;The X(3) Electric susceptibility of the material&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_chi3</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot; * 10^-20 m^2/V^2&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_variance</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Use this control to make sure the intensities converge, but increase drasticly the computation time&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_variance</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Check if intensities converge (slow)&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimate_time_display</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Displayed the estimation time needed to do the propagation&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimate_time_display</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Show the estimate computation time&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_estimate_time</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;When pressed, displayed the estimation time needed to do the propagation&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_estimate_time</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Show estimate time (s)&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_compute</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Compute beam propagation&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_compute</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Calculate&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_check_power</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Display the power in each guide as power=sum(I(x))&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_check_power</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Display power&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_compute</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Cancel changes&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_main</span><span class="o">.</span><span class="n">setTabText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_main</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_compute</span><span class="p">),</span> <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;MainWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;Compute&quot;</span><span class="p">))</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="n">MainWindow</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">()</span>
    <span class="n">ui</span> <span class="o">=</span> <span class="n">Ui_MainWindow</span><span class="p">()</span>
    <span class="n">ui</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="n">MainWindow</span><span class="p">)</span>
    <span class="n">MainWindow</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="beampy-user-interface">
<span id="code-user-interface"></span><h2>beampy.user_interface<a class="headerlink" href="#beampy-user-interface" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The user_interface module is the main file of the beampy module.</span>
<span class="sd">It contain the UserInterface class used to computed and displayed the bpm</span>
<span class="sd">results onto the interface.</span>

<span class="sd">This module was at first developed by Marcel Soubkovsky for the implementation</span>
<span class="sd">of the array of guides, of one gaussian beam and of the plotting methods.</span>
<span class="sd">Then, continued by Jonathan Peltier.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="k">import</span> <span class="p">(</span><span class="n">QApplication</span><span class="p">,</span> <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QFileDialog</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="k">import</span> <span class="p">(</span><span class="n">pyqtSlot</span><span class="p">,</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">QSize</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="k">import</span> <span class="n">QIcon</span>

<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="k">import</span> <span class="n">Figure</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qt4agg</span> <span class="k">import</span> <span class="p">(</span>
    <span class="n">FigureCanvasQTAgg</span> <span class="k">as</span> <span class="n">FigureCanvas</span><span class="p">,</span>
    <span class="n">NavigationToolbar2QT</span> <span class="k">as</span> <span class="n">NavigationToolbar</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">lines</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="k">import</span> <span class="n">Polygon</span>

<span class="c1"># interface.py generated from interface.ui made using Qt designer</span>
<span class="kn">from</span> <span class="nn">beampy.interface</span> <span class="k">import</span> <span class="n">Ui_MainWindow</span>
<span class="kn">from</span> <span class="nn">beampy.bpm</span> <span class="k">import</span> <span class="n">Bpm</span>  <span class="c1"># Bpm class with all the BPM methods</span>

<span class="c1"># ! To translate from .ui to .py -&gt; pyuic5 -x interface.ui -o interface.py</span>

<span class="c1"># Check out if doubts on the interface:</span>
<span class="c1"># http://blog.rcnelson.com/building-a-matplotlib-gui-with-qt-designer-part-1/</span>


<span class="k">class</span> <span class="nc">UserInterface</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">,</span> <span class="n">Ui_MainWindow</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class connect the :class:`.Bpm` class from the :mod:`.bpm` module</span>
<span class="sd">    with the :meth:`.setupUi` method from the :mod:`.interface` module.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">QMainWindow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># Linked to Ui_MainWindow through interface.py</span>

        <span class="c1"># Prepare variables before assigning values to them</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irrad</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">square_check</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous_beam</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">on_click_create_light</span><span class="p">()</span>  <span class="c1"># Initialized variables with buttons</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_guide</span><span class="p">(</span><span class="s1">&#39;array&#39;</span><span class="p">)</span>  <span class="c1"># Compute guide</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_light</span><span class="p">()</span>  <span class="c1"># Compute light</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="s1">&#39;guide&#39;</span><span class="p">)</span>  <span class="c1"># Display guide</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="s1">&#39;light&#39;</span><span class="p">)</span>  <span class="c1"># Display light</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">show_estimate_time</span><span class="p">()</span>

        <span class="c1"># Initialized compute graphics</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_compute_propag</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">Figure</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_compute_propag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_3</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">Figure</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_3</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_5</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">Figure</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute_plot</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_5</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">Figure</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute_plot</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_compute_end</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">Figure</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_compute_end</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_4</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">Figure</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_4</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connect_buttons</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_menu</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">connect_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Connect the interface buttons to their corresponding functions:</span>

<span class="sd">        :meth:`.on_click_array`, :meth:`.on_click_curved`,</span>
<span class="sd">        :meth:`.on_click_light`, :meth:`.on_click_compute`,</span>
<span class="sd">        :meth:`.on_click_create_light`, :meth:`.on_click_delete_light`,</span>
<span class="sd">        :meth:`.save_light`, :meth:`.get_guide`,</span>
<span class="sd">        :meth:`.get_light`, :meth:`.get_compute`,</span>
<span class="sd">        :meth:`.show_estimate_time`, :meth:`.check_modes_display`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_array</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_click_array</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_curved</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_click_curved</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_light</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_click_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_compute</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_click_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_create_beam</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_click_create_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_delete_beam</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_click_delete_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_save_beam</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_guide</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_light</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_compute</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_estimate_time</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_estimate_time</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_mode_number</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">check_modes_display</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a menu to open, save a file, or exit the app.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method connect the following methods and function to the</span>
<span class="sd">        menu buttons:</span>

<span class="sd">        :meth:`.open_file_name`, :meth:`.save_quick`, :meth:`.save_file_name`,</span>
<span class="sd">        :func:`.open_doc`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">()</span>
        <span class="n">icon</span><span class="o">.</span><span class="n">addFile</span><span class="p">(</span><span class="s1">&#39;icons/beampy-logo.png&#39;</span><span class="p">,</span> <span class="n">QSize</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>

        <span class="n">menubar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span>

        <span class="n">file</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s1">&#39;File&#39;</span><span class="p">)</span>

        <span class="n">action</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Open&#39;</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_file_name</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s1">&#39;Ctrl+O&#39;</span><span class="p">)</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">()</span>
        <span class="n">icon</span><span class="o">.</span><span class="n">addFile</span><span class="p">(</span><span class="s1">&#39;icons/document-open.png&#39;</span><span class="p">,</span> <span class="n">QSize</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>

        <span class="n">action</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Save&#39;</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_quick</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s1">&#39;Ctrl+S&#39;</span><span class="p">)</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">()</span>
        <span class="n">icon</span><span class="o">.</span><span class="n">addFile</span><span class="p">(</span><span class="s1">&#39;icons/document-save.png&#39;</span><span class="p">,</span> <span class="n">QSize</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>

        <span class="n">action</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Save as&#39;</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_file_name</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s1">&#39;Ctrl+Shift+S&#39;</span><span class="p">)</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">()</span>
        <span class="n">icon</span><span class="o">.</span><span class="n">addFile</span><span class="p">(</span><span class="s1">&#39;icons/document-save-as.png&#39;</span><span class="p">,</span> <span class="n">QSize</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>

        <span class="n">action</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Exit&#39;</span><span class="p">)</span>  <span class="c1"># Clean exit for spyder</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s1">&#39;Ctrl+Q&#39;</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">QApplication</span><span class="o">.</span><span class="n">quit</span><span class="p">)</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">()</span>
        <span class="n">icon</span><span class="o">.</span><span class="n">addFile</span><span class="p">(</span><span class="s1">&#39;icons/application-exit.png&#39;</span><span class="p">,</span> <span class="n">QSize</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>

        <span class="n">file</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s1">&#39;Help&#39;</span><span class="p">)</span>

        <span class="n">action</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Documentation&#39;</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">open_doc</span><span class="p">)</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">()</span>
        <span class="n">icon</span><span class="o">.</span><span class="n">addFile</span><span class="p">(</span><span class="s1">&#39;icons/help-about.png&#39;</span><span class="p">,</span> <span class="n">QSize</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">calculate_guide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topology</span><span class="o">=</span><span class="s1">&#39;array&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialized the :class:`.Bpm` class and creates the guides.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        topology : str</span>
<span class="sd">            &#39;array&#39; or &#39;curved&#39;.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Creats many variables, including :</span>

<span class="sd">        - peaks : Central position of each guide [guide,z].</span>
<span class="sd">        - dn : Difference of reefractive index [z,x].</span>

<span class="sd">        This method calls the following methods from :class:`.Bpm`:</span>

<span class="sd">        :meth:`.create_x_z`, :meth:`.squared_guide`, :meth:`.gauss_guide`,</span>
<span class="sd">        :meth:`.create_guides`, :meth:`.create_curved_guides`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculate guide&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topology</span> <span class="o">=</span> <span class="n">topology</span>
        <span class="n">t_guide_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">save_guide</span><span class="p">()</span>  <span class="c1"># Get all guide values</span>

        <span class="c1"># Create the Bpm class (overwrite existing one)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span> <span class="o">=</span> <span class="n">Bpm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">no</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">length_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)</span>

        <span class="c1"># windows variables</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">length_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">create_x_z</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nbr_z_disp</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">5000</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: if you want to have more points,&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;change the condition nbr_x * nbr_z_disp in calculate_guide&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Too many points:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">10000</span> <span class="o">*</span> <span class="mi">15000</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span> <span class="o">&gt;</span> <span class="mi">40000</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span> <span class="o">&gt;</span> <span class="mi">40000</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: if you want to have more points,&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;change the condition nbr_x * nbr_z in calculate_guide&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Too many points:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">)</span>

        <span class="c1"># Waveguide shape choice</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_squared_check</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">squared_guide</span><span class="p">()</span>  <span class="c1"># Squared guides</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_gauss_check</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">gauss_guide</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gauss_pow</span><span class="p">)</span>  <span class="c1"># Gaussian guides</span>

        <span class="c1"># Topology waveguides choice</span>
        <span class="k">if</span> <span class="n">topology</span> <span class="o">==</span> <span class="s1">&#39;array&#39;</span><span class="p">:</span>

            <span class="n">leng_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">&gt;</span> <span class="n">leng_max</span><span class="p">:</span>
                <span class="c1"># give info about possible good values</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nbr_p*p&gt; length_x: &quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="n">leng_max</span><span class="p">)</span>

                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p_max=&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">leng_max</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">leng_max</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="n">leng_max</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nbr_p_max=&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">leng_max</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nbr_p_max=&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">leng_max</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">))</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># choose guides position when even number</span>
<span class="c1">#            condition_even_guide = &#39;center&#39;  # default</span>
<span class="c1">#            if self.nbr_p % 2 == 0:</span>
<span class="c1">#                if condition_even_guide == &#39;left&#39;:</span>
<span class="c1">#                    self.offset_guide -= self.p / 2</span>
<span class="c1">#                elif condition_even_guide == &#39;right&#39;:</span>
<span class="c1">#                    self.offset_guide += self.p / 2</span>

            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">create_guides</span><span class="p">(</span>
                <span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">offset_guide</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">topology</span> <span class="o">==</span> <span class="s1">&#39;curved&#39;</span><span class="p">:</span>
            <span class="n">curve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">curve</span> <span class="o">*</span> <span class="mf">1E-8</span>  <span class="c1"># curvature factor</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">create_curved_guides</span><span class="p">(</span>
                <span class="n">shape</span><span class="p">,</span> <span class="n">curve</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_delay</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_factor</span><span class="p">,</span>
                <span class="n">offset_guide</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span><span class="p">)</span>

        <span class="c1"># Display guides</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z_disp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">length_z</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_disp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dn_disp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

        <span class="c1"># only display available settings</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_lost</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_lost</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_check_power</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_lost</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_lost</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_check_power</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#        Define new min/max for light and looses, based on selected guides</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width_lost</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_guide_done</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">t_guide_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Guides time: &#39;</span><span class="p">,</span> <span class="n">t_guide_end</span><span class="o">-</span><span class="n">t_guide_start</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">calculate_light</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create the choosen beams.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Creates the progress_pow variable.</span>

<span class="sd">        This method calls the following methods from the :class:`.Bpm` class:</span>

<span class="sd">        :meth:`.gauss_light`, :meth:`.squared_light`, :meth:`.all_modes`,</span>
<span class="sd">        :meth:`.mode_light`, :meth:`.airy_light`, :meth:`.init_field`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculate light&quot;</span><span class="p">)</span>
        <span class="n">t_light_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">save_light</span><span class="p">()</span>  <span class="c1"># Get all light variables</span>
        <span class="c1"># must have same wavelength and angle or must compute for each</span>
        <span class="c1"># different wavelength or angle</span>
        <span class="n">nbr_light</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>  <span class="c1"># Number of beams</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nbr_light</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_light</span><span class="p">):</span>

            <span class="c1"># Check if offset in µm or in guide number</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>

                <span class="c1"># Reduce light # if &gt; guides #</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology</span> <span class="o">==</span> <span class="s1">&#39;array&#39;</span>
                        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology</span> <span class="o">==</span> <span class="s1">&#39;curved&#39;</span>
                        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span>

                <span class="n">offset_light</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">offset_light</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="c1">#  Compute lights</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">field_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">gauss_light</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">offset_light</span><span class="o">=</span><span class="n">offset_light</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">square_check</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">field_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">squared_light</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">offset_light</span><span class="o">=</span><span class="n">offset_light</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">field_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">all_modes</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lo</span><span class="p">,</span> <span class="n">offset_light</span><span class="o">=</span><span class="n">offset_light</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">field_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">mode_light</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lo</span><span class="p">,</span> <span class="n">offset_light</span><span class="o">=</span><span class="n">offset_light</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

                <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># Say that no mode exist</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
                    <span class="k">continue</span>  <span class="c1"># Go to the next field</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="p">[</span><span class="n">field_i</span><span class="p">,</span> <span class="n">last_zero_pos</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">airy_light</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">offset_light</span><span class="o">=</span><span class="n">offset_light</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">last_zero_pos</span><span class="p">)</span>  <span class="c1"># Corrected val</span>

            <span class="n">field</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_i</span>

        <span class="n">irrad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">irrad</span>  <span class="c1"># Irradiance or power (GW/cm^2)</span>
        <span class="n">irrad</span> <span class="o">=</span> <span class="n">irrad</span> <span class="o">*</span> <span class="mf">1E13</span>  <span class="c1"># (W/m^2)</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">init_field</span><span class="p">(</span>
            <span class="n">field</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta_ext</span><span class="p">,</span> <span class="n">irrad</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lo</span><span class="p">)</span>

        <span class="n">t_light_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;light time: &#39;</span><span class="p">,</span> <span class="n">t_light_end</span><span class="o">-</span><span class="n">t_light_start</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">calculate_propagation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the propagation based on the input light and guides shapes.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Creates the progress_pow variable.</span>

<span class="sd">        Calls the following methods from :class:`.Bpm`:</span>
<span class="sd">        :meth:`.losses_position`, meth`.main_compute`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculate propagation&quot;</span><span class="p">)</span>
        <span class="n">t_compute_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_guide_done</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">save_compute</span><span class="p">()</span>

        <span class="n">kerr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span>  <span class="c1"># Active Kerr effect</span>
        <span class="n">kerr_loop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kerr_loop</span>
        <span class="n">chi3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span> <span class="o">*</span> <span class="mf">1E-20</span>  <span class="c1"># m^2/V^2</span>
        <span class="n">variance_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variance_check</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lost_check</span><span class="p">:</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="o">/</span><span class="mi">1000</span>
            <span class="p">[</span><span class="n">lost_beg</span><span class="p">,</span> <span class="n">lost_end</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">losses_position</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">guide_lost</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_lost</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">lost_beg</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">lost_end</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">estimation</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
            <span class="mf">8.8</span> <span class="o">/</span> <span class="mf">5e7</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span>  <span class="c1"># without kerr</span>
            <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.72</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_loop</span><span class="p">))</span>  <span class="c1"># with kerr</span>
            <span class="o">+</span> <span class="mf">3.8</span><span class="o">/</span><span class="mf">5e6</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">variance_check</span>  <span class="c1"># control</span>
            <span class="o">+</span> <span class="mi">9</span><span class="o">/</span><span class="mf">1e7</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">width_lost</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">lost_check</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">)</span>  <span class="c1"># looses</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time estimate:&quot;</span><span class="p">,</span> <span class="n">estimation</span><span class="p">)</span>

        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">main_compute</span><span class="p">(</span>
            <span class="n">chi3</span><span class="o">=</span><span class="n">chi3</span><span class="p">,</span> <span class="n">kerr</span><span class="o">=</span><span class="n">kerr</span><span class="p">,</span> <span class="n">kerr_loop</span><span class="o">=</span><span class="n">kerr_loop</span><span class="p">,</span>
            <span class="n">variance_check</span><span class="o">=</span><span class="n">variance_check</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">lost_beg</span><span class="o">=</span><span class="n">lost_beg</span><span class="p">,</span> <span class="n">lost_end</span><span class="o">=</span><span class="n">lost_end</span><span class="p">)</span>

        <span class="n">t_compute_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Compute time: &#39;</span><span class="p">,</span> <span class="n">t_compute_end</span><span class="o">-</span><span class="n">t_compute_start</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">show_estimate_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Display - on the interface - the estimate time needed to compute the</span>
<span class="sd">        propagation, based on linearized experimental values.</span>
<span class="sd">        The estimation takes into account the looses, Kerr, and control</span>
<span class="sd">        parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_compute</span><span class="p">()</span>
        <span class="n">estimation</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
            <span class="mf">8.8</span> <span class="o">/</span> <span class="mf">5e7</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span>  <span class="c1"># without kerr</span>
            <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.72</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_loop</span><span class="p">))</span>  <span class="c1"># with kerr</span>
            <span class="o">+</span> <span class="mf">3.8</span><span class="o">/</span><span class="mf">5e6</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">variance_check</span>  <span class="c1"># control</span>
            <span class="o">+</span> <span class="mi">9</span><span class="o">/</span><span class="mf">1e7</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">width_lost</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">lost_check</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">)</span>  <span class="c1"># looses</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">estimate_time_display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">estimation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_modes_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Display on the interface the last mode that can propagated into a</span>
<span class="sd">        squared guide.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">mode_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">check_modes</span><span class="p">(</span><span class="n">lo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_number</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">mode_max</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">addmpl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tab</span><span class="o">=</span><span class="s1">&#39;guide&#39;</span><span class="p">,</span> <span class="n">pow_index</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add the selected plots on the guide, light or compute window.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tab : str, optional</span>
<span class="sd">            &#39;guide&#39; or &#39;light&#39;.</span>
<span class="sd">            &#39;guide&#39; by default.</span>
<span class="sd">        pow_index : int, optional</span>
<span class="sd">            Add the first guide and light step if 0 or the last step if -1.</span>
<span class="sd">            Also display the propagation into (x,z) and guide power if -1 is</span>
<span class="sd">            choosen.</span>
<span class="sd">            0 by default.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pow_index_guide</span> <span class="o">=</span> <span class="n">pow_index</span>

        <span class="k">if</span> <span class="n">pow_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pow_index_guide</span> <span class="o">-=</span> <span class="mi">1</span>  <span class="c1"># Display the -2 guide for the -1 beam</span>

        <span class="k">if</span> <span class="n">tab</span> <span class="o">==</span> <span class="s1">&#39;guide&#39;</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">set_tight_layout</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Prevent axes to be cut when resizing</span>
            <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Guide shape through propagation&quot;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (µm)&#39;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;z (mm)&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">topology</span> <span class="o">!=</span> <span class="s1">&#39;curved&#39;</span><span class="p">:</span>
                <span class="n">x_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span>
                <span class="k">if</span> <span class="n">x_min</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">x_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="n">x_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span>
                <span class="k">if</span> <span class="n">x_max</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">x_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>

            <span class="c1"># note that a colormesh pixel is based on 4 points</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xv</span><span class="p">,</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">zv</span><span class="p">,</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dn_disp</span><span class="p">],</span>
                           <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_prop</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_prop</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_guide_prop</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_prop</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_prop</span><span class="p">,</span>
                                                        <span class="n">coordinates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_guide_prop</span><span class="p">)</span>

            <span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">set_tight_layout</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Input index profil&quot;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (µm)&#39;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Delta_n$&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">verts</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
                         <span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="n">pow_index_guide</span><span class="p">,</span> <span class="p">:]),</span>
                         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">)]</span>
                <span class="n">poly</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">verts</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;0.9&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">)</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">topology</span> <span class="o">!=</span> <span class="s1">&#39;curved&#39;</span><span class="p">:</span>
                    <span class="n">x_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span>
                    <span class="k">if</span> <span class="n">x_min</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">x_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="n">x_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span>
                    <span class="k">if</span> <span class="n">x_max</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">x_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>

            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
                         <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span><span class="o">*</span><span class="mf">1.1</span> <span class="o">+</span> <span class="mf">1E-20</span><span class="p">)</span>

            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="n">pow_index_guide</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_in</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_in</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_guide_in</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_in</span><span class="p">,</span>
                                                      <span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_in</span><span class="p">,</span>
                                                      <span class="n">coordinates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_guide_in</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">tab</span> <span class="o">==</span> <span class="s1">&#39;light&#39;</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">set_tight_layout</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Light injection into a guide&quot;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (µm)&#39;</span><span class="p">)</span>
            <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">tl</span> <span class="ow">in</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
                <span class="n">tl</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">tl</span> <span class="ow">in</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
                <span class="n">tl</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;#1f77b4&#39;</span><span class="p">)</span>

            <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Delta_n$&#39;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Irradiance ($GW.cm^{-2}$)&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">verts</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
                         <span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="n">pow_index_guide</span><span class="p">,</span> <span class="p">:]),</span>
                         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">)]</span>
                <span class="n">poly</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">verts</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;0.9&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">topology</span> <span class="o">!=</span> <span class="s1">&#39;curved&#39;</span><span class="p">:</span>
                    <span class="n">x_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span>
                    <span class="k">if</span> <span class="n">x_min</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">x_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="n">x_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span>
                    <span class="k">if</span> <span class="n">x_max</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">x_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>

            <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
                         <span class="nb">max</span><span class="p">(</span><span class="mf">1.1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="n">pow_index_guide</span><span class="p">,</span> <span class="p">:])</span> <span class="o">+</span> <span class="mf">1E-20</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1e-13</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="n">pow_index_guide</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mf">1e-13</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">[</span><span class="n">pow_index</span><span class="p">],</span> <span class="s1">&#39;#1f77b4&#39;</span><span class="p">)</span>

            <span class="c1"># Display light at the beginning of guides</span>
            <span class="k">if</span> <span class="n">pow_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas_light</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_light</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_light</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_2</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_light</span><span class="p">,</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">canvas_light</span><span class="p">,</span>
                                                   <span class="n">coordinates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_light</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_2</span><span class="p">)</span>

            <span class="c1"># Display light at the end of guides</span>
            <span class="k">if</span> <span class="n">pow_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Light at the end of guides&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas_compute_end</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_compute_end</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_4</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_compute_end</span><span class="p">,</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">canvas_compute_end</span><span class="p">,</span>
                                                   <span class="n">coordinates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_4</span><span class="p">)</span>

                <span class="c1"># Display light propagation into guides</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">()</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">set_tight_layout</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Light propagation into guides&quot;</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (µm)&#39;</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;z (mm)&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">!=</span> <span class="mi">0</span>
                        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">topology</span> <span class="o">!=</span> <span class="s1">&#39;curved&#39;</span><span class="p">):</span>

                    <span class="n">x_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span>
                    <span class="k">if</span> <span class="n">x_min</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">x_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="n">x_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span>
                    <span class="k">if</span> <span class="n">x_max</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">x_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>

                <span class="n">ax1</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xv</span><span class="p">,</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">zv</span><span class="p">,</span>
                               <span class="mf">1e-13</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas_compute_propag</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_compute_propag</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_3</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_compute_propag</span><span class="p">,</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">canvas_compute_propag</span><span class="p">,</span>
                                                   <span class="n">coordinates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_3</span><span class="p">)</span>

                <span class="c1"># Display guides power</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_check_power</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="ow">and</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">t_power_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
                    <span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">()</span>
<span class="c1">#                    fig.set_tight_layout(True)</span>
                    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Radiant flux in guides&quot;</span><span class="p">)</span>
                    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;z (mm)&#39;</span><span class="p">)</span>
                    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Radiant flux (u.a)&#39;</span><span class="p">)</span>

                    <span class="n">x_beg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
                    <span class="n">x_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
                    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                    <span class="n">style</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">lines</span><span class="o">.</span><span class="n">lineStyles</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
                    <span class="n">style</span> <span class="o">=</span> <span class="n">style</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">lines</span><span class="o">.</span><span class="n">lineMarkers</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">16</span><span class="p">]</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">topology</span> <span class="o">==</span> <span class="s1">&#39;array&#39;</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">):</span>
                            <span class="p">[</span><span class="n">x_beg</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">:],</span>
                             <span class="n">x_end</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">:]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">guide_position</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>

                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">topology</span> <span class="o">==</span> <span class="s1">&#39;curved&#39;</span><span class="p">:</span>
                        <span class="c1"># Choose precision at the end for right guide if can</span>
                        <span class="c1"># and choose safety when guides overlapse</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                            <span class="c1"># When further of each other (good for right end)</span>
                            <span class="n">p0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># When closest to each other (good when close)</span>
                            <span class="n">p0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_factor</span>

                        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                            <span class="p">[</span><span class="n">x_beg</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">:],</span>
                             <span class="n">x_end</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">:]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">guide_position</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p0</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">power_guide</span><span class="p">(</span><span class="n">x_beg</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">:],</span>
                                                       <span class="n">x_end</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">:])</span>
                        <span class="c1"># plot each power with a different style (nbr_p &lt; 29)</span>
                        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">29</span><span class="p">:</span>
                            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z_disp</span><span class="p">,</span> <span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">:],</span>
                                     <span class="n">style</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># to have no error but same style</span>
                            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z_disp</span><span class="p">,</span> <span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">:],</span>
                                     <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">canvas_5</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute_plot</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_5</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_5</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_5</span><span class="p">,</span>
                                                       <span class="bp">self</span><span class="o">.</span><span class="n">canvas_5</span><span class="p">,</span>
                                                       <span class="n">coordinates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute_plot</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_5</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>  <span class="c1"># Fast if many plot</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>  <span class="c1"># Best if not too many plot</span>
                    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
                    <span class="n">t_power_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Power time: &#39;</span><span class="p">,</span> <span class="n">t_power_end</span><span class="o">-</span><span class="n">t_power_start</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">rmmpl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tab</span><span class="p">,</span> <span class="n">pow_index</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove the selected plots</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tab : str</span>
<span class="sd">            &#39;guide&#39; or &#39;light&#39;.</span>
<span class="sd">        pow_index : int, optional</span>
<span class="sd">            Remove the first light step if 0 or the last step if -1.</span>
<span class="sd">            0 by default.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tab</span> <span class="o">==</span> <span class="s1">&#39;guide&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_prop</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_in</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_prop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_in</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_guide_prop</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_guide_in</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_guide_prop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_guide_in</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">tab</span> <span class="o">==</span> <span class="s1">&#39;light&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pow_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_light</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_light</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas_light</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_light</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_2</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">pow_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_compute_propag</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas_compute_propag</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_3</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_3</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute_plot</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_5</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas_5</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute_plot</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_5</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_5</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_compute_end</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas_compute_end</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_4</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_4</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">save_guide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the interface variables into the guides variables.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_z</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nbr_z_disp</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_x</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dn</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">shape_gauss_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gauss_pow</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape_squared_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nb_p</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_p</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">curve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_curve</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">half_delay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_half_delay</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distance_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_distance_factor</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
<span class="c1">#        print(&quot;Guide variables saved&quot;)</span>

    <span class="k">def</span> <span class="nf">get_guide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the saved values of the guide variables on the interface.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_z</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nbr_z_disp</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_x</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dn</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape_gauss_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gauss_pow</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape_squared_check</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nb_p</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_p</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_curve</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">curve</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_half_delay</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">half_delay</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_distance_factor</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distance_factor</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">save_light</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">beam_selec</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the interface variables into the lights variables.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        beam_selec: int, bool, optional</span>
<span class="sd">            Number of the beam to save into the variables.</span>
<span class="sd">            False by default to get the currently displayed beam.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta_ext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_theta_ext</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

        <span class="c1"># if more than one beams and if no beams selected manualy</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">beam_selec</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;False&#39;</span><span class="p">:</span>
            <span class="n">beam_selec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">())</span>  <span class="c1"># Choice</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_fwhm</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irrad</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_intensity_light</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_mode</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian_light</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">square_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared_light</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_mode</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_all_modes</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_airy</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_light</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the saved values of the light variables on the interface.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">beam_selec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">())</span>  <span class="c1"># choice</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous_beam</span> <span class="o">!=</span> <span class="n">beam_selec</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_light</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">previous_beam</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_theta_ext</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta_ext</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># if more than one beams</span>
            <span class="n">beam_selec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">())</span>  <span class="c1"># choice</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Not supposed to happen</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t have no beam variables&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_fwhm</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_intensity_light</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">irrad</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_mode</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian_light</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared_light</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">square_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_mode</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_all_modes</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="c1"># if checkBox_offset_light checked then activate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_airy</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">previous_beam</span> <span class="o">=</span> <span class="n">beam_selec</span>  <span class="c1"># Save the number of the current beam</span>

    <span class="k">def</span> <span class="nf">save_compute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the interface variables into the compute variables.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lost_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_lost</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">guide_lost</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_lost</span><span class="o">.</span><span class="n">value</span><span class="p">()],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width_lost</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width_lost</span><span class="o">.</span><span class="n">value</span><span class="p">()])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_kerr</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kerr_loop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_kerr_loop</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_chi3</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variance_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_variance</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">power_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_check_power</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
<span class="c1">#        print(&quot;Compute variables saved&quot;)</span>

    <span class="k">def</span> <span class="nf">get_compute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the saved values of the compute variables on the interface.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_lost</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lost_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_lost</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lost_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_lost</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">guide_lost</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width_lost</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width_lost</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_kerr</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_kerr_loop</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_loop</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_chi3</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_kerr</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_variance</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_variance</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variance_check</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_variance</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_check_power</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power_check</span><span class="p">)</span>

    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">on_click_array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute and displayed a guide array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="c1">#        print(&#39;button click guide array&#39;)</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WaitCursor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmmpl</span><span class="p">(</span><span class="s1">&#39;guide&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmmpl</span><span class="p">(</span><span class="s1">&#39;light&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_guide</span><span class="p">(</span><span class="s1">&#39;array&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_light</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="s1">&#39;guide&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="s1">&#39;light&#39;</span><span class="p">)</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_estimate_time</span><span class="p">()</span>

    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">on_click_curved</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute and displayed curved guides.</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="c1">#        print(&#39;button click guide curved&#39;)</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WaitCursor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmmpl</span><span class="p">(</span><span class="s1">&#39;guide&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmmpl</span><span class="p">(</span><span class="s1">&#39;light&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_guide</span><span class="p">(</span><span class="s1">&#39;curved&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_light</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="s1">&#39;guide&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="s1">&#39;light&#39;</span><span class="p">)</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_estimate_time</span><span class="p">()</span>

    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">on_click_light</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the light and display it with guides.</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="c1">#        print(&#39;button click light&#39;)</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WaitCursor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmmpl</span><span class="p">(</span><span class="n">tab</span><span class="o">=</span><span class="s1">&#39;light&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_light</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="n">tab</span><span class="o">=</span><span class="s1">&#39;light&#39;</span><span class="p">)</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_estimate_time</span><span class="p">()</span>

    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">on_click_compute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the propagation using the guide and light informations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="c1">#        print(&#39;button click compute&#39;)</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WaitCursor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_estimate_time</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">rmmpl</span><span class="p">(</span><span class="n">tab</span><span class="o">=</span><span class="s1">&#39;light&#39;</span><span class="p">,</span> <span class="n">pow_index</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_guide_done</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rmmpl</span><span class="p">(</span><span class="s1">&#39;guide&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">calculate_guide</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="s1">&#39;guide&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rmmpl</span><span class="p">(</span><span class="n">tab</span><span class="o">=</span><span class="s1">&#39;light&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">calculate_light</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="n">tab</span><span class="o">=</span><span class="s1">&#39;light&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">calculate_propagation</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="n">tab</span><span class="o">=</span><span class="s1">&#39;light&#39;</span><span class="p">,</span> <span class="n">pow_index</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no light to compute&quot;</span><span class="p">)</span>

        <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>

    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">on_click_create_light</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new beam with the displayed variables.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fwhm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_fwhm</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">offset_light</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">irrad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_intensity_light</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">offset_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">gaussian_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian_light</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">square_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared_light</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">mode_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_mode</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">all_modes_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_all_modes</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_mode</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">offset_light_peak</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">airy_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_airy</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">airy_zero</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">lobe_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span><span class="p">,</span> <span class="n">offset_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irrad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">irrad</span><span class="p">,</span> <span class="n">irrad</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span><span class="p">,</span> <span class="n">offset_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">,</span>
                                           <span class="n">offset_light_peak</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span><span class="p">,</span> <span class="n">gaussian_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">square_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">square_check</span><span class="p">,</span> <span class="n">square_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span><span class="p">,</span> <span class="n">mode_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span><span class="p">,</span> <span class="n">all_modes_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span><span class="p">,</span> <span class="n">airy_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span><span class="p">,</span> <span class="n">airy_zero</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span><span class="p">,</span> <span class="n">lobe_size</span><span class="p">)</span>

        <span class="n">nbr_light</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>  <span class="c1"># how many item left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Beam &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nbr_light</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># add new index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">nbr_light</span><span class="p">)</span>  <span class="c1"># show new index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous_beam</span> <span class="o">=</span> <span class="n">nbr_light</span>  <span class="c1"># Change the current selected beam</span>

    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">on_click_delete_light</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete the current displayed beam and displayed the next one.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nbr_light</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">nbr_light</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Can&#39;t delete if remains only 1 beam</span>
            <span class="n">beam_selec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">())</span>  <span class="c1"># choice</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">irrad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">irrad</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">,</span>
                                               <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">square_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">square_check</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span><span class="p">,</span>
                                             <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>

            <span class="n">nbr_light</span> <span class="o">-=</span> <span class="mi">1</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># remove all beams number</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_light</span><span class="p">):</span>  <span class="c1"># create again with new number</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Beam &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

            <span class="c1"># set same beam index if not the last else reduce the index by 1</span>
            <span class="k">if</span> <span class="n">beam_selec</span> <span class="o">==</span> <span class="n">nbr_light</span> <span class="ow">and</span> <span class="n">beam_selec</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">beam_selec</span> <span class="o">-=</span> <span class="mi">1</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">previous_beam</span> <span class="o">=</span> <span class="n">beam_selec</span>  <span class="c1"># Change the current selected beam</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_light</span><span class="p">()</span>  <span class="c1"># Display values of the previous or next beam</span>

    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">open_file_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open a dialog window to select the file to open, and call</span>
<span class="sd">        :meth:`open_file` to open the file.</span>

<span class="sd">        Source: https://pythonspot.com/pyqt5-file-dialog/</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method has a try/except implemented to check if the openned file</span>
<span class="sd">        contains all the variables.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
        <span class="n">options</span> <span class="o">|=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">DontUseNativeDialog</span>
        <span class="n">filename</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                                  <span class="s2">&quot;Import data&quot;</span><span class="p">,</span>
                                                  <span class="s2">&quot;&quot;</span><span class="p">,</span>
                                                  <span class="s2">&quot;Text Files (*.txt)&quot;</span><span class="p">,</span>
                                                  <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>  <span class="c1"># Next save will overwrite this file</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Beampy - &quot;</span><span class="o">+</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;missing variable&quot;</span><span class="p">,</span> <span class="n">ex</span><span class="p">,</span> <span class="s2">&quot;in the file.&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Add it manually to remove this error.&quot;</span><span class="p">)</span>
<span class="c1">#            except Exception as ex:  # This execption was removed to see the</span>
                <span class="c1"># # error location. The program won&#39;t crash thanks to try</span>
<span class="c1">#                print(&quot;Unknown error when openning the file:&quot;, filename)</span>
<span class="c1">#                print(&quot;Error:&quot;, ex)</span>

    <span class="k">def</span> <span class="nf">open_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set guides, beams and computes variables from a choosen file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str</span>
<span class="sd">            Name of the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="c1">#        https://www.tutorialspoint.com/</span>
<span class="c1">#        How-to-create-a-Python-dictionary-from-text-file</span>
        <span class="n">dico</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="o">*</span><span class="n">val</span><span class="p">)</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>  <span class="c1"># Assume: variable_name values</span>
<span class="c1">#            print(variables, val)</span>
            <span class="n">dico</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">variables</span><span class="p">)]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># Save the displayed values (only useful if the displayed variable is</span>
<span class="c1">#       not in the openned file)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_guide</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_light</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_compute</span><span class="p">()</span>

        <span class="c1"># Guide variables</span>
<span class="c1">#        if dico.get(&#39;length_z&#39;) is not None: # if want to continue without the</span>
<span class="c1">#        variable and choose the displayed values instead</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length_z</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;length_z&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;dist_z&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;nbr_z_disp&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;length_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;dist_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;offset_guide&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;no&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;delta_no&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">shape_gauss_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;shape_gauss_check&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gauss_pow</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;gauss_pow&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape_squared_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;shape_squared_check&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;nbr_p&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">curve</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;curve&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">half_delay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;half_delay&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distance_factor</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;distance_factor&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;tab_index&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># Light variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lo</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;lo&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta_ext</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;theta_ext&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;fwhm&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;offset_light&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irrad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;irrad&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;offset_check&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;gaussian_check&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">square_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;square_check&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;mode_check&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;all_modes_check&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="n">dico</span><span class="p">[</span><span class="s1">&#39;offset_light_peak&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;airy_check&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;airy_zero&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;lobe_size&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="c1"># Compute variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lost_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;lost_check&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">guide_lost</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;guide_lost&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width_lost</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;width_lost&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;kerr_check&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kerr_loop</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;kerr_loop&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;chi3&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variance_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;variance_check&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">power_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;power_check&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">nbr_light</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># Remove all beams number</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_light</span><span class="p">):</span>  <span class="c1"># Create again with new number</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Beam &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">previous_beam</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Change the current selected beam</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Array of guides</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_lost</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Curved guides</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_lost</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">get_guide</span><span class="p">()</span>  <span class="c1"># Set guides boxes value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_light</span><span class="p">()</span>  <span class="c1"># Set lights boxes value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_compute</span><span class="p">()</span>  <span class="c1"># Set compute boxes value</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># If openned file uses array</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_click_array</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># If openned file uses curved guides</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_click_curved</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;file openned&quot;</span><span class="p">)</span>

    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">save_quick</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if a file is already selected and if so, save into it.</span>
<span class="sd">        Else, call the :meth:`save_file_name` to ask a filename.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_file_name</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">save_file_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open a dialog window to select the saved file name and call</span>
<span class="sd">        :meth:`save_file` to save the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
        <span class="n">options</span> <span class="o">|=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">DontUseNativeDialog</span>
        <span class="n">filename</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                                  <span class="s2">&quot;Save data&quot;</span><span class="p">,</span>
                                                  <span class="s2">&quot;&quot;</span><span class="p">,</span>
                                                  <span class="s2">&quot;Text Files (*.txt)&quot;</span><span class="p">,</span>
                                                  <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">!=</span> <span class="s1">&#39;.txt&#39;</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.txt&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Beampy - &quot;</span><span class="o">+</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">save_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save guides, beams and computes variables into a choosen file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str</span>
<span class="sd">            Name of the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_guide</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_light</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_compute</span><span class="p">()</span>

        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>

        <span class="c1"># Guide variables</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;length_z &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_z</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;dist_z &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;nbr_z_disp &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;length_x &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;dist_x &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;width &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;offset_guide &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;no &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;delta_no &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;shape_gauss_check &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape_gauss_check</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;gauss_pow &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gauss_pow</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;shape_squared_check &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape_squared_check</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;nbr_p &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;p &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;curve &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">curve</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;half_delay &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">half_delay</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;distance_factor &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distance_factor</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;tab_index &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># light variables</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;lo &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lo</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;theta_ext &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta_ext</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;fwhm &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;offset_light &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;irrad &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">irrad</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;offset_check &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;gaussian_check &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;square_check &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">square_check</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;mode_check &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;all_modes_check &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;mode &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;offset_light_peak &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;airy_check &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;airy_zero &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;lobe_size &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># compute variables</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;lost_check &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lost_check</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;guide_lost &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">guide_lost</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;width_lost &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width_lost</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;alpha &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;kerr_check &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;kerr_loop &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_loop</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;chi3 &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;variance_check &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variance_check</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;power_check &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power_check</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;file saved&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">open_doc</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function that open the local html documentation - describing the beampy</span>
<span class="sd">    modules - if exist, or the online version otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file</span> <span class="o">=</span> <span class="vm">__file__</span>  <span class="c1"># Module name</span>
    <span class="c1"># Replaces characters only when called from outer files</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">file</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># Remove the folder and file name</span>

    <span class="n">file2</span> <span class="o">=</span> <span class="nb">str</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file2</span> <span class="o">=</span> <span class="n">file2</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">line</span>

    <span class="n">file</span> <span class="o">=</span> <span class="n">file2</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">+</span><span class="s2">&quot;/docs/html/index.html&quot;</span>
    <span class="n">exists</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">exists</span><span class="p">:</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Open file in a new tab (new=2)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The documentation can&#39;t be found localy in:&quot;</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
        <span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;https://beampy.readthedocs.io&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Openning the online version at:&quot;</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Open file in a new tab (new=2)</span>


<span class="k">def</span> <span class="nf">open_app</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function used to open the app.</span>
<span class="sd">    Can be called directly from beampy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>  <span class="c1"># Define the app</span>
    <span class="n">myapp</span> <span class="o">=</span> <span class="n">UserInterface</span><span class="p">()</span>  <span class="c1"># Run the app</span>
    <span class="n">myapp</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Show the form</span>
    <span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>  <span class="c1"># Execute the app in a loop</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">open_app</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="beampy-examples">
<span id="code-examples"></span><h2>beampy.examples<a class="headerlink" href="#beampy-examples" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">beampy.bpm</span> <span class="k">import</span> <span class="n">Bpm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy.fft</span> <span class="k">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">ifft</span><span class="p">,</span> <span class="n">fftshift</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">ceil</span><span class="p">,</span> <span class="n">radians</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">acos</span><span class="p">,</span> <span class="n">asin</span><span class="p">,</span> <span class="n">exp</span>


<span class="k">def</span> <span class="nf">example_gaussian_beam</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; Display a Gaussian beam with the fwhm definition.&quot;&quot;&quot;</span>
    <span class="n">fwhm</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">bpm</span> <span class="o">=</span> <span class="n">Bpm</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">bpm</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mf">9.1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">x</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s2">&quot;Beam&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Example for the gaussian beam&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bpm</span><span class="o">.</span><span class="n">gauss_light</span><span class="p">(</span><span class="n">fwhm</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;field&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">gauss_light</span><span class="p">(</span><span class="n">fwhm</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;intensity&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1/2&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">fwhm</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;fwhm/2&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1/e&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)]</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1/$e^2$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">fwhm</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))]</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">),</span>
             <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$w_0$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">example_guides_x</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Display a Gaussian guide, two super-Gaussian guides and a flat-top guide</span>
<span class="sd">    to illustrate the width definition.&quot;&quot;&quot;</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">bpm</span> <span class="o">=</span> <span class="n">Bpm</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">bpm</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mf">9.1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">x</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s2">&quot;guide_x&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Example of different guides&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bpm</span><span class="o">.</span><span class="n">gauss_guide</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gaussian&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bpm</span><span class="o">.</span><span class="n">gauss_guide</span><span class="p">(</span><span class="mi">4</span><span class="p">)(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;super-Gaussian P=4&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bpm</span><span class="o">.</span><span class="n">gauss_guide</span><span class="p">(</span><span class="mi">10</span><span class="p">)(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;super-Gaussian P=10&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bpm</span><span class="o">.</span><span class="n">squared_guide</span><span class="p">()(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Flat-top&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span>
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;width/2&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1/e&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">example_guides_z</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Display an array of guides and the curved guides system.&quot;&quot;&quot;</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">bpm</span> <span class="o">=</span> <span class="n">Bpm</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">length_z</span><span class="p">,</span> <span class="n">nbr_z</span><span class="p">,</span> <span class="n">nbr_z_disp</span><span class="p">,</span> <span class="n">length_x</span><span class="p">,</span> <span class="n">nbr_x</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">create_x_z</span><span class="p">()</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">gauss_guide</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="p">[</span><span class="n">peaks</span><span class="p">,</span> <span class="n">dn</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">create_guides</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">z_disp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length_z</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">nbr_z_disp</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">xv</span><span class="p">,</span> <span class="n">zv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z_disp</span><span class="p">)</span>
    <span class="n">dn_disp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nbr_z</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nbr_z_disp</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s2">&quot;guide_z_array&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Example for the array of guides&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">zv</span><span class="p">,</span> <span class="n">dn</span><span class="p">[</span><span class="n">dn_disp</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="p">[</span><span class="n">peaks</span><span class="p">,</span> <span class="n">dn</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">create_curved_guides</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="mi">40</span><span class="o">*</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s2">&quot;guide_z_curved&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Example for the curved guides&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">zv</span><span class="p">,</span> <span class="n">dn</span><span class="p">[</span><span class="n">dn_disp</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">example_free_propag</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Show the free propagation of a beam (no refractive index variation)</span>
<span class="sd">    and confirm that Beampy return the correct waist value&quot;&quot;&quot;</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">no</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">delta_no</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">length_z</span> <span class="o">=</span> <span class="mi">10000</span>
    <span class="n">dist_z</span> <span class="o">=</span> <span class="mi">10000</span>
    <span class="n">nbr_z_disp</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">dist_x</span> <span class="o">=</span> <span class="mf">0.01</span>
    <span class="n">length_x</span> <span class="o">=</span> <span class="mi">1000</span>

    <span class="n">bpm</span> <span class="o">=</span> <span class="n">Bpm</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">no</span><span class="p">,</span> <span class="n">delta_no</span><span class="p">,</span>
              <span class="n">length_z</span><span class="p">,</span> <span class="n">dist_z</span><span class="p">,</span> <span class="n">nbr_z_disp</span><span class="p">,</span>
              <span class="n">length_x</span><span class="p">,</span> <span class="n">dist_x</span><span class="p">)</span>

    <span class="p">[</span><span class="n">length_z</span><span class="p">,</span> <span class="n">nbr_z</span><span class="p">,</span> <span class="n">nbr_z_disp</span><span class="p">,</span> <span class="n">length_x</span><span class="p">,</span> <span class="n">nbr_x</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">create_x_z</span><span class="p">()</span>

    <span class="n">shape</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">squared_guide</span><span class="p">()</span>

    <span class="n">nbr_p</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="p">[</span><span class="n">peaks</span><span class="p">,</span> <span class="n">dn</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">create_guides</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">nbr_p</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="n">fwhm</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">lo</span> <span class="o">=</span> <span class="mf">1.5</span>

    <span class="n">field</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">gauss_light</span><span class="p">(</span><span class="n">fwhm</span><span class="p">)</span>
    <span class="n">irrad</span> <span class="o">=</span> <span class="mf">1E13</span>
    <span class="n">theta_ext</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="p">[</span><span class="n">progress_pow</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">init_field</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">theta_ext</span><span class="p">,</span> <span class="n">irrad</span><span class="p">,</span> <span class="n">lo</span><span class="p">)</span>

    <span class="p">[</span><span class="n">progress_pow</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">main_compute</span><span class="p">()</span>

    <span class="n">intensity</span> <span class="o">=</span> <span class="n">progress_pow</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">fwhm2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="n">intensity</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">intensity</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">fwhm_final</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">fwhm2</span><span class="p">])</span>

    <span class="n">w0_final</span> <span class="o">=</span> <span class="n">fwhm_final</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Beampy:&quot;</span><span class="p">,</span> <span class="n">w0_final</span><span class="p">)</span>

    <span class="n">w0</span> <span class="o">=</span> <span class="n">fwhm</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">z0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">w0</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">lo</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">w0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">length_z</span> <span class="o">/</span> <span class="n">z0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Theory:&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;relative difference:&quot;</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="n">w0_final</span><span class="p">)</span><span class="o">/</span><span class="n">w</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">example_stability</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Show the possible BPM approximations for implementing a refractive</span>
<span class="sd">    index variation&quot;&quot;&quot;</span>

    <span class="n">width</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">no</span> <span class="o">=</span> <span class="mf">2.14</span>
    <span class="n">delta_no</span> <span class="o">=</span> <span class="mf">0.0014</span>
    <span class="n">length_z</span> <span class="o">=</span> <span class="mi">200</span>
    <span class="n">dist_z</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">nbr_z_disp</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">dist_x</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">length_x</span> <span class="o">=</span> <span class="mi">1000</span>

    <span class="n">bpm</span> <span class="o">=</span> <span class="n">Bpm</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">no</span><span class="p">,</span> <span class="n">delta_no</span><span class="p">,</span>
              <span class="n">length_z</span><span class="p">,</span> <span class="n">dist_z</span><span class="p">,</span> <span class="n">nbr_z_disp</span><span class="p">,</span>
              <span class="n">length_x</span><span class="p">,</span> <span class="n">dist_x</span><span class="p">)</span>

    <span class="p">[</span><span class="n">length_z</span><span class="p">,</span> <span class="n">nbr_z</span><span class="p">,</span> <span class="n">nbr_z_disp</span><span class="p">,</span> <span class="n">length_x</span><span class="p">,</span> <span class="n">nbr_x</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">create_x_z</span><span class="p">()</span>

    <span class="n">shape</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">squared_guide</span><span class="p">()</span>

    <span class="n">nbr_p</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="p">[</span><span class="n">peaks</span><span class="p">,</span> <span class="n">dn</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">create_guides</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">nbr_p</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="n">fwhm</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">lo</span> <span class="o">=</span> <span class="mf">1.5</span>

    <span class="n">field</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">gauss_light</span><span class="p">(</span><span class="n">fwhm</span><span class="p">)</span>
    <span class="n">irrad</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">theta_ext</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="p">[</span><span class="n">progress_pow</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">init_field</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">theta_ext</span><span class="p">,</span> <span class="n">irrad</span><span class="p">,</span> <span class="n">lo</span><span class="p">)</span>

    <span class="n">nbr_step</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="c1"># Need to overwrite those variables due to changes</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">asin</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_ext</span><span class="p">))</span> <span class="o">/</span> <span class="n">no</span><span class="p">)</span>  <span class="c1"># angle in the guide</span>
    <span class="n">nu_max</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dist_x</span><span class="p">)</span>  <span class="c1"># max frequency due to sampling</span>
    <span class="c1"># Spacial frequencies over x (1/µm)</span>
    <span class="n">nu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">nu_max</span><span class="p">,</span>
                     <span class="n">nu_max</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="n">nbr_x</span><span class="p">),</span>
                     <span class="n">nbr_x</span><span class="p">)</span>
    <span class="n">intermed</span> <span class="o">=</span> <span class="n">no</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">/</span> <span class="n">lo</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">nu</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">intermed</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
        <span class="n">intermed</span><span class="o">**</span><span class="mi">2</span>
        <span class="o">-</span> <span class="n">nu</span><span class="o">**</span><span class="mi">2</span>
        <span class="o">+</span> <span class="mi">0</span><span class="n">j</span><span class="p">))</span>

    <span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">dist_z</span> <span class="o">*</span> <span class="n">fr</span><span class="p">))</span>
    <span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">dist_z</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">fr</span><span class="p">))</span>
    <span class="c1"># End overwrite</span>

    <span class="n">field</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">field</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_step</span><span class="p">):</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
        <span class="n">field</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">bpm</span><span class="o">.</span><span class="n">nl_mat</span><span class="p">[</span><span class="n">nbr_step</span><span class="p">,</span> <span class="p">:])</span>
    <span class="n">test_1</span> <span class="o">=</span> <span class="n">field</span>

    <span class="n">field</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">field</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_step</span><span class="p">):</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
        <span class="n">field</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">bpm</span><span class="o">.</span><span class="n">nl_mat</span><span class="p">[</span><span class="n">nbr_step</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
    <span class="n">test_2</span> <span class="o">=</span> <span class="n">field</span>

    <span class="n">field</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">field</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_step</span><span class="p">):</span>
        <span class="n">field</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">bpm</span><span class="o">.</span><span class="n">nl_mat</span><span class="p">[</span><span class="n">nbr_step</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
    <span class="n">test_3</span> <span class="o">=</span> <span class="n">field</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s2">&quot;field real&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Impact of the free propagation order&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">test_1</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;first: dz+lens&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">test_2</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;middle: dz/2+lens+dz/2&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">test_3</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;last: lens+dz&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s2">&quot;field imag&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Impact of the free propagation order&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">test_1</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;first: dz+lens&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">test_2</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;middle: dz/2+lens+dz/2&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">test_3</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;last: lens+dz&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">field</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">field</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
    <span class="n">field</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">bpm</span><span class="o">.</span><span class="n">nl_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
    <span class="n">field</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">bpm</span><span class="o">.</span><span class="n">nl_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
    <span class="n">test_4</span> <span class="o">=</span> <span class="n">field</span>

    <span class="n">field</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">field</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
    <span class="n">field</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">bpm</span><span class="o">.</span><span class="n">nl_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
    <span class="n">field</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">bpm</span><span class="o">.</span><span class="n">nl_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
    <span class="n">test_5</span> <span class="o">=</span> <span class="n">field</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s2">&quot;field real 2&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Same algorithme optimized&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">test_4</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dz/2+lens+dz+lens+dz/2&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">test_5</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;(dz/2+lens+dz/2)*2&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s2">&quot;field imag 2&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Same algorithme optimized&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">test_4</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dz/2+lens+dz+lens+dz/2&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">test_5</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;(dz/2+lens+dz/2)*2&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">field</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">field</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
    <span class="n">field</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">bpm</span><span class="o">.</span><span class="n">nl_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
    <span class="n">test_6</span> <span class="o">=</span> <span class="n">field</span>

    <span class="n">field</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">field</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
    <span class="n">field</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">bpm</span><span class="o">.</span><span class="n">nl_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
    <span class="n">test_7</span> <span class="o">=</span> <span class="n">field</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s2">&quot;field real 3&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Approximation if uses loop over lens+dz&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">test_6</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dz/2+lens+dz&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">test_7</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dz/2+lens+dz/2&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s2">&quot;field imag 3&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Approximation if uses loop over lens+dz&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">test_4</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dz/2+lens+dz&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">test_5</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dz/2+lens+dz/2&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">example_kerr</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;More test than example.</span>
<span class="sd">    Show the different approximation possible for the BPM implementation of the</span>
<span class="sd">    Kerr effect.&quot;&quot;&quot;</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">no</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">delta_no</span> <span class="o">=</span> <span class="mf">0.0014</span>
    <span class="n">length_z</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">dist_z</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">nbr_z_disp</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">dist_x</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">length_x</span> <span class="o">=</span> <span class="mf">300.8</span>

    <span class="n">bpm</span> <span class="o">=</span> <span class="n">Bpm</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">no</span><span class="p">,</span> <span class="n">delta_no</span><span class="p">,</span>
              <span class="n">length_z</span><span class="p">,</span> <span class="n">dist_z</span><span class="p">,</span> <span class="n">nbr_z_disp</span><span class="p">,</span>
              <span class="n">length_x</span><span class="p">,</span> <span class="n">dist_x</span><span class="p">)</span>

    <span class="p">[</span><span class="n">length_z</span><span class="p">,</span> <span class="n">nbr_z</span><span class="p">,</span> <span class="n">nbr_z_disp</span><span class="p">,</span> <span class="n">length_x</span><span class="p">,</span> <span class="n">nbr_x</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">create_x_z</span><span class="p">()</span>

    <span class="n">shape</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">gauss_guide</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

    <span class="n">nbr_p</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="p">[</span><span class="n">peaks</span><span class="p">,</span> <span class="n">dn</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">create_guides</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">nbr_p</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="n">fwhm</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">lo</span> <span class="o">=</span> <span class="mf">1.5</span>

    <span class="n">field</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">gauss_light</span><span class="p">(</span><span class="n">fwhm</span><span class="p">)</span>
    <span class="n">irrad</span> <span class="o">=</span> <span class="mf">20000e13</span>  <span class="c1"># if too high, see big difference between method</span>
    <span class="n">theta_ext</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="p">[</span><span class="n">progress_pow</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">init_field</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">theta_ext</span><span class="p">,</span> <span class="n">irrad</span><span class="p">,</span> <span class="n">lo</span><span class="p">)</span>

    <span class="c1"># Need to overwrite those variables due to changes</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">asin</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_ext</span><span class="p">))</span> <span class="o">/</span> <span class="n">no</span><span class="p">)</span>  <span class="c1"># angle in the guide</span>
    <span class="n">nu_max</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dist_x</span><span class="p">)</span>  <span class="c1"># max frequency due to sampling</span>
    <span class="c1"># Spacial frequencies over x (1/µm)</span>
    <span class="n">nu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">nu_max</span><span class="p">,</span>
                     <span class="n">nu_max</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="n">nbr_x</span><span class="p">),</span>
                     <span class="n">nbr_x</span><span class="p">)</span>
    <span class="n">intermed</span> <span class="o">=</span> <span class="n">no</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">/</span> <span class="n">lo</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">nu</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">intermed</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
        <span class="n">intermed</span><span class="o">**</span><span class="mi">2</span>
        <span class="o">-</span> <span class="n">nu</span><span class="o">**</span><span class="mi">2</span>
        <span class="o">+</span> <span class="mi">0</span><span class="n">j</span><span class="p">))</span>

    <span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">dist_z</span> <span class="o">*</span> <span class="n">fr</span><span class="p">))</span>
    <span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">dist_z</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">fr</span><span class="p">))</span>
    <span class="c1"># End overwrite</span>

    <span class="n">kerr_loop</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">variance_check</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">chi3</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="mf">1E-20</span>

    <span class="n">nbr_step</span> <span class="o">=</span> <span class="mi">2000</span>  <span class="c1"># max length_z / dist_z</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> dz/2+lens+dz/2&quot;</span><span class="p">)</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">field</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_step</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;step&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="c1">#        plt.figure(num=&#39;Reference without kerr&#39;)</span>
<span class="c1">#        ax1 = plt.subplot(211)</span>
<span class="c1">#        ax2 = plt.subplot(212)</span>
<span class="c1">#        ax1.set_title(&quot;real: no kerr&quot;)</span>
<span class="c1">#        ax2.set_title(&quot;imag: no kerr&quot;)</span>
<span class="c1">#        plt.xlim(-1, 1)</span>
<span class="c1">#        plt.ylim(5.85e17, 6.05e17)</span>

        <span class="c1"># Linear propagation over dz/2</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>

        <span class="c1"># Influence of the index modulation on the field</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">field</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">bpm</span><span class="o">.</span><span class="n">nl_mat</span><span class="p">[</span><span class="n">nbr_step</span><span class="p">,</span> <span class="p">:])</span>  <span class="c1"># No changes if</span>
        <span class="c1"># no initial guide (exp=1)</span>

        <span class="c1"># Linear propagation over dz/2</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>

        <span class="n">cur_pow</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">epnc</span> <span class="o">*</span> <span class="p">(</span><span class="n">field</span> <span class="o">*</span> <span class="n">field</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span><span class="o">.</span><span class="n">real</span>
<span class="c1">#        ax1.plot(x, field_x.real, label=&#39;no kerr&#39;)</span>
<span class="c1">#        ax2.plot(x, field_x.imag, label=&#39;no kerr&#39;)</span>

    <span class="n">field_ref</span> <span class="o">=</span> <span class="n">field</span>
    <span class="n">cur_ref</span> <span class="o">=</span> <span class="n">cur_pow</span>
<span class="c1">#    ax1.legend(loc=&quot;upper right&quot;)</span>
<span class="c1">#    ax2.legend(loc=&quot;upper right&quot;)</span>
<span class="c1">#    plt.show()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> dz+kerr&quot;</span><span class="p">)</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">field</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_step</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;step&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="c1">#        plt.figure(num=&#39;Impact of the kerr effect for dz+kerr&#39;)</span>
<span class="c1">#        ax1 = plt.subplot(211)</span>
<span class="c1">#        ax2 = plt.subplot(212)</span>
<span class="c1">#        ax1.set_title(&quot;real: dz+kerr&quot;)</span>
<span class="c1">#        ax2.set_title(&quot;imag: dz+kerr&quot;)</span>
<span class="c1">#        plt.xlim(-1, 1)</span>
<span class="c1">#        plt.ylim(5.85e17, 6.05e17)</span>

        <span class="c1"># Linear propagation over dz</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>

        <span class="c1"># Influence of the index modulation on the field</span>
        <span class="n">field_x</span> <span class="o">=</span> <span class="n">field</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">bpm</span><span class="o">.</span><span class="n">nl_mat</span><span class="p">[</span><span class="n">nbr_step</span><span class="p">,</span> <span class="p">:])</span>  <span class="c1"># No changes if</span>
        <span class="c1"># no initial guide (exp=1)</span>

        <span class="n">cur_pow</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">epnc</span> <span class="o">*</span> <span class="p">(</span><span class="n">field_x</span> <span class="o">*</span> <span class="n">field_x</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span><span class="o">.</span><span class="n">real</span>

<span class="c1">#        ax1.plot(x, field_x.real, label=&#39;no kerr&#39;)</span>
<span class="c1">#        ax2.plot(x, field_x.imag, label=&#39;no kerr&#39;)</span>

        <span class="k">if</span> <span class="n">kerr_loop</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">prev_pow</span> <span class="o">=</span> <span class="n">cur_pow</span>
                <span class="c1"># influence of the beam intensity on the index modulation</span>
                <span class="n">dn</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="n">nbr_step</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">chi3</span> <span class="o">/</span> <span class="mi">8</span> <span class="o">/</span> <span class="n">no</span> <span class="o">*</span> <span class="n">prev_pow</span><span class="p">)</span>
                <span class="n">nl_mat</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">ko</span> <span class="o">*</span> <span class="n">bpm</span><span class="o">.</span><span class="n">dist_z</span> <span class="o">*</span> <span class="n">dn</span>

                <span class="c1"># influence of the index modulation on the field</span>
                <span class="n">field_x</span> <span class="o">=</span> <span class="n">field</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">nl_mat</span><span class="p">)</span>  <span class="c1"># No changes for the pow</span>

                <span class="c1"># power at z</span>
                <span class="n">cur_pow</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">epnc</span> <span class="o">*</span> <span class="p">(</span><span class="n">field_x</span> <span class="o">*</span> <span class="n">field_x</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span><span class="o">.</span><span class="n">real</span>

    <span class="c1">#            ax1.plot(x, field_x.real, label=&#39;loop:&#39;+str(k+1))</span>
    <span class="c1">#            ax2.plot(x, field_x.imag, label=&#39;loop:&#39;+str(k+1))</span>

    <span class="c1">#        print(max(dn))</span>
    <span class="c1">#        if variance_check:</span>
    <span class="c1">#            try:</span>
    <span class="c1">#                bpm.variance(prev_pow, cur_pow)  # Check if converge</span>
    <span class="c1">#                    print(bpm.nl_control_amp)</span>
    <span class="c1">#            except ValueError as ex:</span>
    <span class="c1">#                    print(ex)</span>
    <span class="c1">#                print(&quot;Warning&quot;, bpm.nl_control_amp)</span>

        <span class="n">field</span> <span class="o">=</span> <span class="n">field_x</span>

    <span class="n">field_1</span> <span class="o">=</span> <span class="n">field</span>
    <span class="n">cur_1</span> <span class="o">=</span> <span class="n">cur_pow</span>
    <span class="n">dn_1</span> <span class="o">=</span> <span class="n">dn</span>
<span class="c1">#    ax1.legend(loc=&quot;upper right&quot;)</span>
<span class="c1">#    ax2.legend(loc=&quot;upper right&quot;)</span>
<span class="c1">#    plt.show()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> dz/2+kerr+dz/2&quot;</span><span class="p">)</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">field</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_step</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;step&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="c1">#        plt.figure(num=&quot;intensity with kerr dz/2+kerr+dz/2&quot;)</span>
<span class="c1">#        ax1 = plt.subplot(211)</span>
<span class="c1">#        ax2 = plt.subplot(212)</span>
<span class="c1">#        ax1.set_title(&quot;real: dz/2+kerr+dz/2&quot;)</span>
<span class="c1">#        ax2.set_title(&quot;imag: dz/2+kerr+dz/2&quot;)</span>
<span class="c1">#        plt.xlim(-1, 1)</span>
<span class="c1">#        plt.ylim(5.85e17, 6.05e17)</span>

        <span class="c1"># Linear propagation over dz/2</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>

        <span class="c1"># Influence of the index modulation on the field</span>
        <span class="n">field_x</span> <span class="o">=</span> <span class="n">field</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">bpm</span><span class="o">.</span><span class="n">nl_mat</span><span class="p">[</span><span class="n">nbr_step</span><span class="p">,</span> <span class="p">:])</span>  <span class="c1"># No changes if</span>
        <span class="c1"># no initial guide (exp=1)</span>

        <span class="c1"># Linear propagation over dz/2</span>
        <span class="n">field_x</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field_x</span><span class="p">))</span>

        <span class="n">cur_pow</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">epnc</span> <span class="o">*</span> <span class="p">(</span><span class="n">field_x</span> <span class="o">*</span> <span class="n">field_x</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span><span class="o">.</span><span class="n">real</span>

<span class="c1">#        ax1.plot(x, field_x.real, label=&#39;no kerr&#39;)</span>
<span class="c1">#        ax2.plot(x, field_x.imag, label=&#39;no kerr&#39;)</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">kerr_loop</span><span class="p">):</span>
            <span class="n">prev_pow</span> <span class="o">=</span> <span class="n">cur_pow</span>
            <span class="c1"># influence of the beam intensity on the index modulation</span>
            <span class="n">dn</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="n">nbr_step</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">chi3</span> <span class="o">/</span> <span class="mi">8</span> <span class="o">/</span> <span class="n">no</span> <span class="o">*</span> <span class="n">prev_pow</span><span class="p">)</span>
            <span class="n">nl_mat</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">ko</span> <span class="o">*</span> <span class="n">bpm</span><span class="o">.</span><span class="n">dist_z</span> <span class="o">*</span> <span class="n">dn</span>

            <span class="c1"># influence of the index modulation on the field</span>
            <span class="n">field_x</span> <span class="o">=</span> <span class="n">field</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">nl_mat</span><span class="p">)</span>
            <span class="c1"># Linear propagation over dz/2</span>
            <span class="n">field_x</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat_demi</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field_x</span><span class="p">))</span>
            <span class="c1"># power at z</span>
            <span class="n">cur_pow</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">epnc</span> <span class="o">*</span> <span class="p">(</span><span class="n">field_x</span> <span class="o">*</span> <span class="n">field_x</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span><span class="o">.</span><span class="n">real</span>

<span class="c1">#            ax1.plot(x, field_x.real, label=&#39;loop:&#39;+str(k+1))</span>
<span class="c1">#            ax2.plot(x, field_x.imag, label=&#39;loop:&#39;+str(k+1))</span>

<span class="c1">#        print(max(dn))</span>
        <span class="k">if</span> <span class="n">variance_check</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">bpm</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">prev_pow</span><span class="p">,</span> <span class="n">cur_pow</span><span class="p">)</span>  <span class="c1"># Check if converge</span>
<span class="c1">#                    print(bpm.nl_control_amp)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span> <span class="n">bpm</span><span class="o">.</span><span class="n">nl_control_amp</span><span class="p">)</span>

        <span class="n">field</span> <span class="o">=</span> <span class="n">field_x</span>

    <span class="n">field_2</span> <span class="o">=</span> <span class="n">field</span>
    <span class="n">cur_2</span> <span class="o">=</span> <span class="n">cur_pow</span>
    <span class="n">dn_2</span> <span class="o">=</span> <span class="n">dn</span>
<span class="c1">#    ax1.legend(loc=&quot;upper right&quot;)</span>
<span class="c1">#    ax2.legend(loc=&quot;upper right&quot;)</span>
<span class="c1">#    plt.show()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> kerr+dz&quot;</span><span class="p">)</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">field</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_step</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;step&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

<span class="c1">#        plt.figure(num=&quot;intensity with kerr kerr+dz&quot;)</span>
<span class="c1">#        ax1 = plt.subplot(211)</span>
<span class="c1">#        ax2 = plt.subplot(212)</span>
<span class="c1">#        ax1.set_title(&quot;real: kerr+dz&quot;)</span>
<span class="c1">#        ax2.set_title(&quot;imag: kerr+dz&quot;)</span>
<span class="c1">#        plt.xlim(-1, 1)</span>
<span class="c1">#        plt.ylim(5.85e17, 6.05e17)</span>

        <span class="c1"># Influence of the index modulation on the field</span>
        <span class="n">field_x</span> <span class="o">=</span> <span class="n">field</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">bpm</span><span class="o">.</span><span class="n">nl_mat</span><span class="p">[</span><span class="n">nbr_step</span><span class="p">,</span> <span class="p">:])</span>  <span class="c1"># No changes if</span>
        <span class="c1"># no initial guide (exp=1)</span>

        <span class="c1"># Linear propagation over dz</span>
        <span class="n">field_x</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field_x</span><span class="p">))</span>

        <span class="n">cur_pow</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">epnc</span> <span class="o">*</span> <span class="p">(</span><span class="n">field_x</span> <span class="o">*</span> <span class="n">field_x</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span><span class="o">.</span><span class="n">real</span>

<span class="c1">#        ax1.plot(x, field_x.real, label=&#39;no kerr&#39;)</span>
<span class="c1">#        ax2.plot(x, field_x.imag, label=&#39;no kerr&#39;)</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">kerr_loop</span><span class="p">):</span>
            <span class="n">prev_pow</span> <span class="o">=</span> <span class="n">cur_pow</span>
            <span class="c1"># influence of the beam intensity on the index modulation</span>
            <span class="n">dn</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="n">nbr_step</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">chi3</span> <span class="o">/</span> <span class="mi">8</span> <span class="o">/</span> <span class="n">no</span> <span class="o">*</span> <span class="n">prev_pow</span><span class="p">)</span>
            <span class="n">nl_mat</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">ko</span> <span class="o">*</span> <span class="n">bpm</span><span class="o">.</span><span class="n">dist_z</span> <span class="o">*</span> <span class="n">dn</span>

            <span class="c1"># influence of the index modulation on the field</span>
            <span class="n">field_x</span> <span class="o">=</span> <span class="n">field</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">nl_mat</span><span class="p">)</span>
            <span class="c1"># Linear propagation over dz</span>
            <span class="n">field_x</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">bpm</span><span class="o">.</span><span class="n">phase_mat</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">field_x</span><span class="p">))</span>
            <span class="c1"># power at z</span>
            <span class="n">cur_pow</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">epnc</span> <span class="o">*</span> <span class="p">(</span><span class="n">field_x</span> <span class="o">*</span> <span class="n">field_x</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span><span class="o">.</span><span class="n">real</span>

<span class="c1">#            ax1.plot(x, field_x.real, label=&#39;loop:&#39;+str(k+1))</span>
<span class="c1">#            ax2.plot(x, field_x.imag, label=&#39;loop:&#39;+str(k+1))</span>

<span class="c1">#        print(max(dn))</span>
        <span class="k">if</span> <span class="n">variance_check</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">bpm</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">prev_pow</span><span class="p">,</span> <span class="n">cur_pow</span><span class="p">)</span>  <span class="c1"># Check if converge</span>
<span class="c1">#                    print(bpm.nl_control_amp)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span> <span class="n">bpm</span><span class="o">.</span><span class="n">nl_control_amp</span><span class="p">)</span>

        <span class="n">field</span> <span class="o">=</span> <span class="n">field_x</span>

    <span class="n">field_3</span> <span class="o">=</span> <span class="n">field</span>
    <span class="n">cur_3</span> <span class="o">=</span> <span class="n">cur_pow</span>
    <span class="n">dn_3</span> <span class="o">=</span> <span class="n">dn</span>
<span class="c1">#    ax1.legend(loc=&quot;upper right&quot;)</span>
<span class="c1">#    plt.show()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="s2">&quot;Impact order kerr&quot;</span><span class="p">)</span>

    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;phase: comparison&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;power: comparison&quot;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">field_ref</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;no kerr&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">field_1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;dz+kerr&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">field_2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;dz/2+kerr+dz/2&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">field_3</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;kerr+dz&quot;</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cur_ref</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;no kerr&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cur_1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;dz+kerr&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cur_2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;dz/2+kerr+dz/2&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cur_3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;kerr+dz&quot;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">dn_ref</span> <span class="o">=</span> <span class="n">bpm</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="n">nbr_step</span><span class="p">,</span> <span class="p">:]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="s2">&quot;Impact on dn order kerr&quot;</span><span class="p">)</span>

    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;dn: comparison&quot;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dn_ref</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;no kerr&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dn_1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;dz+kerr&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dn_2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;dz/2+kerr+dz/2&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dn_3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;kerr+dz&quot;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="contact.html" class="btn btn-neutral float-left" title="Contact" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020 Jonathan Peltier and Marcel Soubkovsky

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>