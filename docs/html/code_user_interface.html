

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>beampy.user_interface &mdash; beampy 1.11 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="beampy.interface" href="code_interface.html" />
    <link rel="prev" title="beampy.bpm" href="code_bpm.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> beampy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="interface.html">Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="beampy.html">Beampy modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="codes.html">Source codes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="code_bpm.html">beampy.bpm</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">beampy.user_interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="code_interface.html">beampy.interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="code_example.html">beampy.examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release_note.html">Release note</a></li>
<li class="toctree-l1"><a class="reference internal" href="LICENSE.html">MIT License</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">beampy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="codes.html">Source codes</a> &raquo;</li>
        
      <li>beampy.user_interface</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/code_user_interface.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="beampy-user-interface">
<span id="code-user-interface"></span><h1>beampy.user_interface<a class="headerlink" href="#beampy-user-interface" title="Permalink to this headline">Â¶</a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The user_interface module is the main file of the beampy module.</span>
<span class="sd">It contain the UserInterface class used to computed and displayed the bpm</span>
<span class="sd">results onto the interface.</span>

<span class="sd">This module was at first developed by Marcel Soubkovsky for the implementation</span>
<span class="sd">of the array of guides, of one gaussian beam and of the plotting methods.</span>
<span class="sd">Then, continued by Jonathan Peltier.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QApplication</span><span class="p">,</span> <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QFileDialog</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="p">(</span><span class="n">pyqtSlot</span><span class="p">,</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">QSize</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="kn">import</span> <span class="n">QIcon</span>

<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="kn">import</span> <span class="n">Figure</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qt4agg</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">FigureCanvasQTAgg</span> <span class="k">as</span> <span class="n">FigureCanvas</span><span class="p">,</span>
    <span class="n">NavigationToolbar2QT</span> <span class="k">as</span> <span class="n">NavigationToolbar</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Polygon</span>

<span class="c1"># interface.py generated from interface.ui made using Qt designer</span>
<span class="kn">from</span> <span class="nn">beampy.interface</span> <span class="kn">import</span> <span class="n">Ui_MainWindow</span>
<span class="kn">from</span> <span class="nn">beampy.bpm</span> <span class="kn">import</span> <span class="n">Bpm</span>  <span class="c1"># Bpm class with all the BPM methods</span>

<span class="c1"># ! To translate from .ui to .py -&gt; pyuic5 -x interface.ui -o interface.py</span>

<span class="c1"># Check out if doubts on the interface:</span>
<span class="c1"># http://blog.rcnelson.com/building-a-matplotlib-gui-with-qt-designer-part-1/</span>


<span class="k">class</span> <span class="nc">UserInterface</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">,</span> <span class="n">Ui_MainWindow</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class connect the :class:`.Bpm` class from the :mod:`.bpm` module</span>
<span class="sd">    with the :meth:`.setupUi` method from the :mod:`.interface` module.</span>
<span class="sd">    The interface seems to close itself when openning from spyder 3.5.</span>
<span class="sd">    In that case, open the interface in an external console.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">QMainWindow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># Linked to Ui_MainWindow through interface.py</span>

        <span class="c1"># Prepare variables before assigning values to them</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">guide_length</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide_z</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_imag</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss_check</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">full_index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape_gauss_check</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gauss_pow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape_squared_check</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">curve</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">half_delay</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distance_factor</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous_guide</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irrad</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irrad_significand</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irrad_exponent</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Warning: if exponent is set to int, will</span>
        <span class="c1"># cause a error when using 10**exponent because outside int limit and</span>
        <span class="c1"># goes in the negative values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">square_check</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_guide_ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous_beam</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">on_click_create_guide</span><span class="p">()</span>  <span class="c1"># Initialized variables with buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_click_create_light</span><span class="p">()</span>  <span class="c1"># Initialized variables with buttons</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_guide</span><span class="p">()</span>  <span class="c1"># Compute waveguides</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_light</span><span class="p">()</span>  <span class="c1"># Compute light</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="s1">&#39;guide&#39;</span><span class="p">)</span>  <span class="c1"># Display waveguides</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="s1">&#39;light&#39;</span><span class="p">)</span>  <span class="c1"># Display light</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">show_estimate_time</span><span class="p">()</span>

        <span class="c1"># Initialized compute graphics</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_propag</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">Figure</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_propag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_propag</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">Figure</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_propag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_propag</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_pow</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">Figure</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute_plot</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_pow</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_pow</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">Figure</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute_plot</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_pow</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_end</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">Figure</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_end</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_end</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">Figure</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_end</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connect_buttons</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_menu</span><span class="p">()</span>

        <span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">ArrowCursor</span><span class="p">)</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">connect_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Connect the interface buttons to their corresponding functions:</span>

<span class="sd">        :meth:`.on_click_guide`, :meth:`.on_click_curved`,</span>
<span class="sd">        :meth:`.on_click_light`, :meth:`.on_click_compute`,</span>
<span class="sd">        :meth:`.on_click_create_light`, :meth:`.on_click_delete_light`,</span>
<span class="sd">        :meth:`.save_light`, :meth:`.get_guide`,</span>
<span class="sd">        :meth:`.get_light`, :meth:`.get_compute`,</span>
<span class="sd">        :meth:`.show_estimate_time`, :meth:`.check_modes_display`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_guide</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_click_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_light</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_click_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton_compute</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_click_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_create_beam</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_click_create_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_delete_beam</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_click_delete_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_save_beam</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_create_guide</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_click_create_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_delete_guide</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_click_delete_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_save_guide</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_guide</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_light</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_cancel_compute</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_compute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_estimate_time</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_estimate_time</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_mode_number</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">check_modes_display</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_power</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">display_power</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a menu to open, save a file, or exit the app.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method connect the following methods and function to the</span>
<span class="sd">        menu buttons:</span>

<span class="sd">        :meth:`.open_file_name`, :meth:`.save_quick`, :meth:`.save_file_name`,</span>
<span class="sd">        :func:`.open_doc`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="vm">__file__</span>  <span class="c1"># Module name</span>
        <span class="c1"># Replaces characters only when called from outer files</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="n">folder</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="n">folder</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="n">folder</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Remove the file name</span>
        <span class="n">folder2</span> <span class="o">=</span> <span class="nb">str</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">folder</span><span class="p">:</span>
            <span class="n">folder2</span> <span class="o">=</span> <span class="n">folder2</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">line</span>

        <span class="n">folder</span> <span class="o">=</span> <span class="n">folder2</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">+</span><span class="s2">&quot;/&quot;</span>

        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">()</span>
        <span class="n">icon</span><span class="o">.</span><span class="n">addFile</span><span class="p">(</span><span class="n">folder</span><span class="o">+</span><span class="s1">&#39;icons/beampy-logo.png&#39;</span><span class="p">,</span> <span class="n">QSize</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>

        <span class="n">menubar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span>

        <span class="n">file</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s1">&#39;File&#39;</span><span class="p">)</span>

        <span class="n">action</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Open&#39;</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_file_name</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s1">&#39;Ctrl+O&#39;</span><span class="p">)</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">()</span>
        <span class="n">icon</span><span class="o">.</span><span class="n">addFile</span><span class="p">(</span><span class="n">folder</span><span class="o">+</span><span class="s1">&#39;icons/document-open.png&#39;</span><span class="p">,</span> <span class="n">QSize</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>

        <span class="n">action</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Save&#39;</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_quick</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s1">&#39;Ctrl+S&#39;</span><span class="p">)</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">()</span>
        <span class="n">icon</span><span class="o">.</span><span class="n">addFile</span><span class="p">(</span><span class="n">folder</span><span class="o">+</span><span class="s1">&#39;icons/document-save.png&#39;</span><span class="p">,</span> <span class="n">QSize</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>

        <span class="n">action</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Save as&#39;</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_file_name</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s1">&#39;Ctrl+Shift+S&#39;</span><span class="p">)</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">()</span>
        <span class="n">icon</span><span class="o">.</span><span class="n">addFile</span><span class="p">(</span><span class="n">folder</span><span class="o">+</span><span class="s1">&#39;icons/document-save-as.png&#39;</span><span class="p">,</span> <span class="n">QSize</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>

        <span class="n">action</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Exit&#39;</span><span class="p">)</span>  <span class="c1"># Clean exit for spyder</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s1">&#39;Ctrl+Q&#39;</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">QApplication</span><span class="o">.</span><span class="n">quit</span><span class="p">)</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">()</span>
        <span class="n">icon</span><span class="o">.</span><span class="n">addFile</span><span class="p">(</span><span class="n">folder</span><span class="o">+</span><span class="s1">&#39;icons/application-exit.png&#39;</span><span class="p">,</span> <span class="n">QSize</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>

        <span class="n">file</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s1">&#39;Help&#39;</span><span class="p">)</span>

        <span class="n">action</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Documentation&#39;</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">open_doc</span><span class="p">)</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">()</span>
        <span class="n">icon</span><span class="o">.</span><span class="n">addFile</span><span class="p">(</span><span class="n">folder</span><span class="o">+</span><span class="s1">&#39;icons/help-about.png&#39;</span><span class="p">,</span> <span class="n">QSize</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">calculate_guide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialized the :class:`.Bpm` class and creates the guides.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Creats many variables, including :</span>

<span class="sd">        - peaks : Central position of each waveguides [waveguide,z].</span>
<span class="sd">        - dn : Difference of reefractive index [z,x].</span>

<span class="sd">        This method calls the following methods from :class:`.Bpm`:</span>

<span class="sd">        :meth:`.create_x_z`, :meth:`.squared_guide`, :meth:`.gauss_guide`,</span>
<span class="sd">        :meth:`.create_guides`, :meth:`.create_curved_guides`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Waveguides creation&quot;</span><span class="p">)</span>
        <span class="n">t_guide_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">save_guide</span><span class="p">()</span>  <span class="c1"># Get all waveguide values</span>

        <span class="c1"># Create the Bpm class (overwrite existing one)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span> <span class="o">=</span> <span class="n">Bpm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lo</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">length_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)</span>

        <span class="c1"># windows variables</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">length_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">create_x_z</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nbr_z_disp</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">5000</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: if you want to have more points,&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;change the condition nbr_x * nbr_z_disp in calculate_guide&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Too many points:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">10000</span> <span class="o">*</span> <span class="mi">15000</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span> <span class="o">&gt;</span> <span class="mi">40000</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span> <span class="o">&gt;</span> <span class="mi">40000</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: if you want to have more points,&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;change the condition nbr_x * nbr_z in calculate_guide&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Too many points:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">)</span>

        <span class="n">nbr_guide</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_guide</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>  <span class="c1"># Total waveguide count</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_guide</span><span class="p">):</span>
            <span class="c1"># Waveguide shape choice</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_squared_check</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>  <span class="c1"># Squared waveguides</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">squared_guide</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_gauss_check</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>  <span class="c1"># Gaussian waveguides</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">gauss_guide</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                             <span class="n">gauss_pow</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gauss_pow</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="c1"># Topology waveguides choice</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># array of waveguides</span>
                <span class="n">length_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">length_max</span><span class="p">:</span>
                    <span class="c1"># give info about possible good values</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nbr_p*p &gt; length_x: &quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="n">length_max</span><span class="p">)</span>

                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p_max=&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">length_max</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">3</span><span class="p">))</span>

                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">length_max</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="n">length_max</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nbr_p_max=&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">length_max</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nbr_p_max=&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">length_max</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="p">[</span><span class="n">peaks</span><span class="p">,</span> <span class="n">dn</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">create_guides</span><span class="p">(</span>
                    <span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_index</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">offset_guide</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_guide_z</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide_z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">guide_length</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># curved waveguides</span>
                <span class="n">curve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">curve</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1E-8</span>  <span class="c1"># curvature factor</span>
                <span class="p">[</span><span class="n">peaks</span><span class="p">,</span> <span class="n">dn</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">create_curved_guides</span><span class="p">(</span>
                    <span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_index</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">curve</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_delay</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_factor</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">offset_guide</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">no</span><span class="o">/</span><span class="mi">10</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Careful: index variation too high for waveguide </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span>
                      <span class="s2">&quot;</span><span class="se">\t</span><span class="si">%f</span><span class="s2"> &gt; </span><span class="si">%f</span><span class="s2">/10&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">no</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span> <span class="n">peaks</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">,</span> <span class="n">dn</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dn_first</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="c1"># Display Waveguides</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">z_disp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">length_z</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># Note that z_disp can be wrong by 0.4% if the space between the</span>
            <span class="c1"># displayed points is not a multiple of length_z</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">xv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_disp</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dn_disp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_power</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># only display available settings</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">guide_length</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="c1"># If one of the waveguides has width=0, can chose invisible</span>
            <span class="c1"># waveguide has beam reference and display power=0. Not a big deal</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_nbr_ref</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_nbr_ref</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span> <span class="o">*=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_power</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_nbr_ref</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_power</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#        Define new min/max for light and looses, based on selected guides</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)</span>
        <span class="c1"># If want to use min/max for offset: multiple beams will have issue if</span>
        <span class="c1"># the windows size change (min/max will only be for the displayed beam)</span>
<span class="c1">#        self.doubleSpinBox_offset_light.setMinimum(self.x[0])</span>
<span class="c1">#        self.doubleSpinBox_offset_light.setMaximum(self.x[-1])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_guide_done</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">t_guide_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Waveguides creation time: &#39;</span><span class="p">,</span> <span class="n">t_guide_end</span><span class="o">-</span><span class="n">t_guide_start</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">calculate_light</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create the choosen beams.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Creates the progress_pow variable.</span>

<span class="sd">        This method calls the following methods from the :class:`.Bpm` class:</span>

<span class="sd">        :meth:`.gauss_light`, :meth:`.squared_light`, :meth:`.all_modes`,</span>
<span class="sd">        :meth:`.mode_light`, :meth:`.airy_light`, :meth:`.init_field`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Beams creation&quot;</span><span class="p">)</span>
        <span class="n">t_light_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">save_light</span><span class="p">()</span>  <span class="c1"># Get all light variables</span>
        <span class="c1"># must have same wavelength and angle or must compute for each</span>
        <span class="c1"># different wavelength or angle</span>
        <span class="n">nbr_light</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>  <span class="c1"># Number of beams</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nbr_light</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="p">))</span>

        <span class="k">if</span> <span class="mi">1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span><span class="p">:</span>  <span class="c1"># Display only once the max mode</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_modes_display</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_light</span><span class="p">):</span>

            <span class="c1"># Check if offset relative to waveguide number or else in Âµm</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>

                <span class="c1"># Reduce light # if &gt; guides #</span>
                <span class="n">peaks_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">peaks_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">maximum</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">peaks_i</span> <span class="o">&gt;</span> <span class="n">peaks_max</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;beam&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;has a non-existing waveguide position&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Change position from&quot;</span><span class="p">,</span> <span class="n">peaks_i</span><span class="p">,</span> <span class="s2">&quot;to&quot;</span><span class="p">,</span> <span class="n">peaks_max</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">peaks_max</span>

                <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">temp</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="kc">None</span><span class="p">)]</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">offset_light</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There is no waveguide nÂ°&quot;</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                          <span class="s2">&quot;The beam nÂ°&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;is disabled&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">offset_light</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="n">guide_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_guide_number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_guide_ref</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">guide_index</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;skipping the beam&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;because the waveguide&quot;</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">mode_guide_ref</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;doesn&#39;t exist&quot;</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="c1">#  Compute lights</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">field_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">gauss_light</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">offset_light</span><span class="o">=</span><span class="n">offset_light</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">square_check</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">field_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">squared_light</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">offset_light</span><span class="o">=</span><span class="n">offset_light</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>

                <span class="n">field_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">all_modes</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">[</span><span class="n">guide_index</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">[</span><span class="n">guide_index</span><span class="p">],</span>
                    <span class="n">offset_light</span><span class="o">=</span><span class="n">offset_light</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">field_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">mode_light</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">[</span><span class="n">guide_index</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">[</span><span class="n">guide_index</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">offset_light</span><span class="o">=</span><span class="n">offset_light</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

                <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># Say that no mode exist</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="s2">&quot;for the beam&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                    <span class="k">continue</span>  <span class="c1"># Go to the next field</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="p">[</span><span class="n">field_i</span><span class="p">,</span> <span class="n">last_zero_pos</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">airy_light</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">offset_light</span><span class="o">=</span><span class="n">offset_light</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">last_zero_pos</span><span class="p">)</span>  <span class="c1"># Corrected val</span>

            <span class="n">field</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_i</span>

        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">init_field</span><span class="p">(</span>
            <span class="n">field</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta_ext</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">irrad</span><span class="p">)</span>

<span class="c1">#        self.pushButton_power.setDisabled(True)</span>

        <span class="n">t_light_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Beams creation time: &#39;</span><span class="p">,</span> <span class="n">t_light_end</span><span class="o">-</span><span class="n">t_light_start</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">calculate_propagation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the propagation based on the input light and guides shapes.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Creates the progress_pow variable.</span>

<span class="sd">        Calls the following methods from :class:`.Bpm`:</span>
<span class="sd">        :meth:`.losses_position`, meth`.main_compute`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Propagation computation&quot;</span><span class="p">)</span>
        <span class="n">t_compute_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_guide_done</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">show_estimate_time</span><span class="p">()</span>  <span class="c1"># do also save_compute() needed here</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2_check</span><span class="p">:</span>
                <span class="n">n2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2</span>
                <span class="n">chi3</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">n2</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">chi3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n2</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">chi3</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_compute</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">,</span> <span class="n">n2</span><span class="o">=</span><span class="n">n2</span><span class="p">,</span> <span class="n">chi3</span><span class="o">=</span><span class="n">chi3</span><span class="p">,</span> <span class="n">kerr_loop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_loop</span><span class="p">,</span>
            <span class="n">variance_check</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">variance_check</span><span class="p">,</span> <span class="n">disp_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">progressBar_compute</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">guide_length</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_power</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">t_compute_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Computation time: &#39;</span><span class="p">,</span> <span class="n">t_compute_end</span><span class="o">-</span><span class="n">t_compute_start</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">main_compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dn</span><span class="p">,</span> <span class="n">n2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chi3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kerr_loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                     <span class="n">variance_check</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">disp_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        main method used to compute propagation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n2 : float, optional</span>
<span class="sd">            Nonlinear refractive index responsable for the optical Kerr effect</span>
<span class="sd">            in m^2/W. None by default.</span>
<span class="sd">        chi3 : float, optional</span>
<span class="sd">            Value of the third term of the electric susceptibility tensor</span>
<span class="sd">            in m^2/V^2. None by default.</span>
<span class="sd">        kerr : bool, optional</span>
<span class="sd">            Activate the kerr effect. False by default.</span>
<span class="sd">        kerr_loop : int, optional</span>
<span class="sd">            Number of corrective loop for the Kerr effect. 1 by default.</span>
<span class="sd">        variance_check : bool, optional</span>
<span class="sd">            Check if the kerr effect converge fast enought. False by default.</span>
<span class="sd">        alpha : float, optional</span>
<span class="sd">            Absorption per Âµm. 0 by default</span>
<span class="sd">        lost_beg : array-like, optional</span>
<span class="sd">            Left indices position of the selected waveguide over z.</span>
<span class="sd">            None by default.</span>
<span class="sd">        lost_end : array-like, optional</span>
<span class="sd">            Right indices position of the selected waveguide over z.</span>
<span class="sd">            None by default.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        progress_pow : array</span>
<span class="sd">            Intensity values (:math:`W/m^2`) over x (Âµm) and z (Âµm).</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        This method creates the following variables within the class</span>
<span class="sd">        :class:`Bpm`:</span>
<span class="sd">        nl_mat: Refractive index modulation.</span>

<span class="sd">        This method uses the :class:`Bpm` class variables:</span>
<span class="sd">        phase_mat, field, i, nbr_z, pas, current_power, dist_z, length_z,</span>
<span class="sd">        nbr_lost, dn, nl_mat, epnc and uses the :meth:`bpm_compute`,</span>
<span class="sd">        :meth:`kerr_effect`.</span>

<span class="sd">        This method change the values of the :class:`Bpm` class variables:</span>
<span class="sd">        field and if kerr, dn and nl_mat.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Refractive index modulation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">nl_mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">ko</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">dist_z</span> <span class="o">*</span> <span class="n">dn</span>

        <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">#  from i=0 to i=final-1 because don&#39;t use last dn</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">nbr_z</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="n">i</span>
            <span class="c1"># Compute non-linear and linear propagation for every z</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">bpm_compute</span><span class="p">(</span><span class="n">dn</span><span class="p">,</span> <span class="n">n2</span><span class="o">=</span><span class="n">n2</span><span class="p">,</span> <span class="n">chi3</span><span class="o">=</span><span class="n">chi3</span><span class="p">,</span> <span class="n">kerr_loop</span><span class="o">=</span><span class="n">kerr_loop</span><span class="p">,</span>
                                 <span class="n">variance_check</span><span class="o">=</span><span class="n">variance_check</span><span class="p">)</span>

            <span class="c1"># Display condition: if i+1 is a multiple of pas: i+1 % pas = 0</span>
            <span class="c1"># = False, so must use if not to have True</span>
            <span class="c1"># last condition to have last point if not a multiple of pas</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">pas</span>
                    <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">nbr_z</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">current_power</span><span class="p">])</span>

                <span class="n">current</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">dist_z</span><span class="o">/</span><span class="mf">1e3</span>
                <span class="n">final</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">length_z</span><span class="o">/</span><span class="mf">1e3</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">progressBar_compute</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">current</span><span class="o">/</span><span class="n">final</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">disp_progress</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">final</span><span class="p">,</span> <span class="s1">&#39;mm&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">show_estimate_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Display - on the interface - the estimate time needed to compute the</span>
<span class="sd">        propagation, based on linearized experimental values.</span>
<span class="sd">        The estimation takes into account the looses, Kerr, and control</span>
<span class="sd">        parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_compute</span><span class="p">()</span>
        <span class="n">estimation</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
            <span class="mf">16.6</span><span class="o">/</span><span class="mf">5e7</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span>  <span class="c1"># usual propagation</span>
            <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.62</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_loop</span><span class="p">))</span>  <span class="c1"># with kerr</span>
            <span class="o">+</span> <span class="mf">3.8e-8</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">variance_check</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">estimate_time_display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">estimation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">find_guide_number</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guide_number</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the waveguide group number for a given waveguide number.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        guide_number : int</span>
<span class="sd">            Number of a waveguide</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        guide_group_number : int</span>
<span class="sd">            Number of the waveguide group</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nbr_guide</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">)):</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">nbr_guide</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">nbr_guide</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>

        <span class="n">cumul</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">nbr_guide</span><span class="p">)</span>
        <span class="n">guide_list_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cumul</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">guide_number</span><span class="o">+</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">guide_list_pos</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">guide_pos</span> <span class="o">=</span> <span class="n">guide_list_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">guide_pos</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">check_modes_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Display on the interface the last mode that can propagated into a</span>
<span class="sd">        squared waveguide.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">guide_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_guide_number</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_nbr_ref</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">guide_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: trying to check the mode of a unexisting waveguide&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mode_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">check_modes</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">[</span><span class="n">guide_index</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">[</span><span class="n">guide_index</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode_number</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">mode_max</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">addmpl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tab</span><span class="o">=</span><span class="s1">&#39;guide&#39;</span><span class="p">,</span> <span class="n">pow_index</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add the selected plots on the waveguide, light or compute window.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tab : str, optional</span>
<span class="sd">            &#39;guide&#39; or &#39;light&#39;.</span>
<span class="sd">            &#39;guide&#39; by default.</span>
<span class="sd">        pow_index : int, optional</span>
<span class="sd">            Add the first waveguide and light step if 0 or the last step if -1.</span>
<span class="sd">            Also display the propagation over (x,z) and guide power if -1 is</span>
<span class="sd">            choosen.</span>
<span class="sd">            0 by default.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pow_index_guide</span> <span class="o">=</span> <span class="n">pow_index</span>

        <span class="k">if</span> <span class="n">pow_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pow_index_guide</span> <span class="o">-=</span> <span class="mi">1</span>  <span class="c1"># Display the -2 waveguide for the -1 beam</span>

        <span class="n">x_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">x_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">temp</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="kc">None</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>

        <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span>  <span class="c1"># If array of guides</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span>  <span class="c1"># If exists</span>
                <span class="ow">and</span> <span class="n">temp</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># If in the windows</span>
                <span class="ow">and</span> <span class="n">temp</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">x_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
            <span class="n">x_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
            <span class="n">no_array</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">no_array</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="p">(</span><span class="mi">1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span>  <span class="c1"># If curved guides</span>
                <span class="ow">and</span> <span class="n">temp</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># If guides in the windows</span>
                <span class="ow">and</span> <span class="n">temp</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">x_min_bis</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="n">x_max_bis</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">x_min_bis</span> <span class="o">&lt;</span> <span class="n">x_min</span> <span class="ow">or</span> <span class="n">no_array</span><span class="p">:</span>
                <span class="n">x_min</span> <span class="o">=</span> <span class="n">x_min_bis</span>

            <span class="k">if</span> <span class="n">x_max_bis</span> <span class="o">&gt;</span> <span class="n">x_max</span> <span class="ow">or</span> <span class="n">no_array</span><span class="p">:</span>
                <span class="n">x_max</span> <span class="o">=</span> <span class="n">x_max_bis</span>

        <span class="k">if</span> <span class="n">tab</span> <span class="o">==</span> <span class="s1">&#39;guide&#39;</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">()</span>
            <span class="c1"># BUG: if click on menu, change size until overlap or reduce to</span>
            <span class="c1"># oblivion. set_tight_layout(true) is the cause.</span>
<span class="c1">#            fig.set_tight_layout(True)  # Prevent axes to be cut when resizing</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_index</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>

                <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
                <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Imaginary part of the refractive index&quot;</span><span class="p">)</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Waveguide shape over x and z&quot;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (Âµm)&#39;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;z (mm)&#39;</span><span class="p">)</span>

            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>

            <span class="c1"># note that a colormesh pixel is based on 4 points</span>
            <span class="n">graph</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xv</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">zv</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dn_disp</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span>
                                   <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_index</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">z_max</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dn_disp</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="n">graph2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xv</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">zv</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dn_disp</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span>
                                        <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;seismic&#39;</span><span class="p">,</span>
                                        <span class="n">vmin</span><span class="o">=-</span><span class="n">z_max</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">z_max</span><span class="p">)</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">graph2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_xz</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_xz</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_guide_xz</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_xz</span><span class="p">,</span>
                                                      <span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_xz</span><span class="p">,</span>
                                                      <span class="n">coordinates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_guide_xz</span><span class="p">)</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">()</span>
<span class="c1">#            fig.set_tight_layout(True)</span>
            <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Input index profil&quot;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (Âµm)&#39;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Delta_n$&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">verts</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
                         <span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="n">pow_index_guide</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">real</span><span class="p">),</span>
                         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">)]</span>
                <span class="n">poly</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">verts</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;0.9&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>

            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">real</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">real</span><span class="p">):</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
                             <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">*</span><span class="mf">1.1</span> <span class="o">+</span> <span class="mf">1E-20</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
                             <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">*</span><span class="mf">1.1</span> <span class="o">+</span> <span class="mf">1E-20</span><span class="p">)</span>

            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="n">pow_index_guide</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_x</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_x</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_guide_x</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_x</span><span class="p">,</span>
                                                     <span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_x</span><span class="p">,</span>
                                                     <span class="n">coordinates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_guide_x</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">tab</span> <span class="o">==</span> <span class="s1">&#39;light&#39;</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">()</span>
<span class="c1">#            fig.set_tight_layout(True)</span>
            <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Light injection&quot;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (Âµm)&#39;</span><span class="p">)</span>
            <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">tl</span> <span class="ow">in</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
                <span class="n">tl</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">tl</span> <span class="ow">in</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
                <span class="n">tl</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;#1f77b4&#39;</span><span class="p">)</span>

            <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Delta_n$&#39;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Irradiance ($GW.cm^{-2}$)&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pow_index_guide</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">verts</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
                             <span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn_first</span><span class="o">.</span><span class="n">real</span><span class="p">),</span>
                             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">)]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">verts</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
                             <span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="n">pow_index_guide</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">real</span><span class="p">),</span>
                             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">)]</span>
                <span class="n">poly</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">verts</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;0.9&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>

            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">pow_index_guide</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span>
                        <span class="mi">0</span><span class="p">,</span>  <span class="nb">max</span><span class="p">(</span><span class="mf">1.1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dn_first</span><span class="o">.</span><span class="n">real</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1E-20</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span>
                        <span class="mi">0</span><span class="p">,</span>  <span class="nb">max</span><span class="p">(</span><span class="mf">1.1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="n">pow_index_guide</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">real</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1E-20</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1e-13</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

            <span class="k">if</span> <span class="n">pow_index_guide</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn_first</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">[</span><span class="n">pow_index_guide</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mf">1e-13</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">[</span><span class="n">pow_index</span><span class="p">],</span> <span class="s1">&#39;#1f77b4&#39;</span><span class="p">)</span>

            <span class="c1"># Display light at the beginning of guides</span>
            <span class="k">if</span> <span class="n">pow_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas_light</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_light</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_light</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_light</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_light</span><span class="p">,</span>
                                                       <span class="bp">self</span><span class="o">.</span><span class="n">canvas_light</span><span class="p">,</span>
                                                       <span class="n">coordinates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_light</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_light</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">pow_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Light at the output&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas_end</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_end</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_end</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_end</span><span class="p">,</span>
                                                     <span class="bp">self</span><span class="o">.</span><span class="n">canvas_end</span><span class="p">,</span>
                                                     <span class="n">coordinates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_end</span><span class="p">)</span>

                <span class="c1"># Display light propagation into guides</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">()</span>
<span class="c1">#                fig.set_tight_layout(True)</span>
                <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Light propagation&quot;</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (Âµm)&#39;</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;z (mm)&#39;</span><span class="p">)</span>

                <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>

                <span class="n">graph</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xv</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">zv</span><span class="p">,</span>
                                       <span class="mf">1e-13</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">)</span>
<span class="c1">#                fig.colorbar(graph, ax=ax1)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas_propag</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_propag</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_propag</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_propag</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_propag</span><span class="p">,</span>
                                                        <span class="n">coordinates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_propag</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">display_power</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">display_power</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Display the power in each waveguide.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_power</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">t_power_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">()</span>
<span class="c1">#                    fig.set_tight_layout(True)</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Power in waveguides&quot;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;z (mm)&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Power (a.u)&#39;</span><span class="p">)</span>

        <span class="n">dot</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">sp1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
        <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
        <span class="n">sp2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
        <span class="n">dashes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">dot</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">sp1</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">sp2</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">val1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dot</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">val2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sp1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">val3</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">val4</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sp2</span><span class="p">):</span>
                        <span class="n">dashes</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">sp1</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">sp2</span><span class="p">)</span>
                               <span class="o">+</span> <span class="n">j</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">sp2</span><span class="p">)</span>
                               <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">sp2</span><span class="p">)</span><span class="o">+</span><span class="n">l</span>
                               <span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">val1</span><span class="p">,</span> <span class="n">val2</span><span class="p">,</span> <span class="n">val3</span><span class="p">,</span> <span class="n">val4</span><span class="p">)</span>
        <span class="n">dashes</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="n">x_beg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">x_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

        <span class="n">num_gd</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Array of waveguide</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                    <span class="p">[</span><span class="n">x_beg</span><span class="p">[</span><span class="n">num_gd</span><span class="p">,</span> <span class="p">:],</span>
                     <span class="n">x_end</span><span class="p">[</span><span class="n">num_gd</span><span class="p">,</span> <span class="p">:]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">guide_position</span><span class="p">(</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span> <span class="n">num_gd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">num_gd</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># needed if no waveguide</span>
                    <span class="n">num_gd</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Curved waveguide</span>
                <span class="c1"># Choose precision at the end for right waveguide</span>
                <span class="c1"># and choose safety when guides overlapse</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">[</span><span class="n">num_gd</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="c1"># accurate at end but may overlap before</span>
                    <span class="n">p0</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">[</span><span class="n">num_gd</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                          <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">[</span><span class="n">num_gd</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># accurate in middle but miss evanescente part</span>
                    <span class="n">p0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_factor</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                    <span class="p">[</span><span class="n">x_beg</span><span class="p">[</span><span class="n">num_gd</span><span class="p">,</span> <span class="p">:],</span>
                     <span class="n">x_end</span><span class="p">[</span><span class="n">num_gd</span><span class="p">,</span> <span class="p">:]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">guide_position</span><span class="p">(</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span> <span class="n">num_gd</span><span class="p">,</span> <span class="n">p0</span><span class="p">)</span>
                    <span class="n">num_gd</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpm</span><span class="o">.</span><span class="n">power_guide</span><span class="p">(</span><span class="n">x_beg</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span>
                                           <span class="n">x_end</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>
            <span class="c1"># plot each power with a different style</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z_disp</span><span class="p">,</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span>
                     <span class="n">dashes</span><span class="o">=</span><span class="n">dashes</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">dashes</span><span class="p">)],</span>
                     <span class="n">label</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_pow</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute_plot</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_pow</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_pow</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_pow</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">canvas_pow</span><span class="p">,</span>
                                             <span class="n">coordinates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute_plot</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_pow</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>  <span class="c1"># Fast if many plot</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>  <span class="c1"># Best if not too many plot</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">t_power_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Power time: &#39;</span><span class="p">,</span> <span class="n">t_power_end</span><span class="o">-</span><span class="n">t_power_start</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">rmmpl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tab</span><span class="p">,</span> <span class="n">pow_index</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove the selected plots</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tab : str</span>
<span class="sd">            &#39;guide&#39; or &#39;light&#39;.</span>
<span class="sd">        pow_index : int, optional</span>
<span class="sd">            Remove the first light step if 0 or the last step if -1.</span>
<span class="sd">            0 by default.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tab</span> <span class="o">==</span> <span class="s1">&#39;guide&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_xz</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_x</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_xz</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_guide_x</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_guide_xz</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_guide</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_guide_x</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_guide_xz</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_guide_x</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">tab</span> <span class="o">==</span> <span class="s1">&#39;light&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pow_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_light</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_light</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas_light</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_light</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_light</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_light</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">pow_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_propag</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas_propag</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_propag</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_propag</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_end</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas_end</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_compute</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_end</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_end</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute_plot</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_pow</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas_pow</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_compute_plot</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar_pow</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolbar_pow</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">save_guide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guide_selec</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the interface variables into the guides variables.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if more than one waveguide and if no waveguide selected manually</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">guide_selec</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;False&#39;</span><span class="p">:</span>
            <span class="n">guide_selec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_guide</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">())</span>  <span class="c1"># Choice</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">length_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_z</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nbr_z_disp</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_x</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span><span class="p">[</span>
            <span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">guide_length</span><span class="p">[</span>
            <span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_guide_length</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide_z</span><span class="p">[</span>
            <span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide_z</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dn</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_imag</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n_imag</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss_check</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_n_imag</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">delta_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">]</span>
        <span class="n">no_imag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_imag</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">]</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span>  <span class="c1"># unit conversion mm-1 -&gt; Âµm-1</span>
        <span class="n">no_imag2</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">lo</span><span class="p">)</span>
        <span class="n">loss_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_check</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">full_index</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">delta_no</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">loss_check</span><span class="o">*</span><span class="n">no_imag</span>
                                        <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">loss_check</span><span class="p">)</span><span class="o">*</span><span class="n">no_imag2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">shape_gauss_check</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gauss_pow</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape_squared_check</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nb_p</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_p</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">curve</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_curve</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">half_delay</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_half_delay</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distance_factor</span><span class="p">[</span>
            <span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_distance_factor</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span><span class="p">[</span>
            <span class="n">guide_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
<span class="c1">#        print(&quot;Guide variables saved&quot;)</span>

    <span class="k">def</span> <span class="nf">get_guide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the saved values of the waveguide variables onto the interface.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_z</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_z</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nbr_z_disp</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_length_x</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dist_x</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lo</span><span class="p">)</span>

        <span class="n">guide_selec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_guide</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">())</span>  <span class="c1"># choice</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous_guide</span> <span class="o">!=</span> <span class="n">guide_selec</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_guide</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">previous_guide</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_guide</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># if more than one beams</span>
            <span class="n">guide_selec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_guide</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">())</span>  <span class="c1"># choice</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Not supposed to happen</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t have no waveguide variables&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_guide_length</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">guide_length</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide_z</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide_z</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dn</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n_imag</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no_imag</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_n_imag</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_check</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n_imag</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_check</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_check</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape_gauss_check</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gauss_pow</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape_squared_check</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nb_p</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_p</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_curve</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">curve</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_half_delay</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">half_delay</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_distance_factor</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">distance_factor</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape_gauss_check</span><span class="p">[</span><span class="n">guide_selec</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">previous_guide</span> <span class="o">=</span> <span class="n">guide_selec</span>  <span class="c1"># Save the nÂ° of current waveguide</span>

    <span class="k">def</span> <span class="nf">save_light</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">beam_selec</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the interface variables into the lights variables.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        beam_selec: int, bool, optional</span>
<span class="sd">            Number of the beam to save into the variables.</span>
<span class="sd">            False by default to get the currently displayed beam.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta_ext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_theta_ext</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

        <span class="c1"># if more than one beams and if no beams selected manualy</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">beam_selec</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;False&#39;</span><span class="p">:</span>
            <span class="n">beam_selec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">())</span>  <span class="c1"># Choice</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_fwhm</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irrad_significand</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_irrad_significand</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irrad_exponent</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_irrad_exponent</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irrad</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_irrad_significand</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                                  <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">spinBox_irrad_exponent</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_mode</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_guide_ref</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_nbr_ref</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian_light</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">square_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared_light</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_mode</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_all_modes</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_airy</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_light</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the saved values of the light variables onto the interface.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">beam_selec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">())</span>  <span class="c1"># choice</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous_beam</span> <span class="o">!=</span> <span class="n">beam_selec</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_light</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">previous_beam</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_theta_ext</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta_ext</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># if more than one beams</span>
            <span class="n">beam_selec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">())</span>  <span class="c1"># choice</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Not supposed to happen</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t have no beam variables&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_fwhm</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_irrad_significand</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">irrad_significand</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_irrad_exponent</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">irrad_exponent</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_mode</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_nbr_ref</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_guide_ref</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian_light</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared_light</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">square_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_mode</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_all_modes</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_airy</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_mode</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_nbr_ref</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span><span class="p">[</span><span class="n">beam_selec</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">previous_beam</span> <span class="o">=</span> <span class="n">beam_selec</span>  <span class="c1"># Save the nÂ° of the current beam</span>

    <span class="k">def</span> <span class="nf">save_compute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the interface variables into the compute variables.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_kerr</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kerr_loop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_kerr_loop</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n2_significand</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n2_significand</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n2_exponent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_n2_exponent</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2_significand</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">n2_exponent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chi3_significand</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_chi3_significand</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chi3_exponent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_chi3_exponent</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2_significand</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">chi3_exponent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variance_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_variance</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">power_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_power</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n2_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_n2</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">get_compute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the saved values of the compute variables onto the interface.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_kerr</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_kerr_loop</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_loop</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_n2</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n2_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n2_significand</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n2_significand</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_n2_exponent</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n2_exponent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_chi3_significand</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi3_significand</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_chi3_exponent</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi3_exponent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_kerr</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_variance</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variance_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_power</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power_check</span><span class="p">)</span>

    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">on_click_guide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create and displayed the waguides.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WaitCursor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmmpl</span><span class="p">(</span><span class="s1">&#39;guide&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmmpl</span><span class="p">(</span><span class="s1">&#39;light&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_guide</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_light</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="s1">&#39;guide&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="s1">&#39;light&#39;</span><span class="p">)</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_estimate_time</span><span class="p">()</span>

    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">on_click_light</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create the light and display it with the input profil waveguides.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WaitCursor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmmpl</span><span class="p">(</span><span class="n">tab</span><span class="o">=</span><span class="s1">&#39;light&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_light</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="n">tab</span><span class="o">=</span><span class="s1">&#39;light&#39;</span><span class="p">)</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_estimate_time</span><span class="p">()</span>

    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">on_click_compute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the propagation using the waveguides and bemas informations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WaitCursor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_estimate_time</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_pow</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">rmmpl</span><span class="p">(</span><span class="n">tab</span><span class="o">=</span><span class="s1">&#39;light&#39;</span><span class="p">,</span> <span class="n">pow_index</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_guide_done</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rmmpl</span><span class="p">(</span><span class="s1">&#39;guide&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">calculate_guide</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="s1">&#39;guide&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rmmpl</span><span class="p">(</span><span class="n">tab</span><span class="o">=</span><span class="s1">&#39;light&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">calculate_light</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="n">tab</span><span class="o">=</span><span class="s1">&#39;light&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">calculate_propagation</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addmpl</span><span class="p">(</span><span class="n">tab</span><span class="o">=</span><span class="s1">&#39;light&#39;</span><span class="p">,</span> <span class="n">pow_index</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no light to compute&quot;</span><span class="p">)</span>

        <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>

    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">on_click_create_guide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new waveguide with the displayed variables.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_width</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">offset_guide</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">guide_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_guide_length</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">offset_guide_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_guide_z</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">delta_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_dn</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">no_imag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_n_imag</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lost</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">loss_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_n_imag</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lo</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">no_imag2</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">lo</span><span class="p">)</span>
        <span class="n">full_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">delta_no</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">loss_check</span><span class="o">*</span><span class="n">no_imag</span>
                      <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">loss_check</span><span class="p">)</span><span class="o">*</span><span class="n">no_imag2</span><span class="p">)</span>
        <span class="n">shape_gauss_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">gauss_pow</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spinBox_gauss_pow</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="n">shape_squared_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">nbr_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_nb_p</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_p</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">curve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_curve</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">half_delay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_half_delay</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">distance_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_distance_factor</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">tab_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget_morphology_guide</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span><span class="p">,</span> <span class="n">offset_guide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">guide_length</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">guide_length</span><span class="p">,</span> <span class="n">guide_length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_guide_z</span><span class="p">,</span> <span class="n">offset_guide_z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">,</span> <span class="n">delta_no</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_imag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no_imag</span><span class="p">,</span> <span class="n">no_imag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_check</span><span class="p">,</span> <span class="n">loss_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">full_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_index</span><span class="p">,</span> <span class="n">full_index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape_gauss_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape_gauss_check</span><span class="p">,</span>
                                           <span class="n">shape_gauss_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gauss_pow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gauss_pow</span><span class="p">,</span> <span class="n">gauss_pow</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape_squared_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape_squared_check</span><span class="p">,</span>
                                             <span class="n">shape_squared_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">,</span> <span class="n">nbr_p</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">curve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">curve</span><span class="p">,</span> <span class="n">curve</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">half_delay</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">half_delay</span><span class="p">,</span> <span class="n">half_delay</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distance_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distance_factor</span><span class="p">,</span> <span class="n">distance_factor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span><span class="p">,</span> <span class="n">tab_index</span><span class="p">)</span>

        <span class="n">nbr_guide</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_guide</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>  <span class="c1"># how many item left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_guide</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Waveguide &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nbr_guide</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_guide</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">nbr_guide</span><span class="p">)</span>  <span class="c1"># show new index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous_guide</span> <span class="o">=</span> <span class="n">nbr_guide</span>  <span class="c1"># save new waveguide nÂ°</span>

    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">on_click_create_light</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new beam with the displayed variables.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fwhm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_fwhm</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">offset_light</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_offset_light</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">irrad_significand</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_irrad_significand</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">irrad_exponent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_irrad_exponent</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">irrad</span> <span class="o">=</span> <span class="n">irrad_significand</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="n">irrad_exponent</span>
        <span class="n">offset_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_offset_light</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">gaussian_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_gaussian_light</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">square_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_squared_light</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">mode_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_mode</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">all_modes_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_all_modes</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_mode</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">mode_guide_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_guide_nbr_ref</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">offset_light_peak</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">airy_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_airy</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">airy_zero</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_airy_zero</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">lobe_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_lobe_size</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span><span class="p">,</span> <span class="n">offset_light</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irrad_significand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">irrad_significand</span><span class="p">,</span>
                                           <span class="n">irrad_significand</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irrad_exponent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">irrad_exponent</span><span class="p">,</span> <span class="n">irrad_exponent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irrad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">irrad</span><span class="p">,</span> <span class="n">irrad</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_guide_ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_guide_ref</span><span class="p">,</span> <span class="n">mode_guide_ref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span><span class="p">,</span> <span class="n">offset_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">,</span>
                                           <span class="n">offset_light_peak</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span><span class="p">,</span> <span class="n">gaussian_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">square_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">square_check</span><span class="p">,</span> <span class="n">square_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span><span class="p">,</span> <span class="n">mode_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span><span class="p">,</span> <span class="n">all_modes_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span><span class="p">,</span> <span class="n">airy_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span><span class="p">,</span> <span class="n">airy_zero</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span><span class="p">,</span> <span class="n">lobe_size</span><span class="p">)</span>

        <span class="n">nbr_light</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>  <span class="c1"># how many item left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Beam &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nbr_light</span><span class="p">))</span>  <span class="c1"># add new index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">nbr_light</span><span class="p">)</span>  <span class="c1"># show new index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous_beam</span> <span class="o">=</span> <span class="n">nbr_light</span>  <span class="c1"># Change the current selected beam</span>

    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">on_click_delete_guide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete the current displayed waveguide and displayed the next one if</span>
<span class="sd">        exist else the previous one.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nbr_guide</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_guide</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">nbr_guide</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Can&#39;t delete if remains only 1 waveguide</span>
            <span class="n">guide_selec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_guide</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">())</span>  <span class="c1"># choice</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">guide_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span><span class="p">,</span> <span class="n">guide_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">guide_length</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">guide_length</span><span class="p">,</span> <span class="n">guide_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_guide_z</span><span class="p">,</span> <span class="n">guide_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">,</span> <span class="n">guide_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">no_imag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no_imag</span><span class="p">,</span> <span class="n">guide_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">guide_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loss_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_check</span><span class="p">,</span> <span class="n">guide_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">full_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_index</span><span class="p">,</span> <span class="n">guide_selec</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">shape_gauss_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape_gauss_check</span><span class="p">,</span>
                                               <span class="n">guide_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gauss_pow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gauss_pow</span><span class="p">,</span> <span class="n">guide_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape_squared_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape_squared_check</span><span class="p">,</span>
                                                 <span class="n">guide_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">,</span> <span class="n">guide_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">guide_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">curve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">curve</span><span class="p">,</span> <span class="n">guide_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">half_delay</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">half_delay</span><span class="p">,</span> <span class="n">guide_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">distance_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distance_factor</span><span class="p">,</span> <span class="n">guide_selec</span><span class="p">)</span>

            <span class="n">nbr_guide</span> <span class="o">-=</span> <span class="mi">1</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_guide</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># remove all beams number</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_guide</span><span class="p">):</span>  <span class="c1"># Add waveguides nÂ°</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_guide</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Waveguide &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

            <span class="c1"># set same waveguide nÂ° if not the last else reduce the index by 1</span>
            <span class="k">if</span> <span class="n">guide_selec</span> <span class="o">==</span> <span class="n">nbr_guide</span> <span class="ow">and</span> <span class="n">guide_selec</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">guide_selec</span> <span class="o">-=</span> <span class="mi">1</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_guide</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">guide_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">previous_guide</span> <span class="o">=</span> <span class="n">guide_selec</span>  <span class="c1"># Change the selected waveguide</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_guide</span><span class="p">()</span>  <span class="c1"># Display previous or next waveguide values</span>

    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">on_click_delete_light</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete the current displayed beam and displayed the next one.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nbr_light</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">nbr_light</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Can&#39;t delete if remains only 1 beam</span>
            <span class="n">beam_selec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">())</span>  <span class="c1"># choice</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">irrad_significand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">irrad_significand</span><span class="p">,</span>
                                               <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">irrad_exponent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">irrad_exponent</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">irrad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">irrad</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode_guide_ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_guide_ref</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">,</span>
                                               <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">square_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">square_check</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span><span class="p">,</span>
                                             <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span><span class="p">,</span> <span class="n">beam_selec</span><span class="p">)</span>

            <span class="n">nbr_light</span> <span class="o">-=</span> <span class="mi">1</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># remove all beams number</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_light</span><span class="p">):</span>  <span class="c1"># create again with new number</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Beam &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

            <span class="c1"># set same beam index if not the last else reduce the index by 1</span>
            <span class="k">if</span> <span class="n">beam_selec</span> <span class="o">==</span> <span class="n">nbr_light</span> <span class="ow">and</span> <span class="n">beam_selec</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">beam_selec</span> <span class="o">-=</span> <span class="mi">1</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">beam_selec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">previous_beam</span> <span class="o">=</span> <span class="n">beam_selec</span>  <span class="c1"># Change the current selected beam</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_light</span><span class="p">()</span>  <span class="c1"># Display values of the previous or next beam</span>

    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">open_file_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open a dialog window to select the file to open, and call</span>
<span class="sd">        :meth:`open_file` to open the file.</span>

<span class="sd">        Source: https://pythonspot.com/pyqt5-file-dialog/</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method has a try/except implemented to check if the openned file</span>
<span class="sd">        contains all the variables.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
        <span class="n">options</span> <span class="o">|=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">DontUseNativeDialog</span>
        <span class="n">filename</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                                  <span class="s2">&quot;Import data&quot;</span><span class="p">,</span>
                                                  <span class="s2">&quot;&quot;</span><span class="p">,</span>
                                                  <span class="s2">&quot;Text Files (*.txt)&quot;</span><span class="p">,</span>
                                                  <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>  <span class="c1"># Next save will overwrite this file</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Beampy - &quot;</span><span class="o">+</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;missing variable&quot;</span><span class="p">,</span> <span class="n">ex</span><span class="p">,</span> <span class="s2">&quot;in the file.&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Add it manually to remove this error.&quot;</span><span class="p">)</span>
<span class="c1">#            except Exception as ex:  # This execption was removed to see the</span>
                <span class="c1"># # error location. The program won&#39;t crash thanks to try</span>
<span class="c1">#                print(&quot;Unknown error when openning the file:&quot;, filename)</span>
<span class="c1">#                print(&quot;Error:&quot;, ex)</span>

    <span class="k">def</span> <span class="nf">open_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set guides, beams and computes variables from a choosen file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str</span>
<span class="sd">            Name of the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="c1">#        https://www.tutorialspoint.com/</span>
<span class="c1">#        How-to-create-a-Python-dictionary-from-text-file</span>
        <span class="n">dico</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="o">*</span><span class="n">val</span><span class="p">)</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>  <span class="c1"># Assume: variable_name values</span>
<span class="c1">#            print(variables, val)</span>
            <span class="n">dico</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">variables</span><span class="p">)]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># Waveguide variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length_z</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;length_z&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;dist_z&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;nbr_z_disp&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length_x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;length_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;dist_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;no&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lo</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;lo&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;offset_guide&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">guide_length</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;guide_length&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;offset_guide_z&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;delta_no&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_imag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;no_imag&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;loss_check&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">no_imag2</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">lo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">full_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_check</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">no_imag</span>
                <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_check</span><span class="p">)</span><span class="o">*</span><span class="n">no_imag2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape_gauss_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="n">dico</span><span class="p">[</span><span class="s1">&#39;shape_gauss_check&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gauss_pow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;gauss_pow&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape_squared_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="n">dico</span><span class="p">[</span><span class="s1">&#39;shape_squared_check&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;nbr_p&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">curve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;curve&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">half_delay</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;half_delay&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distance_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;distance_factor&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;tab_index&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="c1"># Light variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta_ext</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;theta_ext&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;fwhm&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;offset_light&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irrad_significand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="n">dico</span><span class="p">[</span><span class="s1">&#39;irrad_significand&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irrad_exponent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;irrad_exponent&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irrad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">irrad_significand</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">irrad_exponent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;offset_check&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;gaussian_check&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">square_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;square_check&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;mode_check&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;all_modes_check&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_guide_ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;mode_guide_ref&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="n">dico</span><span class="p">[</span><span class="s1">&#39;offset_light_peak&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinBox_offset_light_peak</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;airy_check&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;airy_zero&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;lobe_size&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="c1"># Compute variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;kerr_check&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kerr_loop</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;kerr_loop&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n2_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;n2_check&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n2_significand</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;n2_significand&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n2_exponent</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;n2_exponent&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chi3_significand</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;chi3_significand&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chi3_exponent</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;chi3_exponent&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variance_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;variance_check&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">power_check</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dico</span><span class="p">[</span><span class="s1">&#39;power_check&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">nbr_guide</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_guide</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># Remove all guides number</span>

        <span class="n">nbr_light</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># Remove all beams number</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_guide</span><span class="p">):</span>  <span class="c1"># Add waveguides nÂ°</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_guide</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Waveguide &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_light</span><span class="p">):</span>  <span class="c1"># Add beams nÂ°</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_light</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Beam &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">previous_guide</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Will show the first waveguide</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous_beam</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Will show the first beam</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">get_guide</span><span class="p">()</span>  <span class="c1"># Set waveguide values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_light</span><span class="p">()</span>  <span class="c1"># Set lights values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_compute</span><span class="p">()</span>  <span class="c1"># Set compute values</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">on_click_guide</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;file openned&quot;</span><span class="p">)</span>

    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">save_quick</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if a file is already selected and if so, save into it.</span>
<span class="sd">        Else, call the :meth:`save_file_name` to ask a filename.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_file_name</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">save_file_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open a dialog window to select the saved file name and call</span>
<span class="sd">        :meth:`save_file` to save the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
        <span class="n">options</span> <span class="o">|=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">DontUseNativeDialog</span>
        <span class="n">filename</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                                  <span class="s2">&quot;Save data&quot;</span><span class="p">,</span>
                                                  <span class="s2">&quot;&quot;</span><span class="p">,</span>
                                                  <span class="s2">&quot;Text Files (*.txt)&quot;</span><span class="p">,</span>
                                                  <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">!=</span> <span class="s1">&#39;.txt&#39;</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.txt&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Beampy - &quot;</span><span class="o">+</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">save_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save guides, beams and computes variables into a choosen file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str</span>
<span class="sd">            Name of the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_guide</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_light</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_compute</span><span class="p">()</span>

        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>

        <span class="c1"># Waveguide variables</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;length_z &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_z</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;dist_z &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_z</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;nbr_z_disp &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_z_disp</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;length_x &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length_x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;dist_x &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;no &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;lo &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lo</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;width &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;offset_guide &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;guide_length &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">guide_length</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;offset_guide_z &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_guide_z</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;delta_no &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delta_no</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;no_imag &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">no_imag</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;alpha &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;loss_check &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loss_check</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;shape_gauss_check &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape_gauss_check</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;gauss_pow &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gauss_pow</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;shape_squared_check &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape_squared_check</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;nbr_p &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_p</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;p &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;curve &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">curve</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;half_delay &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">half_delay</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;distance_factor &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">distance_factor</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;tab_index &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tab_index</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># light variables</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;theta_ext &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta_ext</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;fwhm &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fwhm</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;offset_light &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_light</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;irrad_significand &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">irrad_significand</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;irrad_exponent &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">irrad_exponent</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;offset_check &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_check</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;gaussian_check &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_check</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;square_check &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">square_check</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;mode_check &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_check</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;all_modes_check &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_modes_check</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;mode &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;mode_guide_ref &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_guide_ref</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;offset_light_peak &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_light_peak</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;airy_check &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_check</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;airy_zero &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">airy_zero</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;lobe_size &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe_size</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># compute variables</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;kerr_check &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_check</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;kerr_loop &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kerr_loop</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;n2_check &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n2_check</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;n2_significand &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n2_significand</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;n2_exponent &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n2_exponent</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;chi3_significand &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi3_significand</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;chi3_exponent &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi3_exponent</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;variance_check &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variance_check</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;power_check &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power_check</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;file saved&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">open_doc</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function that open the local html documentation - describing the beampy</span>
<span class="sd">    modules - if exist, or the online version otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file</span> <span class="o">=</span> <span class="vm">__file__</span>  <span class="c1"># Module name</span>
    <span class="c1"># Replaces characters only when called from outer files</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">file</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># Remove the folder and file name</span>

    <span class="n">file2</span> <span class="o">=</span> <span class="nb">str</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file2</span> <span class="o">=</span> <span class="n">file2</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">line</span>

    <span class="n">file</span> <span class="o">=</span> <span class="n">file2</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">+</span><span class="s2">&quot;/docs/html/index.html&quot;</span>
    <span class="n">exists</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">exists</span><span class="p">:</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Open file in a new tab (new=2)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The documentation can&#39;t be found localy in:&quot;</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
        <span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;https://beampy.readthedocs.io&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Openning the online version at:&quot;</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Open file in a new tab (new=2)</span>


<span class="k">def</span> <span class="nf">open_app</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function used to open the app.</span>
<span class="sd">    Can be called directly from beampy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>  <span class="c1"># Define the app</span>
    <span class="n">myapp</span> <span class="o">=</span> <span class="n">UserInterface</span><span class="p">()</span>  <span class="c1"># Run the app</span>
    <span class="n">myapp</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Show the form</span>
    <span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>  <span class="c1"># Execute the app in a loop</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">open_app</span><span class="p">()</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="code_interface.html" class="btn btn-neutral float-right" title="beampy.interface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="code_bpm.html" class="btn btn-neutral float-left" title="beampy.bpm" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020 Jonathan Peltier and Marcel Soubkovsky

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>